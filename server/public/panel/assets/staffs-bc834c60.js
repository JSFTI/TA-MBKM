import{f as R,r as S,N as U,C as y,O as D,P as H,Q as q,o as g,t as h,w as p,b as w,a as s,x as e,R as z,S as L,h as T,T as ie,U as X,W as Y,X as Z,Y as de,c as P,Z as ue,_ as me,v as M,$ as ce,a0 as pe,a1 as _e,a2 as fe,a3 as ge,a4 as we,a5 as Ve,a6 as O,a7 as N,a8 as be,a9 as A,aa as ve,ab as ye,ac as xe}from"./vendor-58478656.js";import{l as Pe}from"./lodash-ab6a0fa0.js";import{_ as Se}from"./ProfilePictureUpdater.vue_vue_type_style_index_0_lang-e910fc3f.js";import{u as Fe,F as W,c as ke,g as Ue}from"./index.esm-feed947a.js";import{u as $e,_ as Ce}from"./main-d7e4a2c8.js";const he={class:"flex flex-col gap-5"},Te=R({__name:"NewUserForm",emits:["submitted"],setup(x,{emit:b}){const c={name:"",email:"",role_id:null,password:"",repeatPassword:""},d={name:"",email:"",role_id:"",password:"",repeatPassword:""},_=S(!1),a=U({...c}),t=U({...d}),i=U({password:!1,repeatPassword:!1}),n=S([]);function V(){_.value=!0,Object.assign(t,d),y.post("users",a).then(u=>{b("submitted",u.data)}).catch(u=>{Object.assign(t,u.response.data.errors)}).finally(()=>{_.value=!1})}return y.get("roles").then(u=>{n.value=u.data}),(u,r)=>{const m=D,f=H,$=T,l=q;return g(),h(l,{class:"p-5",onSubmit:L(V,["prevent"])},{default:p(()=>[w("div",he,[s(m,{modelValue:e(a).name,"onUpdate:modelValue":r[0]||(r[0]=o=>e(a).name=o),label:"Name",error:!!e(t).name,"error-messages":e(t).name},null,8,["modelValue","error","error-messages"]),s(m,{modelValue:e(a).email,"onUpdate:modelValue":r[1]||(r[1]=o=>e(a).email=o),label:"Email",error:!!e(t).email,"error-messages":e(t).email},null,8,["modelValue","error","error-messages"]),s(f,{modelValue:e(a).role_id,"onUpdate:modelValue":r[2]||(r[2]=o=>e(a).role_id=o),items:e(n),"item-title":"display_name","item-value":"id",label:"Role",error:!!e(t).role_id,"error-messages":e(t).role_id},null,8,["modelValue","items","error","error-messages"]),s(m,{id:"new-password",modelValue:e(a).password,"onUpdate:modelValue":r[3]||(r[3]=o=>e(a).password=o),type:e(i).password?"text":"password",label:"Password","append-icon":e(i).password?"i-mdi:eye":"i-mdi:eye-off",error:!!e(t).password,"error-messages":e(t).password,"onClick:append":r[4]||(r[4]=o=>e(i).password=!e(i).password)},null,8,["modelValue","type","append-icon","error","error-messages"]),s(m,{id:"repeat-password",modelValue:e(a).repeatPassword,"onUpdate:modelValue":r[5]||(r[5]=o=>e(a).repeatPassword=o),type:e(i).repeatPassword?"text":"password",label:"Repeat Password","append-icon":e(i).repeatPassword?"i-mdi:eye":"i-mdi:eye-off",error:!!e(t).repeatPassword,"error-messages":e(t).repeatPassword,"onClick:append":r[6]||(r[6]=o=>e(i).repeatPassword=!e(i).repeatPassword)},null,8,["modelValue","type","append-icon","error","error-messages"])]),s($,{type:"submit",class:"mt-5",color:"success"},{default:p(()=>[z(" Submit ")]),_:1})]),_:1},8,["onSubmit"])}}}),je=R({__name:"ForcePasswordForm",props:{id:null},setup(x){const b=x,c=U({password:"",repeatPassword:""}),d=U({password:!1,repeatPassword:!1}),_={password:"",repeatPassword:""},a=ie(),t=U({..._}),i=S(!1);function n(){i.value=!0,Object.assign(t,_),y.post(`users/${b.id}/password`,c).then(()=>{a.success("Password updated."),Object.assign(c,_)}).catch(V=>{Object.assign(t,V.response.data.errors)}).finally(()=>{i.value=!1})}return(V,u)=>{const r=D,m=T,f=q,$=X;return g(),h($,{title:"Force Change Password"},{default:p(()=>[s(f,{class:"p-5",onSubmit:L(n,["prevent"])},{default:p(()=>[s(r,{id:"new-password",modelValue:e(c).password,"onUpdate:modelValue":u[0]||(u[0]=l=>e(c).password=l),type:e(d).password?"text":"password",label:"Password","append-icon":e(d).password?"i-mdi:eye":"i-mdi:eye-off",error:!!e(t).password,"error-messages":e(t).password,"onClick:append":u[1]||(u[1]=l=>e(d).password=!e(d).password)},null,8,["modelValue","type","append-icon","error","error-messages"]),s(r,{id:"repeat-password",modelValue:e(c).repeatPassword,"onUpdate:modelValue":u[2]||(u[2]=l=>e(c).repeatPassword=l),type:e(d).repeatPassword?"text":"password",label:"Repeat Password","append-icon":e(d).repeatPassword?"i-mdi:eye":"i-mdi:eye-off",error:!!e(t).repeatPassword,"error-messages":e(t).repeatPassword,"onClick:append":u[3]||(u[3]=l=>e(d).repeatPassword=!e(d).repeatPassword)},null,8,["modelValue","type","append-icon","error","error-messages"]),s(m,{class:"mt-5",color:"danger",type:"submit"},{default:p(()=>[z(" Submit ")]),_:1})]),_:1},8,["onSubmit"])]),_:1})}}}),Oe={class:"flex justify-center"},Re={class:"flex flex-col gap-5"},Ne=R({__name:"UserForm",props:{id:null},emits:["submitted"],setup(x,{emit:b}){const c=x,d=S([]),_=S(!1),a=S(!1),t={name:"",email:"",role_id:null},i={name:"",email:"",role_id:""},n=U({...t}),V=U({...i});function u(m){_.value=!0,Object.assign(n,t),y.get(`users/${m}`).then(f=>{Object.assign(n,Pe.exports.pick(f.data,["name","email","role_id"]))}).finally(()=>{_.value=!1})}async function r(){a.value=!0,Object.assign(V,i);try{let m;c.id?m=await y.put(`/users/${c.id}`,n).then(f=>f.data):m=await y.post("/users",n).then(f=>f.data),b("submitted",m)}catch(m){m instanceof de&&Object.assign(V,m.response.data.errors)}finally{a.value=!1}}return y.get("roles").then(m=>{d.value=m.data}),c.id&&u(c.id),(m,f)=>{const $=Y,l=Z,o=D,B=H,j=T,I=q;return g(),h(I,{onSubmit:L(r,["prevent"])},{default:p(()=>[s(l,{"model-value":e(_),persistent:"",contained:"",class:"align-center justify-center"},{default:p(()=>[w("div",Oe,[s($,{size:"64",color:"primary",indeterminate:""})])]),_:1},8,["model-value"]),w("div",Re,[s(o,{modelValue:e(n).name,"onUpdate:modelValue":f[0]||(f[0]=k=>e(n).name=k),label:"Name",error:!!e(V).name,"error-messages":e(V).name},null,8,["modelValue","error","error-messages"]),s(o,{modelValue:e(n).email,"onUpdate:modelValue":f[1]||(f[1]=k=>e(n).email=k),label:"Email",error:!!e(V).email,"error-messages":e(V).email},null,8,["modelValue","error","error-messages"]),s(B,{modelValue:e(n).role_id,"onUpdate:modelValue":f[2]||(f[2]=k=>e(n).role_id=k),items:e(d),"item-title":"display_name","item-value":"id",label:"Role",error:!!e(V).role_id,"error-messages":e(V).role_id},null,8,["modelValue","items","error","error-messages"])]),w("div",null,[s(j,{class:"mt-5",color:"success",loading:e(a),type:"submit"},{default:p(()=>[z(" Submit ")]),_:1},8,["loading"])])]),_:1},8,["onSubmit"])}}}),De={class:"flex-grow-1 flex items-center flex-col"},ze=R({__name:"UserPictureForm",props:{id:null},emits:["submitted"],setup(x,{emit:b}){const c=x,d=S(null),_=S(null);y.get(`users/${c.id}/profile-picture`,{responseType:"blob"}).then(t=>{d.value=_.value=new File([t.data],"old-file")});function a(t){if(t===null){y.delete(`users/${c.id}/profile-picture`).then(()=>{d.value=null,b("submitted",null)});return}const i=new FormData;i.append("image",t,t.name),y.post(`users/${c.id}/profile-picture`,i).then(n=>{d.value=t,b("submitted",n.data.profile_picture)})}return(t,i)=>{const n=Se;return g(),P("div",De,[s(n,{value:e(d),"onUpdate:value":a},null,8,["value"])])}}}),Be={class:"p-5"},Ie={class:"flex gap-2"},Ee={class:"w-30"},Me={class:"!w-100 ml-auto"},Ae={class:"relative rounded"},He=["colSpan"],qe={key:1},Le=["colspan"],We={class:"mt-5"},Qe={class:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 px-5"},Xe={class:"lg:row-span-2"};function Q(x){return typeof x=="function"||Object.prototype.toString.call(x)==="[object Object]"&&!ve(x)}const Ye=R({__name:"staffs",setup(x){const b=ke(),c=ue(),d=me(),_=$e(),a=S(null),t=S(null),i=S(!0),n=U({limit:2,...c.query}),V=[b.display({id:"actions",minSize:50,cell:l=>s("div",{class:"flex gap-3"},[s(T,{icon:"i-ic:baseline-edit",size:"small",class:"!bg-warning !text-dark",onclick:()=>a.value=l.row.original.id??null},null),_.id!==l.row.original.id?s(T,{icon:"i-mdi:trash-can",size:"small",class:"!bg-danger !text-dark",onclick:()=>f(l.row.original.id)},null):null])}),b.accessor("name",{header:"Name",minSize:200,cell:l=>{let o;return s(M("string"),null,Q(o=l.getValue())?o:{default:()=>[o]})}}),b.accessor("email",{header:"Email",minSize:300,cell:l=>{let o;return s(M("string"),null,Q(o=l.getValue())?o:{default:()=>[o]})}}),b.accessor("role",{header:"Role",minSize:100,cell:l=>s(M("string"),null,{default:()=>{var o;return[(o=l.getValue())==null?void 0:o.display_name]}})})],u=Fe({get data(){var l;return((l=t==null?void 0:t.value)==null?void 0:l.data)??[]},columns:V,getCoreRowModel:Ue()});function r(){i.value=!0,y.get("users",{params:n}).then(l=>{t.value=l.data}).finally(()=>{i.value=!1})}function m(l){l.id===_.id&&_.$patch(l),ye(()=>{a.value===0&&(a.value=l.id),r()})}function f(l){y.delete(`/users/${l}`).then(()=>{r()})}const $=xe(l=>{n.search=l||void 0},200);return r(),ce(n,()=>{d.replace({query:n}),r()}),(l,o)=>{const B=pe,j=T,I=_e,k=fe,G=H,J=D,K=Y,ee=Z,se=ge,oe=we,E=X,te=ze,ae=Ne,le=je,ne=Te,re=Ve;return g(),P(O,null,[s(E,null,{default:p(()=>{var C;return[s(k,{color:"rgba(0,0,0,0)"},{default:p(()=>[s(B,{class:"text-2xl"},{default:p(()=>[z(" Staffs ")]),_:1}),s(I,null,{default:p(()=>[s(j,{modelValue:e(n).limit,"onUpdate:modelValue":o[0]||(o[0]=v=>e(n).limit=v),icon:"i-ic:round-add",class:"!bg-success !text-white",onClick:o[1]||(o[1]=v=>a.value=0)},null,8,["modelValue"])]),_:1})]),_:1}),w("div",Be,[w("div",Ie,[w("div",Ee,[s(G,{modelValue:e(n).limit,"onUpdate:modelValue":o[2]||(o[2]=v=>e(n).limit=v),items:[10,25,50,100],label:"Limit"},null,8,["modelValue"])]),w("div",Me,[s(J,{"model-value":e(n).search,label:"Search","onUpdate:modelValue":e($)},null,8,["model-value","onUpdate:modelValue"])])]),w("div",Ae,[s(ee,{"model-value":e(i),persistent:"",contained:"",class:"items-center justify-center"},{default:p(()=>[s(K,{size:"64",color:"primary",indeterminate:""})]),_:1},8,["model-value"]),s(se,null,{default:p(()=>[w("thead",null,[(g(!0),P(O,null,N(e(u).getHeaderGroups(),v=>(g(),P("tr",{key:v.id},[(g(!0),P(O,null,N(v.headers,F=>(g(),P("th",{key:F.id,colSpan:F.colSpan,style:be({minWidth:`${F.column.getSize()}px`})},[F.isPlaceholder?A("",!0):(g(),h(e(W),{key:0,render:F.column.columnDef.header,props:F.getContext()},null,8,["render","props"]))],12,He))),128))]))),128))]),w("tbody",null,[e(u).getRowModel().rows.length>0?(g(!0),P(O,{key:0},N(e(u).getRowModel().rows,v=>(g(),P("tr",{key:v.id},[(g(!0),P(O,null,N(v.getVisibleCells(),F=>(g(),P("td",{key:F.id,class:"py-2"},[s(e(W),{render:F.column.columnDef.cell,props:F.getContext()},null,8,["render","props"])]))),128))]))),128)):e(i)?A("",!0):(g(),P("tr",qe,[w("td",{colspan:V.length,class:"text-center font-bold !text-2xl"}," No Data Available ",8,Le)]))])]),_:1})]),w("div",We,[s(oe,{modelValue:e(n).page,"onUpdate:modelValue":o[3]||(o[3]=v=>e(n).page=v),length:(C=e(t))==null?void 0:C.last_page,rounded:"circle"},null,8,["modelValue","length"])])])]}),_:1}),s(re,{"model-value":e(a)!==null,persistent:""},{default:p(()=>[e(a)?(g(),h(E,{key:0,class:"mx-auto w-full"},{default:p(()=>[s(k,{color:"rgba(0,0,0,0)",title:"Edit User"},{append:p(()=>[s(j,{icon:"i-ic:baseline-cancel",onClick:o[4]||(o[4]=C=>a.value=null)})]),_:1}),w("div",Qe,[w("div",Xe,[s(te,{id:e(a),onSubmitted:o[5]||(o[5]=C=>e(a)===e(_).id&&(e(_).profile_picture=C||"null"))},null,8,["id"])]),w("div",null,[s(ae,{id:e(a),onSubmitted:m},null,8,["id"])]),w("div",null,[s(le,{id:e(a)},null,8,["id"])])])]),_:1})):e(a)===0?(g(),h(E,{key:1,class:"mx-auto w-full md:w-xl"},{default:p(()=>[s(k,{color:"rgba(0,0,0,0)",title:"Add User"},{append:p(()=>[s(j,{icon:"i-ic:baseline-cancel",onClick:o[6]||(o[6]=C=>a.value=null)})]),_:1}),s(ne,{onSubmitted:m})]),_:1})):A("",!0)]),_:1},8,["model-value"])],64)}}});const ss=Ce(Ye,[["__scopeId","data-v-b363bf92"]]);export{ss as default};
//# sourceMappingURL=staffs-bc834c60.js.map
