import{f as D,r as P,P as $,D as S,Q as B,R as L,S as Q,o as w,t as j,w as v,b,a as s,x as e,T as z,U as W,h as R,W as we,X as ee,Y as se,Z as te,$ as ve,c as x,a0 as be,a1 as Ve,a2 as oe,a3 as ae,v as q,a4 as ye,a5 as xe,a6 as Pe,a7 as Se,a8 as he,a9 as Fe,aa as ke,y as Ue,ab as T,ac as N,ad as Oe,B as A,ae as $e,af as Ce,_ as Te}from"./vendor-d25d14c9.js";import{l as je}from"./lodash-11bfcbd5.js";import{_ as Re}from"./ProfilePictureUpdater.vue_vue_type_style_index_0_lang-432fca4a.js";import{u as De,F as X,c as Ne,g as Be}from"./index.esm-6cf26349.js";import{u as ze}from"./main-eee8a3c1.js";const Ee={class:"flex flex-col gap-5"},Ie=D({__name:"NewUserForm",emits:["submitted"],setup(u,{emit:l}){const o={name:"",email:"",role_id:null,password:"",repeatPassword:""},r={name:"",email:"",role_id:"",password:"",repeatPassword:""},n=P(!1),a=$({...o}),t=$({...r}),_=$({password:!1,repeatPassword:!1}),p=P([]);function V(){n.value=!0,Object.assign(t,r),S.post("users",a).then(g=>{l("submitted",g.data)}).catch(g=>{Object.assign(t,g.response.data.errors)}).finally(()=>{n.value=!1})}return S.get("roles").then(g=>{p.value=g.data}),(g,c)=>{const m=B,f=L,O=R,h=Q;return w(),j(h,{class:"p-5",onSubmit:W(V,["prevent"])},{default:v(()=>[b("div",Ee,[s(m,{modelValue:e(a).name,"onUpdate:modelValue":c[0]||(c[0]=y=>e(a).name=y),label:"Name",error:!!e(t).name,"error-messages":e(t).name},null,8,["modelValue","error","error-messages"]),s(m,{modelValue:e(a).email,"onUpdate:modelValue":c[1]||(c[1]=y=>e(a).email=y),label:"Email",error:!!e(t).email,"error-messages":e(t).email},null,8,["modelValue","error","error-messages"]),s(f,{modelValue:e(a).role_id,"onUpdate:modelValue":c[2]||(c[2]=y=>e(a).role_id=y),items:e(p),"item-title":"display_name","item-value":"id",label:"Role",error:!!e(t).role_id,"error-messages":e(t).role_id},null,8,["modelValue","items","error","error-messages"]),s(m,{id:"new-password",modelValue:e(a).password,"onUpdate:modelValue":c[3]||(c[3]=y=>e(a).password=y),type:e(_).password?"text":"password",label:"Password","append-icon":e(_).password?"i-mdi:eye":"i-mdi:eye-off",error:!!e(t).password,"error-messages":e(t).password,"onClick:append":c[4]||(c[4]=y=>e(_).password=!e(_).password)},null,8,["modelValue","type","append-icon","error","error-messages"]),s(m,{id:"repeat-password",modelValue:e(a).repeatPassword,"onUpdate:modelValue":c[5]||(c[5]=y=>e(a).repeatPassword=y),type:e(_).repeatPassword?"text":"password",label:"Repeat Password","append-icon":e(_).repeatPassword?"i-mdi:eye":"i-mdi:eye-off",error:!!e(t).repeatPassword,"error-messages":e(t).repeatPassword,"onClick:append":c[6]||(c[6]=y=>e(_).repeatPassword=!e(_).repeatPassword)},null,8,["modelValue","type","append-icon","error","error-messages"])]),s(O,{type:"submit",class:"mt-5",color:"success"},{default:v(()=>[z(" Submit ")]),_:1})]),_:1},8,["onSubmit"])}}}),Me=D({__name:"ForcePasswordForm",props:{id:null},setup(u){const l=u,o=$({password:"",repeatPassword:""}),r=$({password:!1,repeatPassword:!1}),n={password:"",repeatPassword:""},a=we(),t=$({...n}),_=P(!1);function p(){_.value=!0,Object.assign(t,n),S.post(`users/${l.id}/password`,o).then(()=>{a.success("Password updated."),Object.assign(o,n)}).catch(V=>{Object.assign(t,V.response.data.errors)}).finally(()=>{_.value=!1})}return(V,g)=>{const c=B,m=R,f=Q,O=ee;return w(),j(O,{title:"Force Change Password"},{default:v(()=>[s(f,{class:"p-5",onSubmit:W(p,["prevent"])},{default:v(()=>[s(c,{id:"new-password",modelValue:e(o).password,"onUpdate:modelValue":g[0]||(g[0]=h=>e(o).password=h),type:e(r).password?"text":"password",label:"Password","append-icon":e(r).password?"i-mdi:eye":"i-mdi:eye-off",error:!!e(t).password,"error-messages":e(t).password,"onClick:append":g[1]||(g[1]=h=>e(r).password=!e(r).password)},null,8,["modelValue","type","append-icon","error","error-messages"]),s(c,{id:"repeat-password",modelValue:e(o).repeatPassword,"onUpdate:modelValue":g[2]||(g[2]=h=>e(o).repeatPassword=h),type:e(r).repeatPassword?"text":"password",label:"Repeat Password","append-icon":e(r).repeatPassword?"i-mdi:eye":"i-mdi:eye-off",error:!!e(t).repeatPassword,"error-messages":e(t).repeatPassword,"onClick:append":g[3]||(g[3]=h=>e(r).repeatPassword=!e(r).repeatPassword)},null,8,["modelValue","type","append-icon","error","error-messages"]),s(m,{class:"mt-5",color:"danger",type:"submit"},{default:v(()=>[z(" Submit ")]),_:1})]),_:1},8,["onSubmit"])]),_:1})}}}),qe={class:"flex justify-center"},Ae={class:"flex flex-col gap-5"},He=D({__name:"UserForm",props:{id:null},emits:["submitted"],setup(u,{emit:l}){const o=u,r=P([]),n=P(!1),a=P(!1),t={name:"",email:"",role_id:null},_={name:"",email:"",role_id:""},p=$({...t}),V=$({..._});function g(m){n.value=!0,Object.assign(p,t),S.get(`users/${m}`).then(f=>{Object.assign(p,je.exports.pick(f.data,["name","email","role_id"]))}).finally(()=>{n.value=!1})}async function c(){a.value=!0,Object.assign(V,_);try{let m;o.id?m=await S.put(`/users/${o.id}`,p).then(f=>f.data):m=await S.post("/users",p).then(f=>f.data),l("submitted",m)}catch(m){m instanceof ve&&Object.assign(V,m.response.data.errors)}finally{a.value=!1}}return S.get("roles").then(m=>{r.value=m.data}),o.id&&g(o.id),(m,f)=>{const O=se,h=te,y=B,i=L,d=R,E=Q;return w(),j(E,{onSubmit:W(c,["prevent"])},{default:v(()=>[s(h,{"model-value":e(n),persistent:"",contained:"",class:"align-center justify-center"},{default:v(()=>[b("div",qe,[s(O,{size:"64",color:"primary",indeterminate:""})])]),_:1},8,["model-value"]),b("div",Ae,[s(y,{modelValue:e(p).name,"onUpdate:modelValue":f[0]||(f[0]=U=>e(p).name=U),label:"Name",error:!!e(V).name,"error-messages":e(V).name},null,8,["modelValue","error","error-messages"]),s(y,{modelValue:e(p).email,"onUpdate:modelValue":f[1]||(f[1]=U=>e(p).email=U),label:"Email",error:!!e(V).email,"error-messages":e(V).email},null,8,["modelValue","error","error-messages"]),s(i,{modelValue:e(p).role_id,"onUpdate:modelValue":f[2]||(f[2]=U=>e(p).role_id=U),items:e(r),"item-title":"display_name","item-value":"id",label:"Role",error:!!e(V).role_id,"error-messages":e(V).role_id},null,8,["modelValue","items","error","error-messages"])]),b("div",null,[s(d,{class:"mt-5",color:"success",loading:e(a),type:"submit"},{default:v(()=>[z(" Submit ")]),_:1},8,["loading"])])]),_:1},8,["onSubmit"])}}}),Le={class:"flex-grow-1 flex items-center flex-col"},Qe=D({__name:"UserPictureForm",props:{id:null},emits:["submitted"],setup(u,{emit:l}){const o=u,r=P(null),n=P(null);S.get(`users/${o.id}/profile-picture`,{responseType:"blob"}).then(t=>{r.value=n.value=new File([t.data],"old-file")});function a(t){if(t===null){S.delete(`users/${o.id}/profile-picture`).then(()=>{r.value=null,l("submitted",null)});return}const _=new FormData;_.append("image",t,t.name),S.post(`users/${o.id}/profile-picture`,_).then(p=>{r.value=t,l("submitted",p.data.profile_picture)})}return(t,_)=>{const p=Re;return w(),x("div",Le,[s(p,{value:e(r),"onUpdate:value":a},null,8,["value"])])}}});var We=Object.defineProperty,Xe=Object.defineProperties,Ye=Object.getOwnPropertyDescriptors,Y=Object.getOwnPropertySymbols,Ze=Object.prototype.hasOwnProperty,Ge=Object.prototype.propertyIsEnumerable,Z=(u,l,o)=>l in u?We(u,l,{enumerable:!0,configurable:!0,writable:!0,value:o}):u[l]=o,G=(u,l)=>{for(var o in l||(l={}))Ze.call(l,o)&&Z(u,o,l[o]);if(Y)for(var o of Y(l))Ge.call(l,o)&&Z(u,o,l[o]);return u},J=(u,l)=>Xe(u,Ye(l));function H(u,l,{mode:o="replace",route:r=Ve(),router:n=oe()}={}){return be({get(){const a=r.query[u];return a==null?l??null:Array.isArray(a)?a.filter(Boolean):a},set(a){ae(()=>{n[e(o)](J(G({},r),{query:J(G({},r.query),{[u]:a===l||a===null?void 0:a})}))})}})}const Je={class:"p-5"},Ke={class:"flex gap-2"},es={class:"w-30"},ss={class:"!w-100 ml-auto"},ts={class:"relative rounded min-h-50"},os=["colSpan"],as={key:1},ls=["colspan"],rs={key:1},ns=["colspan"],is={class:"mt-5"},ds={class:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 px-5"},us={class:"lg:row-span-2"};function K(u){return typeof u=="function"||Object.prototype.toString.call(u)==="[object Object]"&&!$e(u)}const cs=D({__name:"staffs",setup(u){const l=Ne(),o=oe(),r=ze(),n=P(null),a=P(null),t=P(!0),_=P(!1),p=H("page","1"),V=H("limit","10"),g=H("search",null),c=[l.display({id:"actions",minSize:50,cell:i=>s("div",{class:"flex gap-3"},[s(R,{icon:"i-ic:baseline-edit",size:"small",class:"!bg-warning !text-dark",onclick:()=>n.value=i.row.original.id??null},null),r.id!==i.row.original.id?s(R,{icon:"i-mdi:trash-can",size:"small",class:"!bg-danger !text-dark",onclick:()=>h(i.row.original.id)},null):null])}),l.accessor("name",{header:"Name",minSize:200,cell:i=>{let d;return s(q("string"),null,K(d=i.getValue())?d:{default:()=>[d]})}}),l.accessor("email",{header:"Email",minSize:300,cell:i=>{let d;return s(q("string"),null,K(d=i.getValue())?d:{default:()=>[d]})}}),l.accessor("role",{header:"Role",minSize:100,cell:i=>s(q("string"),null,{default:()=>{var d;return[(d=i.getValue())==null?void 0:d.display_name]}})})],m=De({get data(){var i;return((i=a.value)==null?void 0:i.data)??[]},columns:c,getCoreRowModel:Be()});function f(){t.value=!0,S.get("users",{params:o.currentRoute.value.query}).then(i=>{a.value=i.data}).catch(()=>{_.value=!0}).finally(()=>{t.value=!1})}function O(i){i.id===r.id&&r.$patch(i),ae(()=>{n.value===0&&(n.value=i.id),f()})}function h(i){S.delete(`/users/${i}`).then(()=>{f()})}const y=Ce(i=>{g.value=i||void 0},200);return f(),ye(()=>o.currentRoute.value.query,()=>{f()},{deep:!0}),(i,d)=>{const E=xe,U=R,le=Pe,I=Se,re=L,ne=B,ie=se,de=te,ue=he,ce=Fe,M=ee,pe=Qe,me=He,_e=Me,fe=Ie,ge=ke;return w(),x(T,null,[s(M,null,{default:v(()=>{var C;return[s(I,{color:"rgba(0,0,0,0)"},{default:v(()=>[s(E,{class:"text-2xl"},{default:v(()=>[z(" Staffs ")]),_:1}),s(le,null,{default:v(()=>[s(U,{icon:"i-ic:round-add",class:"!bg-success !text-white",onClick:d[0]||(d[0]=F=>n.value=0)})]),_:1})]),_:1}),b("div",Je,[b("div",Ke,[b("div",es,[s(re,{modelValue:e(V),"onUpdate:modelValue":d[1]||(d[1]=F=>Ue(V)?V.value=F:null),items:[10,25,50,100],label:"Limit"},null,8,["modelValue"])]),b("div",ss,[s(ne,{"model-value":e(g),label:"Search","onUpdate:modelValue":e(y)},null,8,["model-value","onUpdate:modelValue"])])]),b("div",ts,[s(de,{"model-value":e(t),persistent:"",contained:"",class:"items-center justify-center"},{default:v(()=>[s(ie,{size:"64",color:"primary",indeterminate:""})]),_:1},8,["model-value"]),s(ue,null,{default:v(()=>[b("thead",null,[(w(!0),x(T,null,N(e(m).getHeaderGroups(),F=>(w(),x("tr",{key:F.id},[(w(!0),x(T,null,N(F.headers,k=>(w(),x("th",{key:k.id,colSpan:k.colSpan,style:Oe({minWidth:`${k.column.getSize()}px`})},[k.isPlaceholder?A("",!0):(w(),j(e(X),{key:0,render:k.column.columnDef.header,props:k.getContext()},null,8,["render","props"]))],12,os))),128))]))),128))]),b("tbody",null,[e(_)?(w(),x("tr",rs,[b("td",{colspan:c.length,class:"text-center font-bold !text-2xl"}," Server Error ",8,ns)])):(w(),x(T,{key:0},[e(m).getRowModel().rows.length>0?(w(!0),x(T,{key:0},N(e(m).getRowModel().rows,F=>(w(),x("tr",{key:F.id},[(w(!0),x(T,null,N(F.getVisibleCells(),k=>(w(),x("td",{key:k.id,class:"py-2"},[s(e(X),{render:k.column.columnDef.cell,props:k.getContext()},null,8,["render","props"])]))),128))]))),128)):e(t)?A("",!0):(w(),x("tr",as,[b("td",{colspan:c.length,class:"text-center font-bold !text-2xl"}," No Data Available ",8,ls)]))],64))])]),_:1})]),b("div",is,[s(ce,{"model-value":+e(p),length:(C=e(a))==null?void 0:C.last_page,rounded:"circle","onUpdate:modelValue":d[2]||(d[2]=F=>p.value=F.toString())},null,8,["model-value","length"])])])]}),_:1}),s(ge,{"model-value":e(n)!==null,persistent:""},{default:v(()=>[e(n)?(w(),j(M,{key:0,class:"mx-auto w-full"},{default:v(()=>[s(I,{color:"rgba(0,0,0,0)",title:"Edit User"},{append:v(()=>[s(U,{icon:"i-ic:baseline-cancel",onClick:d[3]||(d[3]=C=>n.value=null)})]),_:1}),b("div",ds,[b("div",us,[s(pe,{id:e(n),onSubmitted:d[4]||(d[4]=C=>e(n)===e(r).id&&(e(r).profile_picture=C||"null"))},null,8,["id"])]),b("div",null,[s(me,{id:e(n),onSubmitted:O},null,8,["id"])]),b("div",null,[s(_e,{id:e(n)},null,8,["id"])])])]),_:1})):e(n)===0?(w(),j(M,{key:1,class:"mx-auto w-full md:w-xl"},{default:v(()=>[s(I,{color:"rgba(0,0,0,0)",title:"Add User"},{append:v(()=>[s(U,{icon:"i-ic:baseline-cancel",onClick:d[5]||(d[5]=C=>n.value=null)})]),_:1}),s(fe,{onSubmitted:O})]),_:1})):A("",!0)]),_:1},8,["model-value"])],64)}}});const ws=Te(cs,[["__scopeId","data-v-65039443"]]);export{ws as default};
//# sourceMappingURL=staffs-9efb3043.js.map
