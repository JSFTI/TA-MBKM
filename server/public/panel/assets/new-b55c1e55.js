import{_ as A}from"./ACurrencyInput.vue_vue_type_script_setup_true_lang-ad6340cd.js";import{f as I,_ as O,N as g,r as v,C as p,$ as L,aj as R,o as C,t as $,w as c,b as k,a as n,x as a,A as y,R as q,S as E,ac as M,Y as Q,O as Y,P as z,ak as G,j as H,al as J,am as K,h as W,Q as X,ah as Z,U as ee}from"./vendor-58478656.js";import{l as te}from"./lodash-ab6a0fa0.js";import{_ as ae}from"./main-d7e4a2c8.js";const oe={class:"flex flex-col gap-2 py-5"},le={class:"flex gap-5 items-center mb-5"},ne=I({__name:"ProductDetailForm",props:{id:{default:null}},setup(b){const f=b,_={name:"",category_id:null,price:null,stock:0,published:!1,tags:[]},d={name:"",category_id:"",price:"",stock:"",published:""},V=O(),t=g({..._}),h=g({...d}),x=v([]),u=v([]),r=g({form:!1,search:!1});p.get("categories").then(l=>{x.value=l.data});const w=M(l=>{if(l.length===0){u.value=[];return}r.search=!0,p.get("tags",{params:{search:l}}).then(e=>{const m=t.tags.map(s=>s.id);u.value=e.data.filter(s=>!m.includes(s.id)),l&&(!e.data.length||e.data.find(s=>s.name!==l))?u.value.unshift({id:0,name:l}):u.value=u.value.filter(s=>!!s.id)}).finally(()=>{r.search=!1})},200);async function F(){r.form=!0,Object.assign(h,d);const l={...t};l.tags=l.tags.map(e=>e.name);try{if(f.id){await p.put(`products/${f.id}`,l);return}const e=await p.post("products",l);V.push(`/products/${e.data.id}`)}catch(e){e instanceof Q&&Object.assign(h,e.response.data.errors)}finally{r.form=!1}}return L(()=>t.tags.length,()=>{t.tags=te.exports.uniqBy(t.tags,"name")}),(l,e)=>{const m=Y,s=A,U=R,B=z,P=G,S=H,T=J,D=K,N=W,j=X;return C(),$(j,{onSubmit:E(F,["prevent"])},{default:c(()=>[k("div",oe,[n(m,{modelValue:a(t).name,"onUpdate:modelValue":e[0]||(e[0]=o=>a(t).name=o),label:"Product Name"},null,8,["modelValue"]),n(s,{modelValue:a(t).price,"onUpdate:modelValue":e[1]||(e[1]=o=>a(t).price=o),label:"Price",inputmode:"numeric"},null,8,["modelValue"]),k("div",le,[n(U,{"model-value":a(t).stock!==null,"onUpdate:modelValue":e[2]||(e[2]=o=>a(t).stock=a(t).stock===null?0:null)},null,8,["model-value"]),n(m,{modelValue:a(t).stock,"onUpdate:modelValue":e[3]||(e[3]=o=>a(t).stock=o),type:"number",min:"0",label:"Stock",disabled:a(t).stock===null,"hide-details":"",hint:"Disable if stock is infinite"},null,8,["modelValue","disabled"])]),n(B,{modelValue:a(t).category_id,"onUpdate:modelValue":e[4]||(e[4]=o=>a(t).category_id=o),items:a(x),"item-title":"name","item-value":"id",label:"Category"},null,8,["modelValue","items"]),n(T,{modelValue:a(t).tags,"onUpdate:modelValue":e[5]||(e[5]=o=>a(t).tags=o),items:a(u),multiple:"",label:"Tags","item-title":"name","item-value":"name",chips:"","closable-chips":"","return-object":"",placeholder:"Duplicate tags will be truncated",loading:a(r).search,"onUpdate:search":a(w)},{chip:c(({props:o,item:i})=>[n(P,y(o,{text:`${i.value.name} ${i.value.products_count?`(${i.value.products_count})`:""}`}),null,16,["text"])]),item:c(({props:o,item:i})=>[n(S,y(o,{title:`${i.value.name} ${i.value.products_count?`(${i.value.products_count})`:""}`}),null,16,["title"])]),_:1},8,["modelValue","items","loading","onUpdate:search"]),n(D,{modelValue:a(t).published,"onUpdate:modelValue":e[6]||(e[6]=o=>a(t).published=o),label:"Publish immediately"},null,8,["modelValue"])]),n(N,{type:"submit",color:"primary"},{default:c(()=>[q(" Submit ")]),_:1})]),_:1},8,["onSubmit"])}}}),se={};function ie(b,f){const _=ne,d=Z,V=ee;return C(),$(V,{title:"New Product",class:"w-full lg:w-200 mx-auto p-5"},{default:c(()=>[n(d,null,{default:c(()=>[n(_)]),_:1})]),_:1})}const me=ae(se,[["render",ie]]);export{me as default};
//# sourceMappingURL=new-b55c1e55.js.map
