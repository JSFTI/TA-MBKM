import{f as D,r as S,P as U,D as b,Q as z,R as L,S as Q,o as g,t as T,w as f,b as w,a as s,x as e,T as B,U as W,h as R,W as ue,X as Z,Y as G,Z as J,$ as me,c as P,a0 as ce,v as A,a1 as pe,a2 as _e,a3 as fe,a4 as ge,a5 as we,a6 as ve,a7 as Ve,y as be,a8 as O,a9 as N,aa as ye,B as H,ab as xe,ac as Pe,ad as Se,_ as Fe}from"./vendor-d8963f8a.js";import{l as ke}from"./lodash-89c1e3b6.js";import{_ as Ue}from"./ProfilePictureUpdater.vue_vue_type_style_index_0_lang-b71d05d6.js";import{u as q,a as $e,F as X,c as he,g as Ce}from"./index-caac9ef2.js";import{u as Te}from"./main-6b47012f.js";const Re={class:"flex flex-col gap-5"},je=D({__name:"NewUserForm",emits:["submitted"],setup(y,{emit:V}){const c={name:"",email:"",role_id:null,password:"",repeatPassword:""},l={name:"",email:"",role_id:"",password:"",repeatPassword:""},a=S(!1),n=U({...c}),t=U({...l}),m=U({password:!1,repeatPassword:!1}),i=S([]);function v(){a.value=!0,Object.assign(t,l),b.post("users",n).then(p=>{V("submitted",p.data)}).catch(p=>{Object.assign(t,p.response.data.errors)}).finally(()=>{a.value=!1})}return b.get("roles").then(p=>{i.value=p.data}),(p,d)=>{const u=z,_=L,$=R,x=Q;return g(),T(x,{class:"p-5",onSubmit:W(v,["prevent"])},{default:f(()=>[w("div",Re,[s(u,{modelValue:e(n).name,"onUpdate:modelValue":d[0]||(d[0]=o=>e(n).name=o),label:"Name",error:!!e(t).name,"error-messages":e(t).name},null,8,["modelValue","error","error-messages"]),s(u,{modelValue:e(n).email,"onUpdate:modelValue":d[1]||(d[1]=o=>e(n).email=o),label:"Email",error:!!e(t).email,"error-messages":e(t).email},null,8,["modelValue","error","error-messages"]),s(_,{modelValue:e(n).role_id,"onUpdate:modelValue":d[2]||(d[2]=o=>e(n).role_id=o),items:e(i),"item-title":"display_name","item-value":"id",label:"Role",error:!!e(t).role_id,"error-messages":e(t).role_id},null,8,["modelValue","items","error","error-messages"]),s(u,{id:"new-password",modelValue:e(n).password,"onUpdate:modelValue":d[3]||(d[3]=o=>e(n).password=o),type:e(m).password?"text":"password",label:"Password","append-icon":e(m).password?"i-mdi:eye":"i-mdi:eye-off",error:!!e(t).password,"error-messages":e(t).password,"onClick:append":d[4]||(d[4]=o=>e(m).password=!e(m).password)},null,8,["modelValue","type","append-icon","error","error-messages"]),s(u,{id:"repeat-password",modelValue:e(n).repeatPassword,"onUpdate:modelValue":d[5]||(d[5]=o=>e(n).repeatPassword=o),type:e(m).repeatPassword?"text":"password",label:"Repeat Password","append-icon":e(m).repeatPassword?"i-mdi:eye":"i-mdi:eye-off",error:!!e(t).repeatPassword,"error-messages":e(t).repeatPassword,"onClick:append":d[6]||(d[6]=o=>e(m).repeatPassword=!e(m).repeatPassword)},null,8,["modelValue","type","append-icon","error","error-messages"])]),s($,{type:"submit",class:"mt-5",color:"success"},{default:f(()=>[B(" Submit ")]),_:1})]),_:1},8,["onSubmit"])}}}),Oe=D({__name:"ForcePasswordForm",props:{id:null},setup(y){const V=y,c=U({password:"",repeatPassword:""}),l=U({password:!1,repeatPassword:!1}),a={password:"",repeatPassword:""},n=ue(),t=U({...a}),m=S(!1);function i(){m.value=!0,Object.assign(t,a),b.post(`users/${V.id}/password`,c).then(()=>{n.success("Password updated."),Object.assign(c,a)}).catch(v=>{Object.assign(t,v.response.data.errors)}).finally(()=>{m.value=!1})}return(v,p)=>{const d=z,u=R,_=Q,$=Z;return g(),T($,{title:"Force Change Password"},{default:f(()=>[s(_,{class:"p-5",onSubmit:W(i,["prevent"])},{default:f(()=>[s(d,{id:"new-password",modelValue:e(c).password,"onUpdate:modelValue":p[0]||(p[0]=x=>e(c).password=x),type:e(l).password?"text":"password",label:"Password","append-icon":e(l).password?"i-mdi:eye":"i-mdi:eye-off",error:!!e(t).password,"error-messages":e(t).password,"onClick:append":p[1]||(p[1]=x=>e(l).password=!e(l).password)},null,8,["modelValue","type","append-icon","error","error-messages"]),s(d,{id:"repeat-password",modelValue:e(c).repeatPassword,"onUpdate:modelValue":p[2]||(p[2]=x=>e(c).repeatPassword=x),type:e(l).repeatPassword?"text":"password",label:"Repeat Password","append-icon":e(l).repeatPassword?"i-mdi:eye":"i-mdi:eye-off",error:!!e(t).repeatPassword,"error-messages":e(t).repeatPassword,"onClick:append":p[3]||(p[3]=x=>e(l).repeatPassword=!e(l).repeatPassword)},null,8,["modelValue","type","append-icon","error","error-messages"]),s(u,{class:"mt-5",color:"danger",type:"submit"},{default:f(()=>[B(" Submit ")]),_:1})]),_:1},8,["onSubmit"])]),_:1})}}}),De={class:"flex justify-center"},Ne={class:"flex flex-col gap-5"},ze=D({__name:"UserForm",props:{id:null},emits:["submitted"],setup(y,{emit:V}){const c=y,l=S([]),a=S(!1),n=S(!1),t={name:"",email:"",role_id:null},m={name:"",email:"",role_id:""},i=U({...t}),v=U({...m});function p(u){a.value=!0,Object.assign(i,t),b.get(`users/${u}`).then(_=>{Object.assign(i,ke.exports.pick(_.data,["name","email","role_id"]))}).finally(()=>{a.value=!1})}async function d(){n.value=!0,Object.assign(v,m);try{let u;c.id?u=await b.put(`/users/${c.id}`,i).then(_=>_.data):u=await b.post("/users",i).then(_=>_.data),V("submitted",u)}catch(u){u instanceof me&&Object.assign(v,u.response.data.errors)}finally{n.value=!1}}return b.get("roles").then(u=>{l.value=u.data}),c.id&&p(c.id),(u,_)=>{const $=G,x=J,o=z,r=L,I=R,j=Q;return g(),T(j,{onSubmit:W(d,["prevent"])},{default:f(()=>[s(x,{"model-value":e(a),persistent:"",contained:"",class:"align-center justify-center"},{default:f(()=>[w("div",De,[s($,{size:"64",color:"primary",indeterminate:""})])]),_:1},8,["model-value"]),w("div",Ne,[s(o,{modelValue:e(i).name,"onUpdate:modelValue":_[0]||(_[0]=h=>e(i).name=h),label:"Name",error:!!e(v).name,"error-messages":e(v).name},null,8,["modelValue","error","error-messages"]),s(o,{modelValue:e(i).email,"onUpdate:modelValue":_[1]||(_[1]=h=>e(i).email=h),label:"Email",error:!!e(v).email,"error-messages":e(v).email},null,8,["modelValue","error","error-messages"]),s(r,{modelValue:e(i).role_id,"onUpdate:modelValue":_[2]||(_[2]=h=>e(i).role_id=h),items:e(l),"item-title":"display_name","item-value":"id",label:"Role",error:!!e(v).role_id,"error-messages":e(v).role_id},null,8,["modelValue","items","error","error-messages"])]),w("div",null,[s(I,{class:"mt-5",color:"success",loading:e(n),type:"submit"},{default:f(()=>[B(" Submit ")]),_:1},8,["loading"])])]),_:1},8,["onSubmit"])}}}),Be={class:"flex-grow-1 flex items-center flex-col"},Ie=D({__name:"UserPictureForm",props:{id:null},emits:["submitted"],setup(y,{emit:V}){const c=y,l=S(null),a=S(null);b.get(`users/${c.id}/profile-picture`,{responseType:"blob"}).then(t=>{l.value=a.value=new File([t.data],"old-file")});function n(t){if(t===null){b.delete(`users/${c.id}/profile-picture`).then(()=>{l.value=null,V("submitted",null)});return}const m=new FormData;m.append("image",t,t.name),b.post(`users/${c.id}/profile-picture`,m).then(i=>{l.value=t,V("submitted",i.data.profile_picture)})}return(t,m)=>{const i=Ue;return g(),P("div",Be,[s(i,{value:e(l),"onUpdate:value":n},null,8,["value"])])}}}),Ee={class:"p-5"},Me={class:"flex gap-2"},Ae={class:"w-30"},He={class:"!w-100 ml-auto"},qe={class:"relative rounded"},Le=["colSpan"],Qe={key:1},We=["colspan"],Xe={class:"mt-5"},Ye={class:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 px-5"},Ze={class:"lg:row-span-2"};function Y(y){return typeof y=="function"||Object.prototype.toString.call(y)==="[object Object]"&&!xe(y)}const Ge=D({__name:"staffs",setup(y){const V=he(),c=ce(),l=Te(),a=S(null),n=S(null),t=S(!0),m=q("page","1"),i=q("limit","10"),v=q("search",null),p=[V.display({id:"actions",minSize:50,cell:o=>s("div",{class:"flex gap-3"},[s(R,{icon:"i-ic:baseline-edit",size:"small",class:"!bg-warning !text-dark",onclick:()=>a.value=o.row.original.id??null},null),l.id!==o.row.original.id?s(R,{icon:"i-mdi:trash-can",size:"small",class:"!bg-danger !text-dark",onclick:()=>$(o.row.original.id)},null):null])}),V.accessor("name",{header:"Name",minSize:200,cell:o=>{let r;return s(A("string"),null,Y(r=o.getValue())?r:{default:()=>[r]})}}),V.accessor("email",{header:"Email",minSize:300,cell:o=>{let r;return s(A("string"),null,Y(r=o.getValue())?r:{default:()=>[r]})}}),V.accessor("role",{header:"Role",minSize:100,cell:o=>s(A("string"),null,{default:()=>{var r;return[(r=o.getValue())==null?void 0:r.display_name]}})})],d=$e({get data(){var o;return((o=n==null?void 0:n.value)==null?void 0:o.data)??[]},columns:p,getCoreRowModel:Ce()});function u(){t.value=!0,b.get("users",{params:c.currentRoute.value.query}).then(o=>{n.value=o.data}).finally(()=>{t.value=!1})}function _(o){o.id===l.id&&l.$patch(o),Pe(()=>{a.value===0&&(a.value=o.id),u()})}function $(o){b.delete(`/users/${o}`).then(()=>{u()})}const x=Se(o=>{v.value=o||void 0},200);return u(),pe(()=>c.currentRoute.value.query,()=>{u()},{deep:!0}),(o,r)=>{const I=_e,j=R,h=fe,E=ge,K=L,ee=z,se=G,oe=J,te=we,ae=ve,M=Z,le=Ie,ne=ze,re=Oe,ie=je,de=Ve;return g(),P(O,null,[s(M,null,{default:f(()=>{var C;return[s(E,{color:"rgba(0,0,0,0)"},{default:f(()=>[s(I,{class:"text-2xl"},{default:f(()=>[B(" Staffs ")]),_:1}),s(h,null,{default:f(()=>[s(j,{icon:"i-ic:round-add",class:"!bg-success !text-white",onClick:r[0]||(r[0]=F=>a.value=0)})]),_:1})]),_:1}),w("div",Ee,[w("div",Me,[w("div",Ae,[s(K,{modelValue:e(i),"onUpdate:modelValue":r[1]||(r[1]=F=>be(i)?i.value=F:null),items:[10,25,50,100],label:"Limit"},null,8,["modelValue"])]),w("div",He,[s(ee,{"model-value":e(v),label:"Search","onUpdate:modelValue":e(x)},null,8,["model-value","onUpdate:modelValue"])])]),w("div",qe,[s(oe,{"model-value":e(t),persistent:"",contained:"",class:"items-center justify-center"},{default:f(()=>[s(se,{size:"64",color:"primary",indeterminate:""})]),_:1},8,["model-value"]),s(te,null,{default:f(()=>[w("thead",null,[(g(!0),P(O,null,N(e(d).getHeaderGroups(),F=>(g(),P("tr",{key:F.id},[(g(!0),P(O,null,N(F.headers,k=>(g(),P("th",{key:k.id,colSpan:k.colSpan,style:ye({minWidth:`${k.column.getSize()}px`})},[k.isPlaceholder?H("",!0):(g(),T(e(X),{key:0,render:k.column.columnDef.header,props:k.getContext()},null,8,["render","props"]))],12,Le))),128))]))),128))]),w("tbody",null,[e(d).getRowModel().rows.length>0?(g(!0),P(O,{key:0},N(e(d).getRowModel().rows,F=>(g(),P("tr",{key:F.id},[(g(!0),P(O,null,N(F.getVisibleCells(),k=>(g(),P("td",{key:k.id,class:"py-2"},[s(e(X),{render:k.column.columnDef.cell,props:k.getContext()},null,8,["render","props"])]))),128))]))),128)):e(t)?H("",!0):(g(),P("tr",Qe,[w("td",{colspan:p.length,class:"text-center font-bold !text-2xl"}," No Data Available ",8,We)]))])]),_:1})]),w("div",Xe,[s(ae,{"model-value":+e(m),length:(C=e(n))==null?void 0:C.last_page,rounded:"circle","onUpdate:modelValue":r[2]||(r[2]=F=>m.value=F.toString())},null,8,["model-value","length"])])])]}),_:1}),s(de,{"model-value":e(a)!==null,persistent:""},{default:f(()=>[e(a)?(g(),T(M,{key:0,class:"mx-auto w-full"},{default:f(()=>[s(E,{color:"rgba(0,0,0,0)",title:"Edit User"},{append:f(()=>[s(j,{icon:"i-ic:baseline-cancel",onClick:r[3]||(r[3]=C=>a.value=null)})]),_:1}),w("div",Ye,[w("div",Ze,[s(le,{id:e(a),onSubmitted:r[4]||(r[4]=C=>e(a)===e(l).id&&(e(l).profile_picture=C||"null"))},null,8,["id"])]),w("div",null,[s(ne,{id:e(a),onSubmitted:_},null,8,["id"])]),w("div",null,[s(re,{id:e(a)},null,8,["id"])])])]),_:1})):e(a)===0?(g(),T(M,{key:1,class:"mx-auto w-full md:w-xl"},{default:f(()=>[s(E,{color:"rgba(0,0,0,0)",title:"Add User"},{append:f(()=>[s(j,{icon:"i-ic:baseline-cancel",onClick:r[5]||(r[5]=C=>a.value=null)})]),_:1}),s(ie,{onSubmitted:_})]),_:1})):H("",!0)]),_:1},8,["model-value"])],64)}}});const ts=Fe(Ge,[["__scopeId","data-v-d09379e2"]]);export{ts as default};
//# sourceMappingURL=staffs-6e310f93.js.map
