import{f as on,r as Qt,am as eo,an as xr,C as Ut,ae as Bc,ac as Rc,x as N,ao as Ic,ap as Pc,P as Ur,aq as Lc,ar as zc,as as Vc,af as Hc,a1 as Dl,at as $c,au as jc,o as ws,c as _c,b as jt,a as U,y as Yi,al as Gn,w as dt,A as Os,B as Cl,R as kl,h as El,V as Wc,Q as xl,aj as Kc,X as Uc,_ as qc,W as Jc,a0 as Gc,D as Yn,av as Yc,aw as Xc,ax as Qc,ay as Zc,S as ed,t as Vo,T as td,U as nd,ad as rd,$ as id,j as sd}from"./vendor-d8963f8a.js";import{_ as od}from"./ACurrencyInput.vue_vue_type_script_setup_true_lang-cebbc278.js";import{l as Ho}from"./lodash-89c1e3b6.js";import{u as ad}from"./main-38cd24a7.js";function ce(n){this.content=n}ce.prototype={constructor:ce,find:function(n){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===n)return e;return-1},get:function(n){var e=this.find(n);return e==-1?void 0:this.content[e+1]},update:function(n,e,t){var r=t&&t!=n?this.remove(t):this,i=r.find(n),s=r.content.slice();return i==-1?s.push(t||n,e):(s[i+1]=e,t&&(s[i]=t)),new ce(s)},remove:function(n){var e=this.find(n);if(e==-1)return this;var t=this.content.slice();return t.splice(e,2),new ce(t)},addToStart:function(n,e){return new ce([n,e].concat(this.remove(n).content))},addToEnd:function(n,e){var t=this.remove(n).content.slice();return t.push(n,e),new ce(t)},addBefore:function(n,e,t){var r=this.remove(e),i=r.content.slice(),s=r.find(n);return i.splice(s==-1?i.length:s,0,e,t),new ce(i)},forEach:function(n){for(var e=0;e<this.content.length;e+=2)n(this.content[e],this.content[e+1])},prepend:function(n){return n=ce.from(n),n.size?new ce(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=ce.from(n),n.size?new ce(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var e=this;n=ce.from(n);for(var t=0;t<n.content.length;t+=2)e=e.remove(n.content[t]);return e},toObject:function(){var n={};return this.forEach(function(e,t){n[e]=t}),n},get size(){return this.content.length>>1}};ce.from=function(n){if(n instanceof ce)return n;var e=[];if(n)for(var t in n)e.push(t,n[t]);return new ce(e)};function Sl(n,e,t){for(let r=0;;r++){if(r==n.childCount||r==e.childCount)return n.childCount==e.childCount?null:t;let i=n.child(r),s=e.child(r);if(i==s){t+=i.nodeSize;continue}if(!i.sameMarkup(s))return t;if(i.isText&&i.text!=s.text){for(let o=0;i.text[o]==s.text[o];o++)t++;return t}if(i.content.size||s.content.size){let o=Sl(i.content,s.content,t+1);if(o!=null)return o}t+=i.nodeSize}}function Al(n,e,t,r){for(let i=n.childCount,s=e.childCount;;){if(i==0||s==0)return i==s?null:{a:t,b:r};let o=n.child(--i),a=e.child(--s),l=o.nodeSize;if(o==a){t-=l,r-=l;continue}if(!o.sameMarkup(a))return{a:t,b:r};if(o.isText&&o.text!=a.text){let c=0,u=Math.min(o.text.length,a.text.length);for(;c<u&&o.text[o.text.length-c-1]==a.text[a.text.length-c-1];)c++,t--,r--;return{a:t,b:r}}if(o.content.size||a.content.size){let c=Al(o.content,a.content,t-1,r-1);if(c)return c}t-=l,r-=l}}class k{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,t,r,i=0,s){for(let o=0,a=0;a<t;o++){let l=this.content[o],c=a+l.nodeSize;if(c>e&&r(l,i+a,s||null,o)!==!1&&l.content.size){let u=a+1;l.nodesBetween(Math.max(0,e-u),Math.min(l.content.size,t-u),r,i+u)}a=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,r,i){let s="",o=!0;return this.nodesBetween(e,t,(a,l)=>{a.isText?(s+=a.text.slice(Math.max(e,l)-l,t-l),o=!r):a.isLeaf?(i?s+=typeof i=="function"?i(a):i:a.type.spec.leafText&&(s+=a.type.spec.leafText(a)),o=!r):!o&&a.isBlock&&(s+=r,o=!0)},0),s}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,r=e.firstChild,i=this.content.slice(),s=0;for(t.isText&&t.sameMarkup(r)&&(i[i.length-1]=t.withText(t.text+r.text),s=1);s<e.content.length;s++)i.push(e.content[s]);return new k(i,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let r=[],i=0;if(t>e)for(let s=0,o=0;o<t;s++){let a=this.content[s],l=o+a.nodeSize;l>e&&((o<e||l>t)&&(a.isText?a=a.cut(Math.max(0,e-o),Math.min(a.text.length,t-o)):a=a.cut(Math.max(0,e-o-1),Math.min(a.content.size,t-o-1))),r.push(a),i+=a.nodeSize),o=l}return new k(r,i)}cutByIndex(e,t){return e==t?k.empty:e==0&&t==this.content.length?this:new k(this.content.slice(e,t))}replaceChild(e,t){let r=this.content[e];if(r==t)return this;let i=this.content.slice(),s=this.size+t.nodeSize-r.nodeSize;return i[e]=t,new k(i,s)}addToStart(e){return new k([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new k(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,r=0;t<this.content.length;t++){let i=this.content[t];e(i,r,t),r+=i.nodeSize}}findDiffStart(e,t=0){return Sl(this,e,t)}findDiffEnd(e,t=this.size,r=e.size){return Al(this,e,t,r)}findIndex(e,t=-1){if(e==0)return Vr(0,e);if(e==this.size)return Vr(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,i=0;;r++){let s=this.child(r),o=i+s.nodeSize;if(o>=e)return o==e||t>0?Vr(r+1,o):Vr(r,i);i=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return k.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new k(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return k.empty;let t,r=0;for(let i=0;i<e.length;i++){let s=e[i];r+=s.nodeSize,i&&s.isText&&e[i-1].sameMarkup(s)?(t||(t=e.slice(0,i)),t[t.length-1]=s.withText(t[t.length-1].text+s.text)):t&&t.push(s)}return new k(t||e,r)}static from(e){if(!e)return k.empty;if(e instanceof k)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new k([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}k.empty=new k([],0);const Xi={index:0,offset:0};function Vr(n,e){return Xi.index=n,Xi.offset=e,Xi}function Qr(n,e){if(n===e)return!0;if(!(n&&typeof n=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(n);if(Array.isArray(e)!=t)return!1;if(t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!Qr(n[r],e[r]))return!1}else{for(let r in n)if(!(r in e)||!Qr(n[r],e[r]))return!1;for(let r in e)if(!(r in n))return!1}return!0}let W=class{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,r=!1;for(let i=0;i<e.length;i++){let s=e[i];if(this.eq(s))return e;if(this.type.excludes(s.type))t||(t=e.slice(0,i));else{if(s.type.excludes(this.type))return e;!r&&s.type.rank>this.type.rank&&(t||(t=e.slice(0,i)),t.push(this),r=!0),t&&t.push(s)}}return t||(t=e.slice()),r||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&Qr(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[t.type];if(!r)throw new RangeError(`There is no mark type ${t.type} in this schema`);return r.create(t.attrs)}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(t[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return W.none;if(e instanceof W)return[e];let t=e.slice();return t.sort((r,i)=>r.type.rank-i.type.rank),t}};W.none=[];class Zr extends Error{}class w{constructor(e,t,r){this.content=e,this.openStart=t,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let r=Ol(this.content,e+this.openStart,t);return r&&new w(r,this.openStart,this.openEnd)}removeBetween(e,t){return new w(wl(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return w.empty;let r=t.openStart||0,i=t.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new w(k.fromJSON(e,t.content),r,i)}static maxOpen(e,t=!0){let r=0,i=0;for(let s=e.firstChild;s&&!s.isLeaf&&(t||!s.type.spec.isolating);s=s.firstChild)r++;for(let s=e.lastChild;s&&!s.isLeaf&&(t||!s.type.spec.isolating);s=s.lastChild)i++;return new w(e,r,i)}}w.empty=new w(k.empty,0,0);function wl(n,e,t){let{index:r,offset:i}=n.findIndex(e),s=n.maybeChild(r),{index:o,offset:a}=n.findIndex(t);if(i==e||s.isText){if(a!=t&&!n.child(o).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(r!=o)throw new RangeError("Removing non-flat range");return n.replaceChild(r,s.copy(wl(s.content,e-i-1,t-i-1)))}function Ol(n,e,t,r){let{index:i,offset:s}=n.findIndex(e),o=n.maybeChild(i);if(s==e||o.isText)return r&&!r.canReplace(i,i,t)?null:n.cut(0,e).append(t).append(n.cut(e));let a=Ol(o.content,e-s-1,t);return a&&n.replaceChild(i,o.copy(a))}function ld(n,e,t){if(t.openStart>n.depth)throw new Zr("Inserted content deeper than insertion position");if(n.depth-t.openStart!=e.depth-t.openEnd)throw new Zr("Inconsistent open depths");return Ml(n,e,t,0)}function Ml(n,e,t,r){let i=n.index(r),s=n.node(r);if(i==e.index(r)&&r<n.depth-t.openStart){let o=Ml(n,e,t,r+1);return s.copy(s.content.replaceChild(i,o))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&n.depth==r&&e.depth==r){let o=n.parent,a=o.content;return Jt(o,a.cut(0,n.parentOffset).append(t.content).append(a.cut(e.parentOffset)))}else{let{start:o,end:a}=ud(t,n);return Jt(s,Fl(n,o,a,e,r))}else return Jt(s,ei(n,e,r))}function Tl(n,e){if(!e.type.compatibleContent(n.type))throw new Zr("Cannot join "+e.type.name+" onto "+n.type.name)}function Ms(n,e,t){let r=n.node(t);return Tl(r,e.node(t)),r}function qt(n,e){let t=e.length-1;t>=0&&n.isText&&n.sameMarkup(e[t])?e[t]=n.withText(e[t].text+n.text):e.push(n)}function ar(n,e,t,r){let i=(e||n).node(t),s=0,o=e?e.index(t):i.childCount;n&&(s=n.index(t),n.depth>t?s++:n.textOffset&&(qt(n.nodeAfter,r),s++));for(let a=s;a<o;a++)qt(i.child(a),r);e&&e.depth==t&&e.textOffset&&qt(e.nodeBefore,r)}function Jt(n,e){return n.type.checkContent(e),n.copy(e)}function Fl(n,e,t,r,i){let s=n.depth>i&&Ms(n,e,i+1),o=r.depth>i&&Ms(t,r,i+1),a=[];return ar(null,n,i,a),s&&o&&e.index(i)==t.index(i)?(Tl(s,o),qt(Jt(s,Fl(n,e,t,r,i+1)),a)):(s&&qt(Jt(s,ei(n,e,i+1)),a),ar(e,t,i,a),o&&qt(Jt(o,ei(t,r,i+1)),a)),ar(r,null,i,a),new k(a)}function ei(n,e,t){let r=[];if(ar(null,n,t,r),n.depth>t){let i=Ms(n,e,t+1);qt(Jt(i,ei(n,e,t+1)),r)}return ar(e,null,t,r),new k(r)}function ud(n,e){let t=e.depth-n.openStart,i=e.node(t).copy(n.content);for(let s=t-1;s>=0;s--)i=e.node(s).copy(k.from(i));return{start:i.resolveNoCache(n.openStart+t),end:i.resolveNoCache(i.content.size-n.openEnd-t)}}class vr{constructor(e,t,r){this.pos=e,this.path=t,this.parentOffset=r,this.depth=t.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=e.child(t);return r?e.child(t).cut(r):i}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let r=this.path[t*3],i=t==0?0:this.path[t*3-1]+1;for(let s=0;s<e;s++)i+=r.child(s).nodeSize;return i}marks(){let e=this.parent,t=this.index();if(e.content.size==0)return W.none;if(this.textOffset)return e.child(t).marks;let r=e.maybeChild(t-1),i=e.maybeChild(t);if(!r){let a=r;r=i,i=a}let s=r.marks;for(var o=0;o<s.length;o++)s[o].type.spec.inclusive===!1&&(!i||!s[o].isInSet(i.marks))&&(s=s[o--].removeFromSet(s));return s}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let r=t.marks,i=e.parent.maybeChild(e.index());for(var s=0;s<r.length;s++)r[s].type.spec.inclusive===!1&&(!i||!r[s].isInSet(i.marks))&&(r=r[s--].removeFromSet(r));return r}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!t||t(this.node(r))))return new ti(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let r=[],i=0,s=t;for(let o=e;;){let{index:a,offset:l}=o.content.findIndex(s),c=s-l;if(r.push(o,a,i+l),!c||(o=o.child(a),o.isText))break;s=c-1,i+=l+1}return new vr(t,r,s)}static resolveCached(e,t){for(let i=0;i<Qi.length;i++){let s=Qi[i];if(s.pos==t&&s.doc==e)return s}let r=Qi[Zi]=vr.resolve(e,t);return Zi=(Zi+1)%cd,r}}let Qi=[],Zi=0,cd=12;class ti{constructor(e,t,r){this.$from=e,this.$to=t,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const dd=Object.create(null);let ht=class{constructor(e,t,r,i=W.none){this.type=e,this.attrs=t,this.marks=i,this.content=r||k.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,r,i=0){this.content.nodesBetween(e,t,r,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,r,i){return this.content.textBetween(e,t,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,r){return this.type==e&&Qr(this.attrs,t||e.defaultAttrs||dd)&&W.sameSet(this.marks,r||W.none)}copy(e=null){return e==this.content?this:new ht(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new ht(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,r=!1){if(e==t)return w.empty;let i=this.resolve(e),s=this.resolve(t),o=r?0:i.sharedDepth(t),a=i.start(o),c=i.node(o).content.cut(i.pos-a,s.pos-a);return new w(c,i.depth-o,s.depth-o)}replace(e,t,r){return ld(this.resolve(e),this.resolve(t),r)}nodeAt(e){for(let t=this;;){let{index:r,offset:i}=t.content.findIndex(e);if(t=t.maybeChild(r),!t)return null;if(i==e||t.isText)return t;e-=i+1}}childAfter(e){let{index:t,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:t,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(t),index:t,offset:r};let i=this.content.child(t-1);return{node:i,index:t-1,offset:r-i.nodeSize}}resolve(e){return vr.resolveCached(this,e)}resolveNoCache(e){return vr.resolve(this,e)}rangeHasMark(e,t,r){let i=!1;return t>e&&this.nodesBetween(e,t,s=>(r.isInSet(s.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),Nl(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,r=k.empty,i=0,s=r.childCount){let o=this.contentMatchAt(e).matchFragment(r,i,s),a=o&&o.matchFragment(this.content,t);if(!a||!a.validEnd)return!1;for(let l=i;l<s;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(e,t,r,i){if(i&&!this.type.allowsMarks(i))return!1;let s=this.contentMatchAt(e).matchType(r),o=s&&s.matchFragment(this.content,t);return o?o.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content);let e=W.none;for(let t=0;t<this.marks.length;t++)e=this.marks[t].addToSet(e);if(!W.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(t=>t.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let r=null;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,r)}let i=k.fromJSON(e,t.content);return e.nodeType(t.type).create(t.attrs,i,r)}};ht.prototype.text=void 0;class ni extends ht{constructor(e,t,r,i){if(super(e,t,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Nl(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new ni(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new ni(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return e==0&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function Nl(n,e){for(let t=n.length-1;t>=0;t--)e=n[t].type.name+"("+e+")";return e}class Zt{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let r=new fd(e,t);if(r.next==null)return Zt.empty;let i=Bl(r);r.next&&r.err("Unexpected trailing text");let s=bd(vd(i));return Dd(s,r),s}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,r=e.childCount){let i=this;for(let s=t;i&&s<r;s++)i=i.matchType(e.child(s).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let r=0;r<e.next.length;r++)if(this.next[t].type==e.next[r].type)return!0;return!1}fillBefore(e,t=!1,r=0){let i=[this];function s(o,a){let l=o.matchFragment(e,r);if(l&&(!t||l.validEnd))return k.from(a.map(c=>c.createAndFill()));for(let c=0;c<o.next.length;c++){let{type:u,next:d}=o.next[c];if(!(u.isText||u.hasRequiredAttrs())&&i.indexOf(d)==-1){i.push(d);let f=s(d,a.concat(u));if(f)return f}}return null}return s(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),s=i.match;if(s.matchType(e)){let o=[];for(let a=i;a.type;a=a.via)o.push(a.type);return o.reverse()}for(let o=0;o<s.next.length;o++){let{type:a,next:l}=s.next[o];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in t)&&(!i.type||l.validEnd)&&(r.push({match:a.contentMatch,type:a,via:i}),t[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function t(r){e.push(r);for(let i=0;i<r.next.length;i++)e.indexOf(r.next[i].next)==-1&&t(r.next[i].next)}return t(this),e.map((r,i)=>{let s=i+(r.validEnd?"*":" ")+" ";for(let o=0;o<r.next.length;o++)s+=(o?", ":"")+r.next[o].type.name+"->"+e.indexOf(r.next[o].next);return s}).join(`
`)}}Zt.empty=new Zt(!0);class fd{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function Bl(n){let e=[];do e.push(hd(n));while(n.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function hd(n){let e=[];do e.push(pd(n));while(n.next&&n.next!=")"&&n.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function pd(n){let e=yd(n);for(;;)if(n.eat("+"))e={type:"plus",expr:e};else if(n.eat("*"))e={type:"star",expr:e};else if(n.eat("?"))e={type:"opt",expr:e};else if(n.eat("{"))e=md(n,e);else break;return e}function $o(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let e=Number(n.next);return n.pos++,e}function md(n,e){let t=$o(n),r=t;return n.eat(",")&&(n.next!="}"?r=$o(n):r=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:t,max:r,expr:e}}function gd(n,e){let t=n.nodeTypes,r=t[e];if(r)return[r];let i=[];for(let s in t){let o=t[s];o.groups.indexOf(e)>-1&&i.push(o)}return i.length==0&&n.err("No node type or group '"+e+"' found"),i}function yd(n){if(n.eat("(")){let e=Bl(n);return n.eat(")")||n.err("Missing closing paren"),e}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let e=gd(n,n.next).map(t=>(n.inline==null?n.inline=t.isInline:n.inline!=t.isInline&&n.err("Mixing inline and block content"),{type:"name",value:t}));return n.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function vd(n){let e=[[]];return i(s(n,0),t()),e;function t(){return e.push([])-1}function r(o,a,l){let c={term:l,to:a};return e[o].push(c),c}function i(o,a){o.forEach(l=>l.to=a)}function s(o,a){if(o.type=="choice")return o.exprs.reduce((l,c)=>l.concat(s(c,a)),[]);if(o.type=="seq")for(let l=0;;l++){let c=s(o.exprs[l],a);if(l==o.exprs.length-1)return c;i(c,a=t())}else if(o.type=="star"){let l=t();return r(a,l),i(s(o.expr,l),l),[r(l)]}else if(o.type=="plus"){let l=t();return i(s(o.expr,a),l),i(s(o.expr,l),l),[r(l)]}else{if(o.type=="opt")return[r(a)].concat(s(o.expr,a));if(o.type=="range"){let l=a;for(let c=0;c<o.min;c++){let u=t();i(s(o.expr,l),u),l=u}if(o.max==-1)i(s(o.expr,l),l);else for(let c=o.min;c<o.max;c++){let u=t();r(l,u),i(s(o.expr,l),u),l=u}return[r(l)]}else{if(o.type=="name")return[r(a,void 0,o.value)];throw new Error("Unknown expr type")}}}}function Rl(n,e){return e-n}function jo(n,e){let t=[];return r(e),t.sort(Rl);function r(i){let s=n[i];if(s.length==1&&!s[0].term)return r(s[0].to);t.push(i);for(let o=0;o<s.length;o++){let{term:a,to:l}=s[o];!a&&t.indexOf(l)==-1&&r(l)}}}function bd(n){let e=Object.create(null);return t(jo(n,0));function t(r){let i=[];r.forEach(o=>{n[o].forEach(({term:a,to:l})=>{if(!a)return;let c;for(let u=0;u<i.length;u++)i[u][0]==a&&(c=i[u][1]);jo(n,l).forEach(u=>{c||i.push([a,c=[]]),c.indexOf(u)==-1&&c.push(u)})})});let s=e[r.join(",")]=new Zt(r.indexOf(n.length-1)>-1);for(let o=0;o<i.length;o++){let a=i[o][1].sort(Rl);s.next.push({type:i[o][0],next:e[a.join(",")]||t(a)})}return s}}function Dd(n,e){for(let t=0,r=[n];t<r.length;t++){let i=r[t],s=!i.validEnd,o=[];for(let a=0;a<i.next.length;a++){let{type:l,next:c}=i.next[a];o.push(l.name),s&&!(l.isText||l.hasRequiredAttrs())&&(s=!1),r.indexOf(c)==-1&&r.push(c)}s&&e.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function Il(n){let e=Object.create(null);for(let t in n){let r=n[t];if(!r.hasDefault)return null;e[t]=r.default}return e}function Pl(n,e){let t=Object.create(null);for(let r in n){let i=e&&e[r];if(i===void 0){let s=n[r];if(s.hasDefault)i=s.default;else throw new RangeError("No value supplied for attribute "+r)}t[r]=i}return t}function Ll(n){let e=Object.create(null);if(n)for(let t in n)e[t]=new Cd(n[t]);return e}let Ts=class{constructor(e,t,r){this.name=e,this.schema=t,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=Ll(r.attrs),this.defaultAttrs=Il(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Zt.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:Pl(this.attrs,e)}create(e=null,t,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new ht(this,this.computeAttrs(e),k.from(t),W.setFrom(r))}createChecked(e=null,t,r){return t=k.from(t),this.checkContent(t),new ht(this,this.computeAttrs(e),t,W.setFrom(r))}createAndFill(e=null,t,r){if(e=this.computeAttrs(e),t=k.from(t),t.size){let o=this.contentMatch.fillBefore(t);if(!o)return null;t=o.append(t)}let i=this.contentMatch.matchFragment(t),s=i&&i.fillBefore(k.empty,!0);return s?new ht(this,e,t.append(s),W.setFrom(r)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let t;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?t&&t.push(e[r]):t||(t=e.slice(0,r));return t?t.length?t:W.none:e}static compile(e,t){let r=Object.create(null);e.forEach((s,o)=>r[s]=new Ts(s,t,o));let i=t.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let s in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};class Cd{constructor(e){this.hasDefault=Object.prototype.hasOwnProperty.call(e,"default"),this.default=e.default}get isRequired(){return!this.hasDefault}}class Ri{constructor(e,t,r,i){this.name=e,this.rank=t,this.schema=r,this.spec=i,this.attrs=Ll(i.attrs),this.excluded=null;let s=Il(this.attrs);this.instance=s?new W(this,s):null}create(e=null){return!e&&this.instance?this.instance:new W(this,Pl(this.attrs,e))}static compile(e,t){let r=Object.create(null),i=0;return e.forEach((s,o)=>r[s]=new Ri(s,i++,t,o)),r}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}excludes(e){return this.excluded.indexOf(e)>-1}}class kd{constructor(e){this.cached=Object.create(null);let t=this.spec={};for(let i in e)t[i]=e[i];t.nodes=ce.from(e.nodes),t.marks=ce.from(e.marks||{}),this.nodes=Ts.compile(this.spec.nodes,this),this.marks=Ri.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let s=this.nodes[i],o=s.spec.content||"",a=s.spec.marks;s.contentMatch=r[o]||(r[o]=Zt.parse(o,this.nodes)),s.inlineContent=s.contentMatch.inlineContent,s.markSet=a=="_"?null:a?_o(this,a.split(" ")):a==""||!s.inlineContent?[]:null}for(let i in this.marks){let s=this.marks[i],o=s.spec.excludes;s.excluded=o==null?[s]:o==""?[]:_o(this,o.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,r,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof Ts){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(t,r,i)}text(e,t){let r=this.nodes.text;return new ni(r,r.defaultAttrs,e,W.setFrom(t))}mark(e,t){return typeof e=="string"&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return ht.fromJSON(this,e)}markFromJSON(e){return W.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function _o(n,e){let t=[];for(let r=0;r<e.length;r++){let i=e[r],s=n.marks[i],o=s;if(s)t.push(s);else for(let a in n.marks){let l=n.marks[a];(i=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(i)>-1)&&t.push(o=l)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return t}class Tn{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[],t.forEach(r=>{r.tag?this.tags.push(r):r.style&&this.styles.push(r)}),this.normalizeLists=!this.tags.some(r=>{if(!/^(ul|ol)\b/.test(r.tag)||!r.node)return!1;let i=e.nodes[r.node];return i.contentMatch.matchType(i)})}parse(e,t={}){let r=new Ko(this,t,!1);return r.addAll(e,t.from,t.to),r.finish()}parseSlice(e,t={}){let r=new Ko(this,t,!0);return r.addAll(e,t.from,t.to),w.maxOpen(r.finish())}matchTag(e,t,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let s=this.tags[i];if(Sd(e,s.tag)&&(s.namespace===void 0||e.namespaceURI==s.namespace)&&(!s.context||t.matchesContext(s.context))){if(s.getAttrs){let o=s.getAttrs(e);if(o===!1)continue;s.attrs=o||void 0}return s}}}matchStyle(e,t,r,i){for(let s=i?this.styles.indexOf(i)+1:0;s<this.styles.length;s++){let o=this.styles[s],a=o.style;if(!(a.indexOf(e)!=0||o.context&&!r.matchesContext(o.context)||a.length>e.length&&(a.charCodeAt(e.length)!=61||a.slice(e.length+1)!=t))){if(o.getAttrs){let l=o.getAttrs(t);if(l===!1)continue;o.attrs=l||void 0}return o}}}static schemaRules(e){let t=[];function r(i){let s=i.priority==null?50:i.priority,o=0;for(;o<t.length;o++){let a=t[o];if((a.priority==null?50:a.priority)<s)break}t.splice(o,0,i)}for(let i in e.marks){let s=e.marks[i].spec.parseDOM;s&&s.forEach(o=>{r(o=Uo(o)),o.mark=i})}for(let i in e.nodes){let s=e.nodes[i].spec.parseDOM;s&&s.forEach(o=>{r(o=Uo(o)),o.node=i})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new Tn(e,Tn.schemaRules(e)))}}const zl={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Ed={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Vl={ol:!0,ul:!0},ri=1,ii=2,lr=4;function Wo(n,e,t){return e!=null?(e?ri:0)|(e==="full"?ii:0):n&&n.whitespace=="pre"?ri|ii:t&~lr}class Hr{constructor(e,t,r,i,s,o,a){this.type=e,this.attrs=t,this.marks=r,this.pendingMarks=i,this.solid=s,this.options=a,this.content=[],this.activeMarks=W.none,this.stashMarks=[],this.match=o||(a&lr?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(k.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(e.type))?(this.match=r,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&ri)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let s=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=s.withText(s.text.slice(0,s.text.length-i[0].length))}}let t=k.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(k.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}popFromStashMark(e){for(let t=this.stashMarks.length-1;t>=0;t--)if(e.eq(this.stashMarks[t]))return this.stashMarks.splice(t,1)[0]}applyPending(e){for(let t=0,r=this.pendingMarks;t<r.length;t++){let i=r[t];(this.type?this.type.allowsMarkType(i.type):wd(i.type,e))&&!i.isInSet(this.activeMarks)&&(this.activeMarks=i.addToSet(this.activeMarks),this.pendingMarks=i.removeFromSet(this.pendingMarks))}}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!zl.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class Ko{constructor(e,t,r){this.parser=e,this.options=t,this.isOpen=r,this.open=0;let i=t.topNode,s,o=Wo(null,t.preserveWhitespace,0)|(r?lr:0);i?s=new Hr(i.type,i.attrs,W.none,W.none,!0,t.topMatch||i.type.contentMatch,o):r?s=new Hr(null,null,W.none,W.none,!0,null,o):s=new Hr(e.schema.topNodeType,null,W.none,W.none,!0,null,o),this.nodes=[s],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e){if(e.nodeType==3)this.addTextNode(e);else if(e.nodeType==1){let t=e.getAttribute("style"),r=t?this.readStyles(Ad(t)):null,i=this.top;if(r!=null)for(let s=0;s<r.length;s++)this.addPendingMark(r[s]);if(this.addElement(e),r!=null)for(let s=0;s<r.length;s++)this.removePendingMark(r[s],i)}}addTextNode(e){let t=e.nodeValue,r=this.top;if(r.options&ii||r.inlineContext(e)||/[^ \t\r\n\u000c]/.test(t)){if(r.options&ri)r.options&ii?t=t.replace(/\r\n?/g,`
`):t=t.replace(/\r?\n|\r/g," ");else if(t=t.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(t)&&this.open==this.nodes.length-1){let i=r.content[r.content.length-1],s=e.previousSibling;(!i||s&&s.nodeName=="BR"||i.isText&&/[ \t\r\n\u000c]$/.test(i.text))&&(t=t.slice(1))}t&&this.insertNode(this.parser.schema.text(t)),this.findInText(e)}else this.findInside(e)}addElement(e,t){let r=e.nodeName.toLowerCase(),i;Vl.hasOwnProperty(r)&&this.parser.normalizeLists&&xd(e);let s=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(i=this.parser.matchTag(e,this,t));if(s?s.ignore:Ed.hasOwnProperty(r))this.findInside(e),this.ignoreFallback(e);else if(!s||s.skip||s.closeParent){s&&s.closeParent?this.open=Math.max(0,this.open-1):s&&s.skip.nodeType&&(e=s.skip);let o,a=this.top,l=this.needsBlock;if(zl.hasOwnProperty(r))a.content.length&&a.content[0].isInline&&this.open&&(this.open--,a=this.top),o=!0,a.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e);return}this.addAll(e),o&&this.sync(a),this.needsBlock=l}else this.addElementByRule(e,s,s.consuming===!1?i:void 0)}leafFallback(e){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`))}ignoreFallback(e){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))}readStyles(e){let t=W.none;e:for(let r=0;r<e.length;r+=2)for(let i=void 0;;){let s=this.parser.matchStyle(e[r],e[r+1],this,i);if(!s)continue e;if(s.ignore)return null;if(t=this.parser.schema.marks[s.mark].create(s.attrs).addToSet(t),s.consuming===!1)i=s;else break}return t}addElementByRule(e,t,r){let i,s,o;t.node?(s=this.parser.schema.nodes[t.node],s.isLeaf?this.insertNode(s.create(t.attrs))||this.leafFallback(e):i=this.enter(s,t.attrs||null,t.preserveWhitespace)):(o=this.parser.schema.marks[t.mark].create(t.attrs),this.addPendingMark(o));let a=this.top;if(s&&s.isLeaf)this.findInside(e);else if(r)this.addElement(e,r);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l));else{let l=e;typeof t.contentElement=="string"?l=e.querySelector(t.contentElement):typeof t.contentElement=="function"?l=t.contentElement(e):t.contentElement&&(l=t.contentElement),this.findAround(e,l,!0),this.addAll(l)}i&&this.sync(a)&&this.open--,o&&this.removePendingMark(o,a)}addAll(e,t,r){let i=t||0;for(let s=t?e.childNodes[t]:e.firstChild,o=r==null?null:e.childNodes[r];s!=o;s=s.nextSibling,++i)this.findAtPoint(e,i),this.addDOM(s);this.findAtPoint(e,i)}findPlace(e){let t,r;for(let i=this.open;i>=0;i--){let s=this.nodes[i],o=s.findWrapping(e);if(o&&(!t||t.length>o.length)&&(t=o,r=s,!o.length)||s.solid)break}if(!t)return!1;this.sync(r);for(let i=0;i<t.length;i++)this.enterInner(t[i],null,!1);return!0}insertNode(e){if(e.isInline&&this.needsBlock&&!this.top.type){let t=this.textblockFromContext();t&&this.enterInner(t)}if(this.findPlace(e)){this.closeExtra();let t=this.top;t.applyPending(e.type),t.match&&(t.match=t.match.matchType(e.type));let r=t.activeMarks;for(let i=0;i<e.marks.length;i++)(!t.type||t.type.allowsMarkType(e.marks[i].type))&&(r=e.marks[i].addToSet(r));return t.content.push(e.mark(r)),!0}return!1}enter(e,t,r){let i=this.findPlace(e.create(t));return i&&this.enterInner(e,t,!0,r),i}enterInner(e,t=null,r=!1,i){this.closeExtra();let s=this.top;s.applyPending(e),s.match=s.match&&s.match.matchType(e);let o=Wo(e,i,s.options);s.options&lr&&s.content.length==0&&(o|=lr),this.nodes.push(new Hr(e,t,s.activeMarks,s.pendingMarks,r,null,o)),this.open++}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(e){for(let t=this.open;t>=0;t--)if(this.nodes[t]==e)return this.open=t,!0;return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let r=this.nodes[t].content;for(let i=r.length-1;i>=0;i--)e+=r[i].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==t&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,r){if(e!=t&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&t.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),s=-(r?r.depth+1:0)+(i?0:1),o=(a,l)=>{for(;a>=0;a--){let c=t[a];if(c==""){if(a==t.length-1||a==0)continue;for(;l>=s;l--)if(o(a-1,l))return!0;return!1}else{let u=l>0||l==0&&i?this.nodes[l].type:r&&l>=s?r.node(l-s).type:null;if(!u||u.name!=c&&u.groups.indexOf(c)==-1)return!1;l--}}return!0};return o(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let r=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let t in this.parser.schema.nodes){let r=this.parser.schema.nodes[t];if(r.isTextblock&&r.defaultAttrs)return r}}addPendingMark(e){let t=Od(e,this.top.pendingMarks);t&&this.top.stashMarks.push(t),this.top.pendingMarks=e.addToSet(this.top.pendingMarks)}removePendingMark(e,t){for(let r=this.open;r>=0;r--){let i=this.nodes[r];if(i.pendingMarks.lastIndexOf(e)>-1)i.pendingMarks=e.removeFromSet(i.pendingMarks);else{i.activeMarks=e.removeFromSet(i.activeMarks);let o=i.popFromStashMark(e);o&&i.type&&i.type.allowsMarkType(o.type)&&(i.activeMarks=o.addToSet(i.activeMarks))}if(i==t)break}}}function xd(n){for(let e=n.firstChild,t=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&Vl.hasOwnProperty(r)&&t?(t.appendChild(e),e=t):r=="li"?t=e:r&&(t=null)}}function Sd(n,e){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,e)}function Ad(n){let e=/\s*([\w-]+)\s*:\s*([^;]+)/g,t,r=[];for(;t=e.exec(n);)r.push(t[1],t[2].trim());return r}function Uo(n){let e={};for(let t in n)e[t]=n[t];return e}function wd(n,e){let t=e.schema.nodes;for(let r in t){let i=t[r];if(!i.allowsMarkType(n))continue;let s=[],o=a=>{s.push(a);for(let l=0;l<a.edgeCount;l++){let{type:c,next:u}=a.edge(l);if(c==e||s.indexOf(u)<0&&o(u))return!0}};if(o(i.contentMatch))return!0}}function Od(n,e){for(let t=0;t<e.length;t++)if(n.eq(e[t]))return e[t]}class Ze{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},r){r||(r=es(t).createDocumentFragment());let i=r,s=[];return e.forEach(o=>{if(s.length||o.marks.length){let a=0,l=0;for(;a<s.length&&l<o.marks.length;){let c=o.marks[l];if(!this.marks[c.type.name]){l++;continue}if(!c.eq(s[a][0])||c.type.spec.spanning===!1)break;a++,l++}for(;a<s.length;)i=s.pop()[1];for(;l<o.marks.length;){let c=o.marks[l++],u=this.serializeMark(c,o.isInline,t);u&&(s.push([c,i]),i.appendChild(u.dom),i=u.contentDOM||u.dom)}}i.appendChild(this.serializeNodeInner(o,t))}),r}serializeNodeInner(e,t){let{dom:r,contentDOM:i}=Ze.renderSpec(es(t),this.nodes[e.type.name](e));if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,i)}return r}serializeNode(e,t={}){let r=this.serializeNodeInner(e,t);for(let i=e.marks.length-1;i>=0;i--){let s=this.serializeMark(e.marks[i],e.isInline,t);s&&((s.contentDOM||s.dom).appendChild(r),r=s.dom)}return r}serializeMark(e,t,r={}){let i=this.marks[e.type.name];return i&&Ze.renderSpec(es(r),i(e,t))}static renderSpec(e,t,r=null){if(typeof t=="string")return{dom:e.createTextNode(t)};if(t.nodeType!=null)return{dom:t};if(t.dom&&t.dom.nodeType!=null)return t;let i=t[0],s=i.indexOf(" ");s>0&&(r=i.slice(0,s),i=i.slice(s+1));let o,a=r?e.createElementNS(r,i):e.createElement(i),l=t[1],c=1;if(l&&typeof l=="object"&&l.nodeType==null&&!Array.isArray(l)){c=2;for(let u in l)if(l[u]!=null){let d=u.indexOf(" ");d>0?a.setAttributeNS(u.slice(0,d),u.slice(d+1),l[u]):a.setAttribute(u,l[u])}}for(let u=c;u<t.length;u++){let d=t[u];if(d===0){if(u<t.length-1||u>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:a,contentDOM:a}}else{let{dom:f,contentDOM:h}=Ze.renderSpec(e,d,r);if(a.appendChild(f),h){if(o)throw new RangeError("Multiple content holes");o=h}}}return{dom:a,contentDOM:o}}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Ze(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=qo(e.nodes);return t.text||(t.text=r=>r.text),t}static marksFromSchema(e){return qo(e.marks)}}function qo(n){let e={};for(let t in n){let r=n[t].spec.toDOM;r&&(e[t]=r)}return e}function es(n){return n.document||window.document}const Hl=65535,$l=Math.pow(2,16);function Md(n,e){return n+e*$l}function Jo(n){return n&Hl}function Td(n){return(n-(n&Hl))/$l}const jl=1,_l=2,qr=4,Wl=8;class Fs{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&Wl)>0}get deletedBefore(){return(this.delInfo&(jl|qr))>0}get deletedAfter(){return(this.delInfo&(_l|qr))>0}get deletedAcross(){return(this.delInfo&qr)>0}}class Ie{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&Ie.empty)return Ie.empty}recover(e){let t=0,r=Jo(e);if(!this.inverted)for(let i=0;i<r;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+t+Td(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let i=0,s=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?i:0);if(l>e)break;let c=this.ranges[a+s],u=this.ranges[a+o],d=l+c;if(e<=d){let f=c?e==l?-1:e==d?1:t:t,h=l+i+(f<0?0:u);if(r)return h;let p=e==(t<0?l:d)?null:Md(a/3,e-l),m=e==l?_l:e==d?jl:qr;return(t<0?e!=l:e!=d)&&(m|=Wl),new Fs(h,m,p)}i+=u-c}return r?e+i:new Fs(e+i,0,null)}touches(e,t){let r=0,i=Jo(t),s=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let c=this.ranges[a+s],u=l+c;if(e<=u&&a==i*3)return!0;r+=this.ranges[a+o]-c}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,s=0;i<this.ranges.length;i+=3){let o=this.ranges[i],a=o-(this.inverted?s:0),l=o+(this.inverted?0:s),c=this.ranges[i+t],u=this.ranges[i+r];e(a,a+c,l,l+u),s+=u-c}}invert(){return new Ie(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Ie.empty:new Ie(e<0?[0,-e,0]:[0,0,e])}}Ie.empty=new Ie([]);class An{constructor(e=[],t,r=0,i=e.length){this.maps=e,this.mirror=t,this.from=r,this.to=i}slice(e=0,t=this.maps.length){return new An(this.maps,this.mirror,e,t)}copy(){return new An(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(e,t){this.to=this.maps.push(e),t!=null&&this.setMirror(this.maps.length-1,t)}appendMapping(e){for(let t=0,r=this.maps.length;t<e.maps.length;t++){let i=e.getMirror(t);this.appendMap(e.maps[t],i!=null&&i<t?r+i:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,r=this.maps.length+e.maps.length;t>=0;t--){let i=e.getMirror(t);this.appendMap(e.maps[t].invert(),i!=null&&i>t?r-i-1:void 0)}}invert(){let e=new An;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let r=this.from;r<this.to;r++)e=this.maps[r].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,r){let i=0;for(let s=this.from;s<this.to;s++){let o=this.maps[s],a=o.mapResult(e,t);if(a.recover!=null){let l=this.getMirror(s);if(l!=null&&l>s&&l<this.to){s=l,e=this.maps[l].recover(a.recover);continue}}i|=a.delInfo,e=a.pos}return r?e:new Fs(e,i,null)}}const ts=Object.create(null);class we{getMap(){return Ie.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=ts[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in ts)throw new RangeError("Duplicate use of step JSON ID "+e);return ts[e]=t,t.prototype.jsonID=e,t}}class ie{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new ie(e,null)}static fail(e){return new ie(null,e)}static fromReplace(e,t,r,i){try{return ie.ok(e.replace(t,r,i))}catch(s){if(s instanceof Zr)return ie.fail(s.message);throw s}}}function to(n,e,t){let r=[];for(let i=0;i<n.childCount;i++){let s=n.child(i);s.content.size&&(s=s.copy(to(s.content,e,s))),s.isInline&&(s=e(s,t,i)),r.push(s)}return k.fromArray(r)}class St extends we{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),s=new w(to(t.content,(o,a)=>!o.isAtom||!a.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),i),t.openStart,t.openEnd);return ie.fromReplace(e,this.from,this.to,s)}invert(){return new et(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new St(t.pos,r.pos,this.mark)}merge(e){return e instanceof St&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new St(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new St(t.from,t.to,e.markFromJSON(t.mark))}}we.jsonID("addMark",St);class et extends we{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new w(to(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return ie.fromReplace(e,this.from,this.to,r)}invert(){return new St(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new et(t.pos,r.pos,this.mark)}merge(e){return e instanceof et&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new et(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new et(t.from,t.to,e.markFromJSON(t.mark))}}we.jsonID("removeMark",et);class At extends we{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return ie.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return ie.fromReplace(e,this.pos,this.pos+1,new w(k.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(r))return new At(this.pos,t.marks[i]);return new At(this.pos,this.mark)}}return new Fn(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new At(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new At(t.pos,e.markFromJSON(t.mark))}}we.jsonID("addNodeMark",At);class Fn extends we{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return ie.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return ie.fromReplace(e,this.pos,this.pos+1,new w(k.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new At(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Fn(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Fn(t.pos,e.markFromJSON(t.mark))}}we.jsonID("removeNodeMark",Fn);class me extends we{constructor(e,t,r,i=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=i}apply(e){return this.structure&&Ns(e,this.from,this.to)?ie.fail("Structure replace would overwrite content"):ie.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Ie([this.from,this.to-this.from,this.slice.size])}invert(e){return new me(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new me(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof me)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?w.empty:new w(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new me(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?w.empty:new w(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new me(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new me(t.from,t.to,w.fromJSON(e,t.slice),!!t.structure)}}we.jsonID("replace",me);class ae extends we{constructor(e,t,r,i,s,o,a=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=i,this.slice=s,this.insert=o,this.structure=a}apply(e){if(this.structure&&(Ns(e,this.from,this.gapFrom)||Ns(e,this.gapTo,this.to)))return ie.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return ie.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?ie.fromReplace(e,this.from,this.to,r):ie.fail("Content does not fit in gap")}getMap(){return new Ie([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new ae(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=e.map(this.gapFrom,-1),s=e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||i<t.pos||s>r.pos?null:new ae(t.pos,r.pos,i,s,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new ae(t.from,t.to,t.gapFrom,t.gapTo,w.fromJSON(e,t.slice),t.insert,!!t.structure)}}we.jsonID("replaceAround",ae);function Ns(n,e,t){let r=n.resolve(e),i=t-e,s=r.depth;for(;i>0&&s>0&&r.indexAfter(s)==r.node(s).childCount;)s--,i--;if(i>0){let o=r.node(s).maybeChild(r.indexAfter(s));for(;i>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,i--}}return!1}function Fd(n,e,t,r){let i=[],s=[],o,a;n.doc.nodesBetween(e,t,(l,c,u)=>{if(!l.isInline)return;let d=l.marks;if(!r.isInSet(d)&&u.type.allowsMarkType(r.type)){let f=Math.max(c,e),h=Math.min(c+l.nodeSize,t),p=r.addToSet(d);for(let m=0;m<d.length;m++)d[m].isInSet(p)||(o&&o.to==f&&o.mark.eq(d[m])?o.to=h:i.push(o=new et(f,h,d[m])));a&&a.to==f?a.to=h:s.push(a=new St(f,h,r))}}),i.forEach(l=>n.step(l)),s.forEach(l=>n.step(l))}function Nd(n,e,t,r){let i=[],s=0;n.doc.nodesBetween(e,t,(o,a)=>{if(!o.isInline)return;s++;let l=null;if(r instanceof Ri){let c=o.marks,u;for(;u=r.isInSet(c);)(l||(l=[])).push(u),c=u.removeFromSet(c)}else r?r.isInSet(o.marks)&&(l=[r]):l=o.marks;if(l&&l.length){let c=Math.min(a+o.nodeSize,t);for(let u=0;u<l.length;u++){let d=l[u],f;for(let h=0;h<i.length;h++){let p=i[h];p.step==s-1&&d.eq(i[h].style)&&(f=p)}f?(f.to=c,f.step=s):i.push({style:d,from:Math.max(a,e),to:c,step:s})}}}),i.forEach(o=>n.step(new et(o.from,o.to,o.style)))}function Bd(n,e,t,r=t.contentMatch){let i=n.doc.nodeAt(e),s=[],o=e+1;for(let a=0;a<i.childCount;a++){let l=i.child(a),c=o+l.nodeSize,u=r.matchType(l.type);if(!u)s.push(new me(o,c,w.empty));else{r=u;for(let d=0;d<l.marks.length;d++)t.allowsMarkType(l.marks[d].type)||n.step(new et(o,c,l.marks[d]))}o=c}if(!r.validEnd){let a=r.fillBefore(k.empty,!0);n.replace(o,o,new w(a,0,0))}for(let a=s.length-1;a>=0;a--)n.step(s[a])}function Rd(n,e,t){return(e==0||n.canReplace(e,n.childCount))&&(t==n.childCount||n.canReplace(0,t))}function jn(n){let t=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let r=n.depth;;--r){let i=n.$from.node(r),s=n.$from.index(r),o=n.$to.indexAfter(r);if(r<n.depth&&i.canReplace(s,o,t))return r;if(r==0||i.type.spec.isolating||!Rd(i,s,o))break}return null}function Id(n,e,t){let{$from:r,$to:i,depth:s}=e,o=r.before(s+1),a=i.after(s+1),l=o,c=a,u=k.empty,d=0;for(let p=s,m=!1;p>t;p--)m||r.index(p)>0?(m=!0,u=k.from(r.node(p).copy(u)),d++):l--;let f=k.empty,h=0;for(let p=s,m=!1;p>t;p--)m||i.after(p+1)<i.end(p)?(m=!0,f=k.from(i.node(p).copy(f)),h++):c++;n.step(new ae(l,c,o,a,new w(u.append(f),d,h),u.size-d,!0))}function no(n,e,t=null,r=n){let i=Pd(n,e),s=i&&Ld(r,e);return s?i.map(Go).concat({type:e,attrs:t}).concat(s.map(Go)):null}function Go(n){return{type:n,attrs:null}}function Pd(n,e){let{parent:t,startIndex:r,endIndex:i}=n,s=t.contentMatchAt(r).findWrapping(e);if(!s)return null;let o=s.length?s[0]:e;return t.canReplaceWith(r,i,o)?s:null}function Ld(n,e){let{parent:t,startIndex:r,endIndex:i}=n,s=t.child(r),o=e.contentMatch.findWrapping(s.type);if(!o)return null;let l=(o.length?o[o.length-1]:e).contentMatch;for(let c=r;l&&c<i;c++)l=l.matchType(t.child(c).type);return!l||!l.validEnd?null:o}function zd(n,e,t){let r=k.empty;for(let o=t.length-1;o>=0;o--){if(r.size){let a=t[o].type.contentMatch.matchFragment(r);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=k.from(t[o].type.create(t[o].attrs,r))}let i=e.start,s=e.end;n.step(new ae(i,s,i,s,new w(r,0,0),t.length,!0))}function Vd(n,e,t,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let s=n.steps.length;n.doc.nodesBetween(e,t,(o,a)=>{if(o.isTextblock&&!o.hasMarkup(r,i)&&Hd(n.doc,n.mapping.slice(s).map(a),r)){n.clearIncompatible(n.mapping.slice(s).map(a,1),r);let l=n.mapping.slice(s),c=l.map(a,1),u=l.map(a+o.nodeSize,1);return n.step(new ae(c,u,c+1,u-1,new w(k.from(r.create(i,null,o.marks)),0,0),1,!0)),!1}})}function Hd(n,e,t){let r=n.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,t)}function $d(n,e,t,r,i){let s=n.doc.nodeAt(e);if(!s)throw new RangeError("No node at given position");t||(t=s.type);let o=t.create(r,null,i||s.marks);if(s.isLeaf)return n.replaceWith(e,e+s.nodeSize,o);if(!t.validContent(s.content))throw new RangeError("Invalid content for node type "+t.name);n.step(new ae(e,e+s.nodeSize,e+1,e+s.nodeSize-1,new w(k.from(o),0,0),1,!0))}function wn(n,e,t=1,r){let i=n.resolve(e),s=i.depth-t,o=r&&r[r.length-1]||i.parent;if(s<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!o.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let c=i.depth-1,u=t-2;c>s;c--,u--){let d=i.node(c),f=i.index(c);if(d.type.spec.isolating)return!1;let h=d.content.cutByIndex(f,d.childCount),p=r&&r[u]||d;if(p!=d&&(h=h.replaceChild(0,p.type.create(p.attrs))),!d.canReplace(f+1,d.childCount)||!p.type.validContent(h))return!1}let a=i.indexAfter(s),l=r&&r[0];return i.node(s).canReplaceWith(a,a,l?l.type:i.node(s+1).type)}function jd(n,e,t=1,r){let i=n.doc.resolve(e),s=k.empty,o=k.empty;for(let a=i.depth,l=i.depth-t,c=t-1;a>l;a--,c--){s=k.from(i.node(a).copy(s));let u=r&&r[c];o=k.from(u?u.type.create(u.attrs,o):i.node(a).copy(o))}n.step(new me(e,e,new w(s.append(o),t,t),!0))}function Bt(n,e){let t=n.resolve(e),r=t.index();return Kl(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(r,r+1)}function Kl(n,e){return!!(n&&e&&!n.isLeaf&&n.canAppend(e))}function Ul(n,e,t=-1){let r=n.resolve(e);for(let i=r.depth;;i--){let s,o,a=r.index(i);if(i==r.depth?(s=r.nodeBefore,o=r.nodeAfter):t>0?(s=r.node(i+1),a++,o=r.node(i).maybeChild(a)):(s=r.node(i).maybeChild(a-1),o=r.node(i+1)),s&&!s.isTextblock&&Kl(s,o)&&r.node(i).canReplace(a,a+1))return e;if(i==0)break;e=t<0?r.before(i):r.after(i)}}function _d(n,e,t){let r=new me(e-t,e+t,w.empty,!0);n.step(r)}function Wd(n,e,t){let r=n.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),t))return e;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let s=r.index(i);if(r.node(i).canReplaceWith(s,s,t))return r.before(i+1);if(s>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let s=r.indexAfter(i);if(r.node(i).canReplaceWith(s,s,t))return r.after(i+1);if(s<r.node(i).childCount)return null}return null}function ql(n,e,t){let r=n.resolve(e);if(!t.content.size)return e;let i=t.content;for(let s=0;s<t.openStart;s++)i=i.firstChild.content;for(let s=1;s<=(t.openStart==0&&t.size?2:1);s++)for(let o=r.depth;o>=0;o--){let a=o==r.depth?0:r.pos<=(r.start(o+1)+r.end(o+1))/2?-1:1,l=r.index(o)+(a>0?1:0),c=r.node(o),u=!1;if(s==1)u=c.canReplace(l,l,i);else{let d=c.contentMatchAt(l).findWrapping(i.firstChild.type);u=d&&c.canReplaceWith(l,l,d[0])}if(u)return a==0?r.pos:a<0?r.before(o+1):r.after(o+1)}return null}function ro(n,e,t=e,r=w.empty){if(e==t&&!r.size)return null;let i=n.resolve(e),s=n.resolve(t);return Jl(i,s,r)?new me(e,t,r):new Kd(i,s,r).fit()}function Jl(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}class Kd{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=k.empty;for(let i=0;i<=e.depth;i++){let s=e.node(i);this.frontier.push({type:s.type,match:s.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=k.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let s=this.placed,o=r.depth,a=i.depth;for(;o&&a&&s.childCount==1;)s=s.firstChild.content,o--,a--;let l=new w(s,o,a);return e>-1?new ae(r.pos,e,this.$to.pos,this.$to.end(),l,t):l.size||r.pos!=this.$to.pos?new me(r.pos,i.pos,l):null}findFittable(){for(let e=1;e<=2;e++)for(let t=this.unplaced.openStart;t>=0;t--){let r,i=null;t?(i=ns(this.unplaced.content,t-1).firstChild,r=i.content):r=this.unplaced.content;let s=r.firstChild;for(let o=this.depth;o>=0;o--){let{type:a,match:l}=this.frontier[o],c,u=null;if(e==1&&(s?l.matchType(s.type)||(u=l.fillBefore(k.from(s),!1)):i&&a.compatibleContent(i.type)))return{sliceDepth:t,frontierDepth:o,parent:i,inject:u};if(e==2&&s&&(c=l.findWrapping(s.type)))return{sliceDepth:t,frontierDepth:o,parent:i,wrap:c};if(i&&l.matchType(i.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=ns(e,t);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new w(e,t+1,Math.max(r,i.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=ns(e,t);if(i.childCount<=1&&t>0){let s=e.size-t<=t+i.size;this.unplaced=new w(ir(e,t-1,1),t-1,s?t-1:r)}else this.unplaced=new w(ir(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:i,wrap:s}){for(;this.depth>t;)this.closeFrontierNode();if(s)for(let m=0;m<s.length;m++)this.openFrontierNode(s[m]);let o=this.unplaced,a=r?r.content:o.content,l=o.openStart-e,c=0,u=[],{match:d,type:f}=this.frontier[t];if(i){for(let m=0;m<i.childCount;m++)u.push(i.child(m));d=d.matchFragment(i)}let h=a.size+e-(o.content.size-o.openEnd);for(;c<a.childCount;){let m=a.child(c),y=d.matchType(m.type);if(!y)break;c++,(c>1||l==0||m.content.size)&&(d=y,u.push(Gl(m.mark(f.allowedMarks(m.marks)),c==1?l:0,c==a.childCount?h:-1)))}let p=c==a.childCount;p||(h=-1),this.placed=sr(this.placed,t,k.from(u)),this.frontier[t].match=d,p&&h<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,y=a;m<h;m++){let v=y.lastChild;this.frontier.push({type:v.type,match:v.contentMatchAt(v.childCount)}),y=v.content}this.unplaced=p?e==0?w.empty:new w(ir(o.content,e-1,1),e-1,h<0?o.openEnd:e-1):new w(ir(o.content,e,c),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!rs(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:i}=this.frontier[t],s=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),o=rs(e,t,i,r,s);if(!!o){for(let a=t-1;a>=0;a--){let{match:l,type:c}=this.frontier[a],u=rs(e,a,c,l,!0);if(!u||u.childCount)continue e}return{depth:t,fit:o,move:s?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=sr(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let i=e.node(r),s=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,s)}return e}openFrontierNode(e,t=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=sr(this.placed,this.depth,k.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(k.empty,!0);t.childCount&&(this.placed=sr(this.placed,this.frontier.length,t))}}function ir(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(ir(n.firstChild.content,e-1,t)))}function sr(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(sr(n.lastChild.content,e-1,t)))}function ns(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function Gl(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,Gl(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(k.empty,!0)))),n.copy(r)}function rs(n,e,t,r,i){let s=n.node(e),o=i?n.indexAfter(e):n.index(e);if(o==s.childCount&&!t.compatibleContent(s.type))return null;let a=r.fillBefore(s.content,!0,o);return a&&!Ud(t,s.content,o)?a:null}function Ud(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}function qd(n){return n.spec.defining||n.spec.definingForContent}function Jd(n,e,t,r){if(!r.size)return n.deleteRange(e,t);let i=n.doc.resolve(e),s=n.doc.resolve(t);if(Jl(i,s,r))return n.step(new me(e,t,r));let o=Xl(i,n.doc.resolve(t));o[o.length-1]==0&&o.pop();let a=-(i.depth+1);o.unshift(a);for(let f=i.depth,h=i.pos-1;f>0;f--,h--){let p=i.node(f).type.spec;if(p.defining||p.definingAsContext||p.isolating)break;o.indexOf(f)>-1?a=f:i.before(f)==h&&o.splice(1,0,-f)}let l=o.indexOf(a),c=[],u=r.openStart;for(let f=r.content,h=0;;h++){let p=f.firstChild;if(c.push(p),h==r.openStart)break;f=p.content}for(let f=u-1;f>=0;f--){let h=c[f].type,p=qd(h);if(p&&i.node(l).type!=h)u=f;else if(p||!h.isTextblock)break}for(let f=r.openStart;f>=0;f--){let h=(f+u+1)%(r.openStart+1),p=c[h];if(!!p)for(let m=0;m<o.length;m++){let y=o[(m+l)%o.length],v=!0;y<0&&(v=!1,y=-y);let b=i.node(y-1),E=i.index(y-1);if(b.canReplaceWith(E,E,p.type,p.marks))return n.replace(i.before(y),v?s.after(y):t,new w(Yl(r.content,0,r.openStart,h),h,r.openEnd))}}let d=n.steps.length;for(let f=o.length-1;f>=0&&(n.replace(e,t,r),!(n.steps.length>d));f--){let h=o[f];h<0||(e=i.before(h),t=s.after(h))}}function Yl(n,e,t,r,i){if(e<t){let s=n.firstChild;n=n.replaceChild(0,s.copy(Yl(s.content,e+1,t,r,s)))}if(e>r){let s=i.contentMatchAt(0),o=s.fillBefore(n).append(n);n=o.append(s.matchFragment(o).fillBefore(k.empty,!0))}return n}function Gd(n,e,t,r){if(!r.isInline&&e==t&&n.doc.resolve(e).parent.content.size){let i=Wd(n.doc,e,r.type);i!=null&&(e=t=i)}n.replaceRange(e,t,new w(k.from(r),0,0))}function Yd(n,e,t){let r=n.doc.resolve(e),i=n.doc.resolve(t),s=Xl(r,i);for(let o=0;o<s.length;o++){let a=s[o],l=o==s.length-1;if(l&&a==0||r.node(a).type.contentMatch.validEnd)return n.delete(r.start(a),i.end(a));if(a>0&&(l||r.node(a-1).canReplace(r.index(a-1),i.indexAfter(a-1))))return n.delete(r.before(a),i.after(a))}for(let o=1;o<=r.depth&&o<=i.depth;o++)if(e-r.start(o)==r.depth-o&&t>r.end(o)&&i.end(o)-t!=i.depth-o)return n.delete(r.before(o),t);n.delete(e,t)}function Xl(n,e){let t=[],r=Math.min(n.depth,e.depth);for(let i=r;i>=0;i--){let s=n.start(i);if(s<n.pos-(n.depth-i)||e.end(i)>e.pos+(e.depth-i)||n.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(s==e.start(i)||i==n.depth&&i==e.depth&&n.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==s-1)&&t.push(i)}return t}class On extends we{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return ie.fail("No node at attribute step's position");let r=Object.create(null);for(let s in t.attrs)r[s]=t.attrs[s];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return ie.fromReplace(e,this.pos,this.pos+1,new w(k.from(i),0,t.isLeaf?0:1))}getMap(){return Ie.empty}invert(e){return new On(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new On(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new On(t.pos,t.attr,t.value)}}we.jsonID("attr",On);let Nn=class extends Error{};Nn=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};Nn.prototype=Object.create(Error.prototype);Nn.prototype.constructor=Nn;Nn.prototype.name="TransformError";class Ql{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new An}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new Nn(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,r=w.empty){let i=ro(this.doc,e,t,r);return i&&this.step(i),this}replaceWith(e,t,r){return this.replace(e,t,new w(k.from(r),0,0))}delete(e,t){return this.replace(e,t,w.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,r){return Jd(this,e,t,r),this}replaceRangeWith(e,t,r){return Gd(this,e,t,r),this}deleteRange(e,t){return Yd(this,e,t),this}lift(e,t){return Id(this,e,t),this}join(e,t=1){return _d(this,e,t),this}wrap(e,t){return zd(this,e,t),this}setBlockType(e,t=e,r,i=null){return Vd(this,e,t,r,i),this}setNodeMarkup(e,t,r=null,i=[]){return $d(this,e,t,r,i),this}setNodeAttribute(e,t,r){return this.step(new On(e,t,r)),this}addNodeMark(e,t){return this.step(new At(e,t)),this}removeNodeMark(e,t){if(!(t instanceof W)){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(t=t.isInSet(r.marks),!t)return this}return this.step(new Fn(e,t)),this}split(e,t=1,r){return jd(this,e,t,r),this}addMark(e,t,r){return Fd(this,e,t,r),this}removeMark(e,t,r){return Nd(this,e,t,r),this}clearIncompatible(e,t,r){return Bd(this,e,t,r),this}}const is=Object.create(null);class L{constructor(e,t,r){this.$anchor=e,this.$head=t,this.ranges=r||[new Xd(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=w.empty){let r=t.content.lastChild,i=null;for(let a=0;a<t.openEnd;a++)i=r,r=r.lastChild;let s=e.steps.length,o=this.ranges;for(let a=0;a<o.length;a++){let{$from:l,$to:c}=o[a],u=e.mapping.slice(s);e.replaceRange(u.map(l.pos),u.map(c.pos),a?w.empty:t),a==0&&Qo(e,s,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,t){let r=e.steps.length,i=this.ranges;for(let s=0;s<i.length;s++){let{$from:o,$to:a}=i[s],l=e.mapping.slice(r),c=l.map(o.pos),u=l.map(a.pos);s?e.deleteRange(c,u):(e.replaceRangeWith(c,u,t),Qo(e,r,t.isInline?-1:1))}}static findFrom(e,t,r=!1){let i=e.parent.inlineContent?new z(e):pn(e.node(0),e.parent,e.pos,e.index(),t,r);if(i)return i;for(let s=e.depth-1;s>=0;s--){let o=t<0?pn(e.node(0),e.node(s),e.before(s+1),e.index(s),t,r):pn(e.node(0),e.node(s),e.after(s+1),e.index(s)+1,t,r);if(o)return o}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new We(e.node(0))}static atStart(e){return pn(e,e,0,0,1)||new We(e)}static atEnd(e){return pn(e,e,e.content.size,e.childCount,-1)||new We(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=is[t.type];if(!r)throw new RangeError(`No selection type ${t.type} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in is)throw new RangeError("Duplicate use of selection JSON ID "+e);return is[e]=t,t.prototype.jsonID=e,t}getBookmark(){return z.between(this.$anchor,this.$head).getBookmark()}}L.prototype.visible=!0;class Xd{constructor(e,t){this.$from=e,this.$to=t}}let Yo=!1;function Xo(n){!Yo&&!n.parent.inlineContent&&(Yo=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class z extends L{constructor(e,t=e){Xo(e),Xo(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let r=e.resolve(t.map(this.head));if(!r.parent.inlineContent)return L.near(r);let i=e.resolve(t.map(this.anchor));return new z(i.parent.inlineContent?i:r,r)}replace(e,t=w.empty){if(super.replace(e,t),t==w.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof z&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Ii(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new z(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){let i=e.resolve(t);return new this(i,r==t?i:e.resolve(r))}static between(e,t,r){let i=e.pos-t.pos;if((!r||i)&&(r=i>=0?1:-1),!t.parent.inlineContent){let s=L.findFrom(t,r,!0)||L.findFrom(t,-r,!0);if(s)t=s.$head;else return L.near(t,r)}return e.parent.inlineContent||(i==0?e=t:(e=(L.findFrom(e,-r,!0)||L.findFrom(e,r,!0)).$anchor,e.pos<t.pos!=i<0&&(e=t))),new z(e,t)}}L.jsonID("text",z);class Ii{constructor(e,t){this.anchor=e,this.head=t}map(e){return new Ii(e.map(this.anchor),e.map(this.head))}resolve(e){return z.between(e.resolve(this.anchor),e.resolve(this.head))}}class R extends L{constructor(e){let t=e.nodeAfter,r=e.node(0).resolve(e.pos+t.nodeSize);super(e,r),this.node=t}map(e,t){let{deleted:r,pos:i}=t.mapResult(this.anchor),s=e.resolve(i);return r?L.near(s):new R(s)}content(){return new w(k.from(this.node),0,0)}eq(e){return e instanceof R&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new io(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new R(e.resolve(t.anchor))}static create(e,t){return new R(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}R.prototype.visible=!1;L.jsonID("node",R);class io{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:r}=e.mapResult(this.anchor);return t?new Ii(r,r):new io(r)}resolve(e){let t=e.resolve(this.anchor),r=t.nodeAfter;return r&&R.isSelectable(r)?new R(t):L.near(t)}}class We extends L{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=w.empty){if(t==w.empty){e.delete(0,e.doc.content.size);let r=L.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new We(e)}map(e){return new We(e)}eq(e){return e instanceof We}getBookmark(){return Qd}}L.jsonID("all",We);const Qd={map(){return this},resolve(n){return new We(n)}};function pn(n,e,t,r,i,s=!1){if(e.inlineContent)return z.create(n,t);for(let o=r-(i>0?0:1);i>0?o<e.childCount:o>=0;o+=i){let a=e.child(o);if(a.isAtom){if(!s&&R.isSelectable(a))return R.create(n,t-(i<0?a.nodeSize:0))}else{let l=pn(n,a,t+i,i<0?a.childCount:0,i,s);if(l)return l}t+=a.nodeSize*i}return null}function Qo(n,e,t){let r=n.steps.length-1;if(r<e)return;let i=n.steps[r];if(!(i instanceof me||i instanceof ae))return;let s=n.mapping.maps[r],o;s.forEach((a,l,c,u)=>{o==null&&(o=u)}),n.setSelection(L.near(n.doc.resolve(o),t))}const Zo=1,$r=2,ea=4;class Zd extends Ql{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|Zo)&~$r,this.storedMarks=null,this}get selectionSet(){return(this.updated&Zo)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=$r,this}ensureMarks(e){return W.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&$r)>0}addStep(e,t){super.addStep(e,t),this.updated=this.updated&~$r,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let r=this.selection;return t&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||W.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,r){let i=this.doc.type.schema;if(t==null)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(r==null&&(r=t),r=r??t,!e)return this.deleteRange(t,r);let s=this.storedMarks;if(!s){let o=this.doc.resolve(t);s=r==t?o.marks():o.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(t,r,i.text(e,s)),this.selection.empty||this.setSelection(L.near(this.selection.$to)),this}}setMeta(e,t){return this.meta[typeof e=="string"?e:e.key]=t,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=ea,this}get scrolledIntoView(){return(this.updated&ea)>0}}function ta(n,e){return!e||!n?n:n.bind(e)}class or{constructor(e,t,r){this.name=e,this.init=ta(t.init,r),this.apply=ta(t.apply,r)}}const ef=[new or("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new or("selection",{init(n,e){return n.selection||L.atStart(e.doc)},apply(n){return n.selection}}),new or("storedMarks",{init(n){return n.storedMarks||null},apply(n,e,t,r){return r.selection.$cursor?n.storedMarks:null}}),new or("scrollToSelection",{init(){return 0},apply(n,e){return n.scrolledIntoView?e+1:e}})];class ss{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=ef.slice(),t&&t.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new or(r.key,r.spec.state,r))})}}class yn{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=t){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],r=this.applyInner(e),i=null;for(;;){let s=!1;for(let o=0;o<this.config.plugins.length;o++){let a=this.config.plugins[o];if(a.spec.appendTransaction){let l=i?i[o].n:0,c=i?i[o].state:this,u=l<t.length&&a.spec.appendTransaction.call(a,l?t.slice(l):t,c,r);if(u&&r.filterTransaction(u,o)){if(u.setMeta("appendedTransaction",e),!i){i=[];for(let d=0;d<this.config.plugins.length;d++)i.push(d<o?{state:r,n:t.length}:{state:this,n:0})}t.push(u),r=r.applyInner(u),s=!0}i&&(i[o]={state:r,n:t.length})}}if(!s)return{state:r,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new yn(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let s=r[i];t[s.name]=s.apply(e,this[s.name],this,t)}return t}get tr(){return new Zd(this)}static create(e){let t=new ss(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new yn(t);for(let i=0;i<t.fields.length;i++)r[t.fields[i].name]=t.fields[i].init(e,r);return r}reconfigure(e){let t=new ss(this.schema,e.plugins),r=t.fields,i=new yn(t);for(let s=0;s<r.length;s++){let o=r[s].name;i[o]=this.hasOwnProperty(o)?this[o]:r[s].init(e,i)}return i}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[r],s=i.spec.state;s&&s.toJSON&&(t[r]=s.toJSON.call(i,this[i.key]))}return t}static fromJSON(e,t,r){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new ss(e.schema,e.plugins),s=new yn(i);return i.fields.forEach(o=>{if(o.name=="doc")s.doc=ht.fromJSON(e.schema,t.doc);else if(o.name=="selection")s.selection=L.fromJSON(s.doc,t.selection);else if(o.name=="storedMarks")t.storedMarks&&(s.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let a in r){let l=r[a],c=l.spec.state;if(l.key==o.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(t,a)){s[o.name]=c.fromJSON.call(l,e,t[a],s);return}}s[o.name]=o.init(e,s)}}),s}}function Zl(n,e,t){for(let r in n){let i=n[r];i instanceof Function?i=i.bind(e):r=="handleDOMEvents"&&(i=Zl(i,e,{})),t[r]=i}return t}class ue{constructor(e){this.spec=e,this.props={},e.props&&Zl(e.props,this,this.props),this.key=e.key?e.key.key:eu("plugin")}getState(e){return e[this.key]}}const as=Object.create(null);function eu(n){return n in as?n+"$"+ ++as[n]:(as[n]=0,n+"$")}class Fe{constructor(e="key"){this.key=eu(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const Me=function(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e},br=function(n){let e=n.assignedSlot||n.parentNode;return e&&e.nodeType==11?e.host:e};let na=null;const lt=function(n,e,t){let r=na||(na=document.createRange());return r.setEnd(n,t??n.nodeValue.length),r.setStart(n,e||0),r},en=function(n,e,t,r){return t&&(ra(n,e,t,r,-1)||ra(n,e,t,r,1))},tf=/^(img|br|input|textarea|hr)$/i;function ra(n,e,t,r,i){for(;;){if(n==t&&e==r)return!0;if(e==(i<0?0:Xe(n))){let s=n.parentNode;if(!s||s.nodeType!=1||rf(n)||tf.test(n.nodeName)||n.contentEditable=="false")return!1;e=Me(n)+(i<0?0:1),n=s}else if(n.nodeType==1){if(n=n.childNodes[e+(i<0?-1:0)],n.contentEditable=="false")return!1;e=i<0?Xe(n):0}else return!1}}function Xe(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function nf(n,e,t){for(let r=e==0,i=e==Xe(n);r||i;){if(n==t)return!0;let s=Me(n);if(n=n.parentNode,!n)return!1;r=r&&s==0,i=i&&s==Xe(n)}}function rf(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const Pi=function(n){return n.focusNode&&en(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function vn(n,e){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=n,t.key=t.code=e,t}function sf(n){let e=n.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}const Ft=typeof navigator<"u"?navigator:null,ia=typeof document<"u"?document:null,Rt=Ft&&Ft.userAgent||"",Bs=/Edge\/(\d+)/.exec(Rt),tu=/MSIE \d/.exec(Rt),Rs=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Rt),Ee=!!(tu||Rs||Bs),Ot=tu?document.documentMode:Rs?+Rs[1]:Bs?+Bs[1]:0,Ue=!Ee&&/gecko\/(\d+)/i.test(Rt);Ue&&+(/Firefox\/(\d+)/.exec(Rt)||[0,0])[1];const Is=!Ee&&/Chrome\/(\d+)/.exec(Rt),ke=!!Is,of=Is?+Is[1]:0,be=!Ee&&!!Ft&&/Apple Computer/.test(Ft.vendor),Bn=be&&(/Mobile\/\w+/.test(Rt)||!!Ft&&Ft.maxTouchPoints>2),Re=Bn||(Ft?/Mac/.test(Ft.platform):!1),Qe=/Android \d/.test(Rt),Li=!!ia&&"webkitFontSmoothing"in ia.documentElement.style,af=Li?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function lf(n){return{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function bt(n,e){return typeof n=="number"?n:n[e]}function uf(n){let e=n.getBoundingClientRect(),t=e.width/n.offsetWidth||1,r=e.height/n.offsetHeight||1;return{left:e.left,right:e.left+n.clientWidth*t,top:e.top,bottom:e.top+n.clientHeight*r}}function sa(n,e,t){let r=n.someProp("scrollThreshold")||0,i=n.someProp("scrollMargin")||5,s=n.dom.ownerDocument;for(let o=t||n.dom;o;o=br(o)){if(o.nodeType!=1)continue;let a=o,l=a==s.body,c=l?lf(s):uf(a),u=0,d=0;if(e.top<c.top+bt(r,"top")?d=-(c.top-e.top+bt(i,"top")):e.bottom>c.bottom-bt(r,"bottom")&&(d=e.bottom-c.bottom+bt(i,"bottom")),e.left<c.left+bt(r,"left")?u=-(c.left-e.left+bt(i,"left")):e.right>c.right-bt(r,"right")&&(u=e.right-c.right+bt(i,"right")),u||d)if(l)s.defaultView.scrollBy(u,d);else{let f=a.scrollLeft,h=a.scrollTop;d&&(a.scrollTop+=d),u&&(a.scrollLeft+=u);let p=a.scrollLeft-f,m=a.scrollTop-h;e={left:e.left-p,top:e.top-m,right:e.right-p,bottom:e.bottom-m}}if(l)break}}function cf(n){let e=n.dom.getBoundingClientRect(),t=Math.max(0,e.top),r,i;for(let s=(e.left+e.right)/2,o=t+1;o<Math.min(innerHeight,e.bottom);o+=5){let a=n.root.elementFromPoint(s,o);if(!a||a==n.dom||!n.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=t-20){r=a,i=l.top;break}}return{refDOM:r,refTop:i,stack:nu(n.dom)}}function nu(n){let e=[],t=n.ownerDocument;for(let r=n;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),n!=t);r=br(r));return e}function df({refDOM:n,refTop:e,stack:t}){let r=n?n.getBoundingClientRect().top:0;ru(t,r==0?0:r-e)}function ru(n,e){for(let t=0;t<n.length;t++){let{dom:r,top:i,left:s}=n[t];r.scrollTop!=i+e&&(r.scrollTop=i+e),r.scrollLeft!=s&&(r.scrollLeft=s)}}let hn=null;function ff(n){if(n.setActive)return n.setActive();if(hn)return n.focus(hn);let e=nu(n);n.focus(hn==null?{get preventScroll(){return hn={preventScroll:!0},!0}}:void 0),hn||(hn=!1,ru(e,0))}function iu(n,e){let t,r=2e8,i,s=0,o=e.top,a=e.top;for(let l=n.firstChild,c=0;l;l=l.nextSibling,c++){let u;if(l.nodeType==1)u=l.getClientRects();else if(l.nodeType==3)u=lt(l).getClientRects();else continue;for(let d=0;d<u.length;d++){let f=u[d];if(f.top<=o&&f.bottom>=a){o=Math.max(f.bottom,o),a=Math.min(f.top,a);let h=f.left>e.left?f.left-e.left:f.right<e.left?e.left-f.right:0;if(h<r){t=l,r=h,i=h&&t.nodeType==3?{left:f.right<e.left?f.right:f.left,top:e.top}:e,l.nodeType==1&&h&&(s=c+(e.left>=(f.left+f.right)/2?1:0));continue}}!t&&(e.left>=f.right&&e.top>=f.top||e.left>=f.left&&e.top>=f.bottom)&&(s=c+1)}}return t&&t.nodeType==3?hf(t,i):!t||r&&t.nodeType==1?{node:n,offset:s}:iu(t,i)}function hf(n,e){let t=n.nodeValue.length,r=document.createRange();for(let i=0;i<t;i++){r.setEnd(n,i+1),r.setStart(n,i);let s=Dt(r,1);if(s.top!=s.bottom&&so(e,s))return{node:n,offset:i+(e.left>=(s.left+s.right)/2?1:0)}}return{node:n,offset:0}}function so(n,e){return n.left>=e.left-1&&n.left<=e.right+1&&n.top>=e.top-1&&n.top<=e.bottom+1}function pf(n,e){let t=n.parentNode;return t&&/^li$/i.test(t.nodeName)&&e.left<n.getBoundingClientRect().left?t:n}function mf(n,e,t){let{node:r,offset:i}=iu(e,t),s=-1;if(r.nodeType==1&&!r.firstChild){let o=r.getBoundingClientRect();s=o.left!=o.right&&t.left>(o.left+o.right)/2?1:-1}return n.docView.posFromDOM(r,i,s)}function gf(n,e,t,r){let i=-1;for(let s=e;s!=n.dom;){let o=n.docView.nearestDesc(s,!0);if(!o)return null;if(o.node.isBlock&&o.parent){let a=o.dom.getBoundingClientRect();if(a.left>r.left||a.top>r.top)i=o.posBefore;else if(a.right<r.left||a.bottom<r.top)i=o.posAfter;else break}s=o.dom.parentNode}return i>-1?i:n.docView.posFromDOM(e,t,1)}function su(n,e,t){let r=n.childNodes.length;if(r&&t.top<t.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-t.top)/(t.bottom-t.top))-2)),s=i;;){let o=n.childNodes[s];if(o.nodeType==1){let a=o.getClientRects();for(let l=0;l<a.length;l++){let c=a[l];if(so(e,c))return su(o,e,c)}}if((s=(s+1)%r)==i)break}return n}function yf(n,e){let t=n.dom.ownerDocument,r,i=0;if(t.caretPositionFromPoint)try{let l=t.caretPositionFromPoint(e.left,e.top);l&&({offsetNode:r,offset:i}=l)}catch{}if(!r&&t.caretRangeFromPoint){let l=t.caretRangeFromPoint(e.left,e.top);l&&({startContainer:r,startOffset:i}=l)}let s=(n.root.elementFromPoint?n.root:t).elementFromPoint(e.left,e.top),o;if(!s||!n.dom.contains(s.nodeType!=1?s.parentNode:s)){let l=n.dom.getBoundingClientRect();if(!so(e,l)||(s=su(n.dom,e,l),!s))return null}if(be)for(let l=s;r&&l;l=br(l))l.draggable&&(r=void 0);if(s=pf(s,e),r){if(Ue&&r.nodeType==1&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let l=r.childNodes[i],c;l.nodeName=="IMG"&&(c=l.getBoundingClientRect()).right<=e.left&&c.bottom>e.top&&i++}r==n.dom&&i==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?o=n.state.doc.content.size:(i==0||r.nodeType!=1||r.childNodes[i-1].nodeName!="BR")&&(o=gf(n,r,i,e))}o==null&&(o=mf(n,s,e));let a=n.docView.nearestDesc(s,!0);return{pos:o,inside:a?a.posAtStart-a.border:-1}}function Dt(n,e){let t=n.getClientRects();return t.length?t[e<0?0:t.length-1]:n.getBoundingClientRect()}const vf=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function ou(n,e,t){let{node:r,offset:i,atom:s}=n.docView.domFromPos(e,t<0?-1:1),o=Li||Ue;if(r.nodeType==3)if(o&&(vf.test(r.nodeValue)||(t<0?!i:i==r.nodeValue.length))){let l=Dt(lt(r,i,i),t);if(Ue&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let c=Dt(lt(r,i-1,i-1),-1);if(c.top==l.top){let u=Dt(lt(r,i,i+1),-1);if(u.top!=l.top)return Xn(u,u.left<c.left)}}return l}else{let l=i,c=i,u=t<0?1:-1;return t<0&&!i?(c++,u=-1):t>=0&&i==r.nodeValue.length?(l--,u=1):t<0?l--:c++,Xn(Dt(lt(r,l,c),1),u<0)}if(!n.state.doc.resolve(e-(s||0)).parent.inlineContent){if(s==null&&i&&(t<0||i==Xe(r))){let l=r.childNodes[i-1];if(l.nodeType==1)return ls(l.getBoundingClientRect(),!1)}if(s==null&&i<Xe(r)){let l=r.childNodes[i];if(l.nodeType==1)return ls(l.getBoundingClientRect(),!0)}return ls(r.getBoundingClientRect(),t>=0)}if(s==null&&i&&(t<0||i==Xe(r))){let l=r.childNodes[i-1],c=l.nodeType==3?lt(l,Xe(l)-(o?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(c)return Xn(Dt(c,1),!1)}if(s==null&&i<Xe(r)){let l=r.childNodes[i];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let c=l?l.nodeType==3?lt(l,0,o?0:1):l.nodeType==1?l:null:null;if(c)return Xn(Dt(c,-1),!0)}return Xn(Dt(r.nodeType==3?lt(r):r,-t),t>=0)}function Xn(n,e){if(n.width==0)return n;let t=e?n.left:n.right;return{top:n.top,bottom:n.bottom,left:t,right:t}}function ls(n,e){if(n.height==0)return n;let t=e?n.top:n.bottom;return{top:t,bottom:t,left:n.left,right:n.right}}function au(n,e,t){let r=n.state,i=n.root.activeElement;r!=e&&n.updateState(e),i!=n.dom&&n.focus();try{return t()}finally{r!=e&&n.updateState(r),i!=n.dom&&i&&i.focus()}}function bf(n,e,t){let r=e.selection,i=t=="up"?r.$from:r.$to;return au(n,e,()=>{let{node:s}=n.docView.domFromPos(i.pos,t=="up"?-1:1);for(;;){let a=n.docView.nearestDesc(s,!0);if(!a)break;if(a.node.isBlock){s=a.dom;break}s=a.dom.parentNode}let o=ou(n,i.pos,1);for(let a=s.firstChild;a;a=a.nextSibling){let l;if(a.nodeType==1)l=a.getClientRects();else if(a.nodeType==3)l=lt(a,0,a.nodeValue.length).getClientRects();else continue;for(let c=0;c<l.length;c++){let u=l[c];if(u.bottom>u.top+1&&(t=="up"?o.top-u.top>(u.bottom-o.top)*2:u.bottom-o.bottom>(o.bottom-u.top)*2))return!1}}return!0})}const Df=/[\u0590-\u08ac]/;function Cf(n,e,t){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,s=!i,o=i==r.parent.content.size,a=n.domSelection();return!Df.test(r.parent.textContent)||!a.modify?t=="left"||t=="backward"?s:o:au(n,e,()=>{let{focusNode:l,focusOffset:c,anchorNode:u,anchorOffset:d}=n.domSelectionRange(),f=a.caretBidiLevel;a.modify("move",t,"character");let h=r.depth?n.docView.domAfterPos(r.before()):n.dom,{focusNode:p,focusOffset:m}=n.domSelectionRange(),y=p&&!h.contains(p.nodeType==1?p:p.parentNode)||l==p&&c==m;try{a.collapse(u,d),l&&(l!=u||c!=d)&&a.extend&&a.extend(l,c)}catch{}return f!=null&&(a.caretBidiLevel=f),y})}let oa=null,aa=null,la=!1;function kf(n,e,t){return oa==e&&aa==t?la:(oa=e,aa=t,la=t=="up"||t=="down"?bf(n,e,t):Cf(n,e,t))}const Ke=0,ua=1,bn=2,nt=3;class Sr{constructor(e,t,r,i){this.parent=e,this.children=t,this.dom=r,this.contentDOM=i,this.dirty=Ke,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,r=this.posAtStart;;t++){let i=this.children[t];if(i==e)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let s,o;if(e==this.contentDOM)s=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.previousSibling}for(;s&&!((o=s.pmViewDesc)&&o.parent==this);)s=s.previousSibling;return s?this.posBeforeChild(o)+o.size:this.posAtStart}else{let s,o;if(e==this.contentDOM)s=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.nextSibling}for(;s&&!((o=s.pmViewDesc)&&o.parent==this);)s=s.nextSibling;return s?this.posBeforeChild(o):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=t>Me(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(t==0)for(let s=e;;s=s.parentNode){if(s==this.dom){i=!1;break}if(s.previousSibling)break}if(i==null&&t==e.childNodes.length)for(let s=e;;s=s.parentNode){if(s==this.dom){i=!0;break}if(s.nextSibling)break}}return i??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let r=!0,i=e;i;i=i.parentNode){let s=this.getDesc(i),o;if(s&&(!t||s.node))if(r&&(o=s.nodeDOM)&&!(o.nodeType==1?o.contains(e.nodeType==1?e:e.parentNode):o==e))r=!1;else return s}}getDesc(e){let t=e.pmViewDesc;for(let r=t;r;r=r.parent)if(r==this)return t}posFromDOM(e,t,r){for(let i=e;i;i=i.parentNode){let s=this.getDesc(i);if(s)return s.localPosFromDOM(e,t,r)}return-1}descAt(e){for(let t=0,r=0;t<this.children.length;t++){let i=this.children[t],s=r+i.size;if(r==e&&s!=r){for(;!i.border&&i.children.length;)i=i.children[0];return i}if(e<s)return i.descAt(e-r-i.border);r=s}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,i=0;for(let s=0;r<this.children.length;r++){let o=this.children[r],a=s+o.size;if(a>e||o instanceof uu){i=e-s;break}s=a}if(i)return this.children[r].domFromPos(i-this.children[r].border,t);for(let s;r&&!(s=this.children[r-1]).size&&s instanceof lu&&s.side>=0;r--);if(t<=0){let s,o=!0;for(;s=r?this.children[r-1]:null,!(!s||s.dom.parentNode==this.contentDOM);r--,o=!1);return s&&t&&o&&!s.border&&!s.domAtom?s.domFromPos(s.size,t):{node:this.contentDOM,offset:s?Me(s.dom)+1:0}}else{let s,o=!0;for(;s=r<this.children.length?this.children[r]:null,!(!s||s.dom.parentNode==this.contentDOM);r++,o=!1);return s&&o&&!s.border&&!s.domAtom?s.domFromPos(0,t):{node:this.contentDOM,offset:s?Me(s.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,s=-1;for(let o=r,a=0;;a++){let l=this.children[a],c=o+l.size;if(i==-1&&e<=c){let u=o+l.border;if(e>=u&&t<=c-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,t,u);e=o;for(let d=a;d>0;d--){let f=this.children[d-1];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(1)){i=Me(f.dom)+1;break}e-=f.size}i==-1&&(i=0)}if(i>-1&&(c>t||a==this.children.length-1)){t=c;for(let u=a+1;u<this.children.length;u++){let d=this.children[u];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(-1)){s=Me(d.dom);break}t+=d.size}s==-1&&(s=this.contentDOM.childNodes.length);break}o=c}return{node:this.contentDOM,from:e,to:t,fromOffset:i,toOffset:s}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return t.size==0||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:r}=this.domFromPos(e,0);if(t.nodeType!=1||r==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[r]}setSelection(e,t,r,i=!1){let s=Math.min(e,t),o=Math.max(e,t);for(let f=0,h=0;f<this.children.length;f++){let p=this.children[f],m=h+p.size;if(s>h&&o<m)return p.setSelection(e-h-p.border,t-h-p.border,r,i);h=m}let a=this.domFromPos(e,e?-1:1),l=t==e?a:this.domFromPos(t,t?-1:1),c=r.getSelection(),u=!1;if((Ue||be)&&e==t){let{node:f,offset:h}=a;if(f.nodeType==3){if(u=!!(h&&f.nodeValue[h-1]==`
`),u&&h==f.nodeValue.length)for(let p=f,m;p;p=p.parentNode){if(m=p.nextSibling){m.nodeName=="BR"&&(a=l={node:m.parentNode,offset:Me(m)+1});break}let y=p.pmViewDesc;if(y&&y.node&&y.node.isBlock)break}}else{let p=f.childNodes[h-1];u=p&&(p.nodeName=="BR"||p.contentEditable=="false")}}if(Ue&&c.focusNode&&c.focusNode!=l.node&&c.focusNode.nodeType==1){let f=c.focusNode.childNodes[c.focusOffset];f&&f.contentEditable=="false"&&(i=!0)}if(!(i||u&&be)&&en(a.node,a.offset,c.anchorNode,c.anchorOffset)&&en(l.node,l.offset,c.focusNode,c.focusOffset))return;let d=!1;if((c.extend||e==t)&&!u){c.collapse(a.node,a.offset);try{e!=t&&c.extend(l.node,l.offset),d=!0}catch{}}if(!d){if(e>t){let h=a;a=l,l=h}let f=document.createRange();f.setEnd(l.node,l.offset),f.setStart(a.node,a.offset),c.removeAllRanges(),c.addRange(f)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let r=0,i=0;i<this.children.length;i++){let s=this.children[i],o=r+s.size;if(r==o?e<=o&&t>=r:e<o&&t>r){let a=r+s.border,l=o-s.border;if(e>=a&&t<=l){this.dirty=e==r||t==o?bn:ua,e==a&&t==l&&(s.contentLost||s.dom.parentNode!=this.contentDOM)?s.dirty=nt:s.markDirty(e-a,t-a);return}else s.dirty=s.dom==s.contentDOM&&s.dom.parentNode==this.contentDOM&&!s.children.length?bn:nt}r=o}this.dirty=bn}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let r=e==1?bn:ua;t.dirty<r&&(t.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}}class lu extends Sr{constructor(e,t,r,i){let s,o=t.type.toDOM;if(typeof o=="function"&&(o=o(r,()=>{if(!s)return i;if(s.parent)return s.parent.posBeforeChild(s)})),!t.type.spec.raw){if(o.nodeType!=1){let a=document.createElement("span");a.appendChild(o),o=a}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(e,[],o,null),this.widget=t,this.widget=t,s=this}matchesWidget(e){return this.dirty==Ke&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return t?t(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class Ef extends Sr{constructor(e,t,r,i){super(e,[],t,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class tn extends Sr{constructor(e,t,r,i){super(e,[],r,i),this.mark=t}static create(e,t,r,i){let s=i.nodeViews[t.type.name],o=s&&s(t,i,r);return(!o||!o.dom)&&(o=Ze.renderSpec(document,t.type.spec.toDOM(t,r))),new tn(e,t,o.dom,o.contentDOM||o.dom)}parseRule(){return this.dirty&nt||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM||void 0}}matchesMark(e){return this.dirty!=nt&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),this.dirty!=Ke){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=Ke}}slice(e,t,r){let i=tn.create(this.parent,this.mark,!0,r),s=this.children,o=this.size;t<o&&(s=zs(s,t,o,r)),e>0&&(s=zs(s,0,e,r));for(let a=0;a<s.length;a++)s[a].parent=i;return i.children=s,i}}class nn extends Sr{constructor(e,t,r,i,s,o,a,l,c){super(e,[],s,o),this.node=t,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=a,o&&this.updateChildren(l,c)}static create(e,t,r,i,s,o){let a=s.nodeViews[t.type.name],l,c=a&&a(t,s,()=>{if(!l)return o;if(l.parent)return l.parent.posBeforeChild(l)},r,i),u=c&&c.dom,d=c&&c.contentDOM;if(t.isText){if(!u)u=document.createTextNode(t.text);else if(u.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else u||({dom:u,contentDOM:d}=Ze.renderSpec(document,t.type.spec.toDOM(t)));!d&&!t.isText&&u.nodeName!="BR"&&(u.hasAttribute("contenteditable")||(u.contentEditable="false"),t.type.spec.draggable&&(u.draggable=!0));let f=u;return u=fu(u,r,t),c?l=new xf(e,t,r,i,u,d||null,f,c,s,o+1):t.isText?new zi(e,t,r,i,u,f,s):new nn(e,t,r,i,u,d||null,f,s,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let t=this.children.length-1;t>=0;t--){let r=this.children[t];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>k.empty)}return e}matchesNode(e,t,r){return this.dirty==Ke&&e.eq(this.node)&&Ls(t,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let r=this.node.inlineContent,i=t,s=e.composing?this.localCompositionInfo(e,t):null,o=s&&s.pos>-1?s:null,a=s&&s.pos<0,l=new Af(this,o&&o.node,e);Mf(this.node,this.innerDeco,(c,u,d)=>{c.spec.marks?l.syncToMarks(c.spec.marks,r,e):c.type.side>=0&&!d&&l.syncToMarks(u==this.node.childCount?W.none:this.node.child(u).marks,r,e),l.placeWidget(c,e,i)},(c,u,d,f)=>{l.syncToMarks(c.marks,r,e);let h;l.findNodeMatch(c,u,d,f)||a&&e.state.selection.from>i&&e.state.selection.to<i+c.nodeSize&&(h=l.findIndexWithChild(s.node))>-1&&l.updateNodeAt(c,u,d,h,e)||l.updateNextNode(c,u,d,e,f)||l.addNode(c,u,d,e,i),i+=c.nodeSize}),l.syncToMarks([],r,e),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==bn)&&(o&&this.protectLocalComposition(e,o),cu(this.contentDOM,this.children,e),Bn&&Tf(this.dom))}localCompositionInfo(e,t){let{from:r,to:i}=e.state.selection;if(!(e.state.selection instanceof z)||r<t||i>t+this.node.content.size)return null;let s=e.domSelectionRange(),o=Ff(s.focusNode,s.focusOffset);if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let a=o.nodeValue,l=Nf(this.node.content,a,r-t,i-t);return l<0?null:{node:o,pos:l,text:a}}else return{node:o,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:r,text:i}){if(this.getDesc(t))return;let s=t;for(;s.parentNode!=this.contentDOM;s=s.parentNode){for(;s.previousSibling;)s.parentNode.removeChild(s.previousSibling);for(;s.nextSibling;)s.parentNode.removeChild(s.nextSibling);s.pmViewDesc&&(s.pmViewDesc=void 0)}let o=new Ef(this,s,t,i);e.input.compositionNodes.push(o),this.children=zs(this.children,r,r+i.length,e,o)}update(e,t,r,i){return this.dirty==nt||!e.sameMarkup(this.node)?!1:(this.updateInner(e,t,r,i),!0)}updateInner(e,t,r,i){this.updateOuterDeco(t),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=Ke}updateOuterDeco(e){if(Ls(e,this.outerDeco))return;let t=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=du(this.dom,this.nodeDOM,Ps(this.outerDeco,this.node,t),Ps(e,this.node,t)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable")}get domAtom(){return this.node.isAtom}}function ca(n,e,t,r,i){return fu(r,e,n),new nn(void 0,n,e,t,r,r,r,i,0)}class zi extends nn{constructor(e,t,r,i,s,o,a){super(e,t,r,i,s,null,o,a,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,r,i){return this.dirty==nt||this.dirty!=Ke&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(t),(this.dirty!=Ke||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=Ke,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,r){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,t,r){let i=this.node.cut(e,t),s=document.createTextNode(i.text);return new zi(this.parent,i,this.outerDeco,this.innerDeco,s,s,r)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(e==0||t==this.nodeDOM.nodeValue.length)&&(this.dirty=nt)}get domAtom(){return!1}}class uu extends Sr{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==Ke&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class xf extends nn{constructor(e,t,r,i,s,o,a,l,c,u){super(e,t,r,i,s,o,a,c,u),this.spec=l}update(e,t,r,i){if(this.dirty==nt)return!1;if(this.spec.update){let s=this.spec.update(e,t,r);return s&&this.updateInner(e,t,r,i),s}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,t,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,r,i){this.spec.setSelection?this.spec.setSelection(e,t,r):super.setSelection(e,t,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function cu(n,e,t){let r=n.firstChild,i=!1;for(let s=0;s<e.length;s++){let o=e[s],a=o.dom;if(a.parentNode==n){for(;a!=r;)r=da(r),i=!0;r=r.nextSibling}else i=!0,n.insertBefore(a,r);if(o instanceof tn){let l=r?r.previousSibling:n.lastChild;cu(o.contentDOM,o.children,t),r=l?l.nextSibling:n.firstChild}}for(;r;)r=da(r),i=!0;i&&t.trackWrites==n&&(t.trackWrites=null)}const ur=function(n){n&&(this.nodeName=n)};ur.prototype=Object.create(null);const Kt=[new ur];function Ps(n,e,t){if(n.length==0)return Kt;let r=t?Kt[0]:new ur,i=[r];for(let s=0;s<n.length;s++){let o=n[s].type.attrs;if(!!o){o.nodeName&&i.push(r=new ur(o.nodeName));for(let a in o){let l=o[a];l!=null&&(t&&i.length==1&&i.push(r=new ur(e.isInline?"span":"div")),a=="class"?r.class=(r.class?r.class+" ":"")+l:a=="style"?r.style=(r.style?r.style+";":"")+l:a!="nodeName"&&(r[a]=l))}}}return i}function du(n,e,t,r){if(t==Kt&&r==Kt)return e;let i=e;for(let s=0;s<r.length;s++){let o=r[s],a=t[s];if(s){let l;a&&a.nodeName==o.nodeName&&i!=n&&(l=i.parentNode)&&l.nodeName.toLowerCase()==o.nodeName||(l=document.createElement(o.nodeName),l.pmIsDeco=!0,l.appendChild(i),a=Kt[0]),i=l}Sf(i,a||Kt[0],o)}return i}function Sf(n,e,t){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in t)&&n.removeAttribute(r);for(let r in t)r!="class"&&r!="style"&&r!="nodeName"&&t[r]!=e[r]&&n.setAttribute(r,t[r]);if(e.class!=t.class){let r=e.class?e.class.split(" ").filter(Boolean):[],i=t.class?t.class.split(" ").filter(Boolean):[];for(let s=0;s<r.length;s++)i.indexOf(r[s])==-1&&n.classList.remove(r[s]);for(let s=0;s<i.length;s++)r.indexOf(i[s])==-1&&n.classList.add(i[s]);n.classList.length==0&&n.removeAttribute("class")}if(e.style!=t.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=r.exec(e.style);)n.style.removeProperty(i[1])}t.style&&(n.style.cssText+=t.style)}}function fu(n,e,t){return du(n,n,Kt,Ps(e,t,n.nodeType!=1))}function Ls(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].type.eq(e[t].type))return!1;return!0}function da(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class Af{constructor(e,t,r){this.lock=t,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=wf(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let r=e;r<t;r++)this.top.children[r].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,r){let i=0,s=this.stack.length>>1,o=Math.min(s,e.length);for(;i<o&&(i==s-1?this.top:this.stack[i+1<<1]).matchesMark(e[i])&&e[i].type.spec.spanning!==!1;)i++;for(;i<s;)this.destroyRest(),this.top.dirty=Ke,this.index=this.stack.pop(),this.top=this.stack.pop(),s--;for(;s<e.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++)if(this.top.children[l].matchesMark(e[s])){a=l;break}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let l=tn.create(this.top,e[s],t,r);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,s++}}findNodeMatch(e,t,r,i){let s=-1,o;if(i>=this.preMatch.index&&(o=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&o.matchesNode(e,t,r))s=this.top.children.indexOf(o,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let c=this.top.children[a];if(c.matchesNode(e,t,r)&&!this.preMatch.matched.has(c)){s=a;break}}return s<0?!1:(this.destroyBetween(this.index,s),this.index++,!0)}updateNodeAt(e,t,r,i,s){let o=this.top.children[i];return o.dirty==nt&&o.dom==o.contentDOM&&(o.dirty=bn),o.update(e,t,r,s)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}e=t}}updateNextNode(e,t,r,i,s){for(let o=this.index;o<this.top.children.length;o++){let a=this.top.children[o];if(a instanceof nn){let l=this.preMatch.matched.get(a);if(l!=null&&l!=s)return!1;let c=a.dom;if(!(this.lock&&(c==this.lock||c.nodeType==1&&c.contains(this.lock.parentNode))&&!(e.isText&&a.node&&a.node.isText&&a.nodeDOM.nodeValue==e.text&&a.dirty!=nt&&Ls(t,a.outerDeco)))&&a.update(e,t,r,i))return this.destroyBetween(this.index,o),a.dom!=c&&(this.changed=!0),this.index++,!0;break}}return!1}addNode(e,t,r,i,s){this.top.children.splice(this.index++,0,nn.create(this.top,e,t,r,i,s)),this.changed=!0}placeWidget(e,t,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(e)&&(e==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let s=new lu(this.top,e,t,r);this.top.children.splice(this.index++,0,s),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof tn;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof zi)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((be||ke)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new uu(this.top,[],r,null);t!=this.top?t.children.push(i):t.children.splice(this.index++,0,i),this.changed=!0}}}function wf(n,e){let t=e,r=t.children.length,i=n.childCount,s=new Map,o=[];e:for(;i>0;){let a;for(;;)if(r){let c=t.children[r-1];if(c instanceof tn)t=c,r=c.children.length;else{a=c,r--;break}}else{if(t==e)break e;r=t.parent.children.indexOf(t),t=t.parent}let l=a.node;if(!!l){if(l!=n.child(i-1))break;--i,s.set(a,i),o.push(a)}}return{index:i,matched:s,matches:o.reverse()}}function Of(n,e){return n.type.side-e.type.side}function Mf(n,e,t,r){let i=e.locals(n),s=0;if(i.length==0){for(let c=0;c<n.childCount;c++){let u=n.child(c);r(u,i,e.forChild(s,u),c),s+=u.nodeSize}return}let o=0,a=[],l=null;for(let c=0;;){if(o<i.length&&i[o].to==s){let p=i[o++],m;for(;o<i.length&&i[o].to==s;)(m||(m=[p])).push(i[o++]);if(m){m.sort(Of);for(let y=0;y<m.length;y++)t(m[y],c,!!l)}else t(p,c,!!l)}let u,d;if(l)d=-1,u=l,l=null;else if(c<n.childCount)d=c,u=n.child(c++);else break;for(let p=0;p<a.length;p++)a[p].to<=s&&a.splice(p--,1);for(;o<i.length&&i[o].from<=s&&i[o].to>s;)a.push(i[o++]);let f=s+u.nodeSize;if(u.isText){let p=f;o<i.length&&i[o].from<p&&(p=i[o].from);for(let m=0;m<a.length;m++)a[m].to<p&&(p=a[m].to);p<f&&(l=u.cut(p-s),u=u.cut(0,p-s),f=p,d=-1)}let h=u.isInline&&!u.isLeaf?a.filter(p=>!p.inline):a.slice();r(u,h,e.forChild(s,u),d),s=f}}function Tf(n){if(n.nodeName=="UL"||n.nodeName=="OL"){let e=n.style.cssText;n.style.cssText=e+"; list-style: square !important",window.getComputedStyle(n).listStyle,n.style.cssText=e}}function Ff(n,e){for(;;){if(n.nodeType==3)return n;if(n.nodeType==1&&e>0){if(n.childNodes.length>e&&n.childNodes[e].nodeType==3)return n.childNodes[e];n=n.childNodes[e-1],e=Xe(n)}else if(n.nodeType==1&&e<n.childNodes.length)n=n.childNodes[e],e=0;else return null}}function Nf(n,e,t,r){for(let i=0,s=0;i<n.childCount&&s<=r;){let o=n.child(i++),a=s;if(s+=o.nodeSize,!o.isText)continue;let l=o.text;for(;i<n.childCount;){let c=n.child(i++);if(s+=c.nodeSize,!c.isText)break;l+=c.text}if(s>=t){let c=a<r?l.lastIndexOf(e,r-a-1):-1;if(c>=0&&c+e.length+a>=t)return a+c;if(t==r&&l.length>=r+e.length-a&&l.slice(r-a,r-a+e.length)==e)return r}}return-1}function zs(n,e,t,r,i){let s=[];for(let o=0,a=0;o<n.length;o++){let l=n[o],c=a,u=a+=l.size;c>=t||u<=e?s.push(l):(c<e&&s.push(l.slice(0,e-c,r)),i&&(s.push(i),i=void 0),u>t&&s.push(l.slice(t-c,l.size,r)))}return s}function oo(n,e=null){let t=n.domSelectionRange(),r=n.state.doc;if(!t.focusNode)return null;let i=n.docView.nearestDesc(t.focusNode),s=i&&i.size==0,o=n.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(o<0)return null;let a=r.resolve(o),l,c;if(Pi(t)){for(l=a;i&&!i.node;)i=i.parent;let u=i.node;if(i&&u.isAtom&&R.isSelectable(u)&&i.parent&&!(u.isInline&&nf(t.focusNode,t.focusOffset,i.dom))){let d=i.posBefore;c=new R(o==d?a:r.resolve(d))}}else{let u=n.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(u<0)return null;l=r.resolve(u)}if(!c){let u=e=="pointer"||n.state.selection.head<a.pos&&!s?1:-1;c=ao(n,l,a,u)}return c}function hu(n){return n.editable?n.hasFocus():mu(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function pt(n,e=!1){let t=n.state.selection;if(pu(n,t),!!hu(n)){if(!e&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&ke){let r=n.domSelectionRange(),i=n.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&en(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)Rf(n);else{let{anchor:r,head:i}=t,s,o;fa&&!(t instanceof z)&&(t.$from.parent.inlineContent||(s=ha(n,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(o=ha(n,t.to))),n.docView.setSelection(r,i,n.root,e),fa&&(s&&pa(s),o&&pa(o)),t.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&Bf(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const fa=be||ke&&of<63;function ha(n,e){let{node:t,offset:r}=n.docView.domFromPos(e,0),i=r<t.childNodes.length?t.childNodes[r]:null,s=r?t.childNodes[r-1]:null;if(be&&i&&i.contentEditable=="false")return us(i);if((!i||i.contentEditable=="false")&&(!s||s.contentEditable=="false")){if(i)return us(i);if(s)return us(s)}}function us(n){return n.contentEditable="true",be&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function pa(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function Bf(n){let e=n.dom.ownerDocument;e.removeEventListener("selectionchange",n.input.hideSelectionGuard);let t=n.domSelectionRange(),r=t.anchorNode,i=t.anchorOffset;e.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(t.anchorNode!=r||t.anchorOffset!=i)&&(e.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!hu(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function Rf(n){let e=n.domSelection(),t=document.createRange(),r=n.cursorWrapper.dom,i=r.nodeName=="IMG";i?t.setEnd(r.parentNode,Me(r)+1):t.setEnd(r,0),t.collapse(!1),e.removeAllRanges(),e.addRange(t),!i&&!n.state.selection.visible&&Ee&&Ot<=11&&(r.disabled=!0,r.disabled=!1)}function pu(n,e){if(e instanceof R){let t=n.docView.descAt(e.from);t!=n.lastSelectedViewDesc&&(ma(n),t&&t.selectNode(),n.lastSelectedViewDesc=t)}else ma(n)}function ma(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function ao(n,e,t,r){return n.someProp("createSelectionBetween",i=>i(n,e,t))||z.between(e,t,r)}function ga(n){return n.editable&&!n.hasFocus()?!1:mu(n)}function mu(n){let e=n.domSelectionRange();if(!e.anchorNode)return!1;try{return n.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function If(n){let e=n.docView.domFromPos(n.state.selection.anchor,0),t=n.domSelectionRange();return en(e.node,e.offset,t.anchorNode,t.anchorOffset)}function Vs(n,e){let{$anchor:t,$head:r}=n.selection,i=e>0?t.max(r):t.min(r),s=i.parent.inlineContent?i.depth?n.doc.resolve(e>0?i.after():i.before()):null:i;return s&&L.findFrom(s,e)}function _t(n,e){return n.dispatch(n.state.tr.setSelection(e).scrollIntoView()),!0}function ya(n,e,t){let r=n.state.selection;if(r instanceof z){if(!r.empty||t.indexOf("s")>-1)return!1;if(n.endOfTextblock(e>0?"right":"left")){let i=Vs(n.state,e);return i&&i instanceof R?_t(n,i):!1}else if(!(Re&&t.indexOf("m")>-1)){let i=r.$head,s=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,o;if(!s||s.isText)return!1;let a=e<0?i.pos-s.nodeSize:i.pos;return s.isAtom||(o=n.docView.descAt(a))&&!o.contentDOM?R.isSelectable(s)?_t(n,new R(e<0?n.state.doc.resolve(i.pos-s.nodeSize):i)):Li?_t(n,new z(n.state.doc.resolve(e<0?a:a+s.nodeSize))):!1:!1}}else{if(r instanceof R&&r.node.isInline)return _t(n,new z(e>0?r.$to:r.$from));{let i=Vs(n.state,e);return i?_t(n,i):!1}}}function si(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function cr(n){let e=n.pmViewDesc;return e&&e.size==0&&(n.nextSibling||n.nodeName!="BR")}function cs(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let i,s,o=!1;for(Ue&&t.nodeType==1&&r<si(t)&&cr(t.childNodes[r])&&(o=!0);;)if(r>0){if(t.nodeType!=1)break;{let a=t.childNodes[r-1];if(cr(a))i=t,s=--r;else if(a.nodeType==3)t=a,r=t.nodeValue.length;else break}}else{if(gu(t))break;{let a=t.previousSibling;for(;a&&cr(a);)i=t.parentNode,s=Me(a),a=a.previousSibling;if(a)t=a,r=si(t);else{if(t=t.parentNode,t==n.dom)break;r=0}}}o?Hs(n,t,r):i&&Hs(n,i,s)}function ds(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let i=si(t),s,o;for(;;)if(r<i){if(t.nodeType!=1)break;let a=t.childNodes[r];if(cr(a))s=t,o=++r;else break}else{if(gu(t))break;{let a=t.nextSibling;for(;a&&cr(a);)s=a.parentNode,o=Me(a)+1,a=a.nextSibling;if(a)t=a,r=0,i=si(t);else{if(t=t.parentNode,t==n.dom)break;r=i=0}}}s&&Hs(n,s,o)}function gu(n){let e=n.pmViewDesc;return e&&e.node&&e.node.isBlock}function Hs(n,e,t){let r=n.domSelection();if(Pi(r)){let s=document.createRange();s.setEnd(e,t),s.setStart(e,t),r.removeAllRanges(),r.addRange(s)}else r.extend&&r.extend(e,t);n.domObserver.setCurSelection();let{state:i}=n;setTimeout(()=>{n.state==i&&pt(n)},50)}function va(n,e,t){let r=n.state.selection;if(r instanceof z&&!r.empty||t.indexOf("s")>-1||Re&&t.indexOf("m")>-1)return!1;let{$from:i,$to:s}=r;if(!i.parent.inlineContent||n.endOfTextblock(e<0?"up":"down")){let o=Vs(n.state,e);if(o&&o instanceof R)return _t(n,o)}if(!i.parent.inlineContent){let o=e<0?i:s,a=r instanceof We?L.near(o,e):L.findFrom(o,e);return a?_t(n,a):!1}return!1}function ba(n,e){if(!(n.state.selection instanceof z))return!0;let{$head:t,$anchor:r,empty:i}=n.state.selection;if(!t.sameParent(r))return!0;if(!i)return!1;if(n.endOfTextblock(e>0?"forward":"backward"))return!0;let s=!t.textOffset&&(e<0?t.nodeBefore:t.nodeAfter);if(s&&!s.isText){let o=n.state.tr;return e<0?o.delete(t.pos-s.nodeSize,t.pos):o.delete(t.pos,t.pos+s.nodeSize),n.dispatch(o),!0}return!1}function Da(n,e,t){n.domObserver.stop(),e.contentEditable=t,n.domObserver.start()}function Pf(n){if(!be||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:t}=n.domSelectionRange();if(e&&e.nodeType==1&&t==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;Da(n,r,"true"),setTimeout(()=>Da(n,r,"false"),20)}return!1}function Lf(n){let e="";return n.ctrlKey&&(e+="c"),n.metaKey&&(e+="m"),n.altKey&&(e+="a"),n.shiftKey&&(e+="s"),e}function zf(n,e){let t=e.keyCode,r=Lf(e);return t==8||Re&&t==72&&r=="c"?ba(n,-1)||cs(n):t==46||Re&&t==68&&r=="c"?ba(n,1)||ds(n):t==13||t==27?!0:t==37||Re&&t==66&&r=="c"?ya(n,-1,r)||cs(n):t==39||Re&&t==70&&r=="c"?ya(n,1,r)||ds(n):t==38||Re&&t==80&&r=="c"?va(n,-1,r)||cs(n):t==40||Re&&t==78&&r=="c"?Pf(n)||va(n,1,r)||ds(n):r==(Re?"m":"c")&&(t==66||t==73||t==89||t==90)}function yu(n,e){n.someProp("transformCopied",h=>{e=h(e,n)});let t=[],{content:r,openStart:i,openEnd:s}=e;for(;i>1&&s>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,s--;let h=r.firstChild;t.push(h.type.name,h.attrs!=h.type.defaultAttrs?h.attrs:null),r=h.content}let o=n.someProp("clipboardSerializer")||Ze.fromSchema(n.state.schema),a=Eu(),l=a.createElement("div");l.appendChild(o.serializeFragment(r,{document:a}));let c=l.firstChild,u,d=0;for(;c&&c.nodeType==1&&(u=ku[c.nodeName.toLowerCase()]);){for(let h=u.length-1;h>=0;h--){let p=a.createElement(u[h]);for(;l.firstChild;)p.appendChild(l.firstChild);l.appendChild(p),d++}c=l.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${i} ${s}${d?` -${d}`:""} ${JSON.stringify(t)}`);let f=n.someProp("clipboardTextSerializer",h=>h(e,n))||e.content.textBetween(0,e.content.size,`

`);return{dom:l,text:f}}function vu(n,e,t,r,i){let s=i.parent.type.spec.code,o,a;if(!t&&!e)return null;let l=e&&(r||s||!t);if(l){if(n.someProp("transformPastedText",f=>{e=f(e,s||r,n)}),s)return e?new w(k.from(n.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):w.empty;let d=n.someProp("clipboardTextParser",f=>f(e,i,r,n));if(d)a=d;else{let f=i.marks(),{schema:h}=n.state,p=Ze.fromSchema(h);o=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(m=>{let y=o.appendChild(document.createElement("p"));m&&y.appendChild(p.serializeNode(h.text(m,f)))})}}else n.someProp("transformPastedHTML",d=>{t=d(t,n)}),o=$f(t),Li&&jf(o);let c=o&&o.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let d=+u[3];d>0;d--){let f=o.firstChild;for(;f&&f.nodeType!=1;)f=f.nextSibling;if(!f)break;o=f}if(a||(a=(n.someProp("clipboardParser")||n.someProp("domParser")||Tn.fromSchema(n.state.schema)).parseSlice(o,{preserveWhitespace:!!(l||u),context:i,ruleFromNode(f){return f.nodeName=="BR"&&!f.nextSibling&&f.parentNode&&!Vf.test(f.parentNode.nodeName)?{ignore:!0}:null}})),u)a=_f(Ca(a,+u[1],+u[2]),u[4]);else if(a=w.maxOpen(Hf(a.content,i),!0),a.openStart||a.openEnd){let d=0,f=0;for(let h=a.content.firstChild;d<a.openStart&&!h.type.spec.isolating;d++,h=h.firstChild);for(let h=a.content.lastChild;f<a.openEnd&&!h.type.spec.isolating;f++,h=h.lastChild);a=Ca(a,d,f)}return n.someProp("transformPasted",d=>{a=d(a,n)}),a}const Vf=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Hf(n,e){if(n.childCount<2)return n;for(let t=e.depth;t>=0;t--){let i=e.node(t).contentMatchAt(e.index(t)),s,o=[];if(n.forEach(a=>{if(!o)return;let l=i.findWrapping(a.type),c;if(!l)return o=null;if(c=o.length&&s.length&&Du(l,s,a,o[o.length-1],0))o[o.length-1]=c;else{o.length&&(o[o.length-1]=Cu(o[o.length-1],s.length));let u=bu(a,l);o.push(u),i=i.matchType(u.type),s=l}}),o)return k.from(o)}return n}function bu(n,e,t=0){for(let r=e.length-1;r>=t;r--)n=e[r].create(null,k.from(n));return n}function Du(n,e,t,r,i){if(i<n.length&&i<e.length&&n[i]==e[i]){let s=Du(n,e,t,r.lastChild,i+1);if(s)return r.copy(r.content.replaceChild(r.childCount-1,s));if(r.contentMatchAt(r.childCount).matchType(i==n.length-1?t.type:n[i+1]))return r.copy(r.content.append(k.from(bu(t,n,i+1))))}}function Cu(n,e){if(e==0)return n;let t=n.content.replaceChild(n.childCount-1,Cu(n.lastChild,e-1)),r=n.contentMatchAt(n.childCount).fillBefore(k.empty,!0);return n.copy(t.append(r))}function $s(n,e,t,r,i,s){let o=e<0?n.firstChild:n.lastChild,a=o.content;return i<r-1&&(a=$s(a,e,t,r,i+1,s)),i>=t&&(a=e<0?o.contentMatchAt(0).fillBefore(a,n.childCount>1||s<=i).append(a):a.append(o.contentMatchAt(o.childCount).fillBefore(k.empty,!0))),n.replaceChild(e<0?0:n.childCount-1,o.copy(a))}function Ca(n,e,t){return e<n.openStart&&(n=new w($s(n.content,-1,e,n.openStart,0,n.openEnd),e,n.openEnd)),t<n.openEnd&&(n=new w($s(n.content,1,t,n.openEnd,0,0),n.openStart,t)),n}const ku={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let ka=null;function Eu(){return ka||(ka=document.implementation.createHTMLDocument("title"))}function $f(n){let e=/^(\s*<meta [^>]*>)*/.exec(n);e&&(n=n.slice(e[0].length));let t=Eu().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),i;if((i=r&&ku[r[1].toLowerCase()])&&(n=i.map(s=>"<"+s+">").join("")+n+i.map(s=>"</"+s+">").reverse().join("")),t.innerHTML=n,i)for(let s=0;s<i.length;s++)t=t.querySelector(i[s])||t;return t}function jf(n){let e=n.querySelectorAll(ke?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<e.length;t++){let r=e[t];r.childNodes.length==1&&r.textContent==" "&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function _f(n,e){if(!n.size)return n;let t=n.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return n}let{content:i,openStart:s,openEnd:o}=n;for(let a=r.length-2;a>=0;a-=2){let l=t.nodes[r[a]];if(!l||l.hasRequiredAttrs())break;i=k.from(l.create(r[a+1],i)),s++,o++}return new w(i,s,o)}const De={},Ce={},Wf={touchstart:!0,touchmove:!0};class Kf{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastAndroidDelete=0,this.composing=!1,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function Uf(n){for(let e in De){let t=De[e];n.dom.addEventListener(e,n.input.eventHandlers[e]=r=>{Jf(n,r)&&!lo(n,r)&&(n.editable||!(r.type in Ce))&&t(n,r)},Wf[e]?{passive:!0}:void 0)}be&&n.dom.addEventListener("input",()=>null),js(n)}function wt(n,e){n.input.lastSelectionOrigin=e,n.input.lastSelectionTime=Date.now()}function qf(n){n.domObserver.stop();for(let e in n.input.eventHandlers)n.dom.removeEventListener(e,n.input.eventHandlers[e]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}function js(n){n.someProp("handleDOMEvents",e=>{for(let t in e)n.input.eventHandlers[t]||n.dom.addEventListener(t,n.input.eventHandlers[t]=r=>lo(n,r))})}function lo(n,e){return n.someProp("handleDOMEvents",t=>{let r=t[e.type];return r?r(n,e)||e.defaultPrevented:!1})}function Jf(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target;t!=n.dom;t=t.parentNode)if(!t||t.nodeType==11||t.pmViewDesc&&t.pmViewDesc.stopEvent(e))return!1;return!0}function Gf(n,e){!lo(n,e)&&De[e.type]&&(n.editable||!(e.type in Ce))&&De[e.type](n,e)}Ce.keydown=(n,e)=>{let t=e;if(n.input.shiftKey=t.keyCode==16||t.shiftKey,!Su(n,t)&&(n.input.lastKeyCode=t.keyCode,n.input.lastKeyCodeTime=Date.now(),!(Qe&&ke&&t.keyCode==13)))if(t.keyCode!=229&&n.domObserver.forceFlush(),Bn&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",i=>i(n,vn(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,t))||zf(n,t)?t.preventDefault():wt(n,"key")};Ce.keyup=(n,e)=>{e.keyCode==16&&(n.input.shiftKey=!1)};Ce.keypress=(n,e)=>{let t=e;if(Su(n,t)||!t.charCode||t.ctrlKey&&!t.altKey||Re&&t.metaKey)return;if(n.someProp("handleKeyPress",i=>i(n,t))){t.preventDefault();return}let r=n.state.selection;if(!(r instanceof z)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(t.charCode);n.someProp("handleTextInput",s=>s(n,r.$from.pos,r.$to.pos,i))||n.dispatch(n.state.tr.insertText(i).scrollIntoView()),t.preventDefault()}};function Vi(n){return{left:n.clientX,top:n.clientY}}function Yf(n,e){let t=e.x-n.clientX,r=e.y-n.clientY;return t*t+r*r<100}function uo(n,e,t,r,i){if(r==-1)return!1;let s=n.state.doc.resolve(r);for(let o=s.depth+1;o>0;o--)if(n.someProp(e,a=>o>s.depth?a(n,t,s.nodeAfter,s.before(o),i,!0):a(n,t,s.node(o),s.before(o),i,!1)))return!0;return!1}function Mn(n,e,t){n.focused||n.focus();let r=n.state.tr.setSelection(e);t=="pointer"&&r.setMeta("pointer",!0),n.dispatch(r)}function Xf(n,e){if(e==-1)return!1;let t=n.state.doc.resolve(e),r=t.nodeAfter;return r&&r.isAtom&&R.isSelectable(r)?(Mn(n,new R(t),"pointer"),!0):!1}function Qf(n,e){if(e==-1)return!1;let t=n.state.selection,r,i;t instanceof R&&(r=t.node);let s=n.state.doc.resolve(e);for(let o=s.depth+1;o>0;o--){let a=o>s.depth?s.nodeAfter:s.node(o);if(R.isSelectable(a)){r&&t.$from.depth>0&&o>=t.$from.depth&&s.before(t.$from.depth+1)==t.$from.pos?i=s.before(t.$from.depth):i=s.before(o);break}}return i!=null?(Mn(n,R.create(n.state.doc,i),"pointer"),!0):!1}function Zf(n,e,t,r,i){return uo(n,"handleClickOn",e,t,r)||n.someProp("handleClick",s=>s(n,e,r))||(i?Qf(n,t):Xf(n,t))}function eh(n,e,t,r){return uo(n,"handleDoubleClickOn",e,t,r)||n.someProp("handleDoubleClick",i=>i(n,e,r))}function th(n,e,t,r){return uo(n,"handleTripleClickOn",e,t,r)||n.someProp("handleTripleClick",i=>i(n,e,r))||nh(n,t,r)}function nh(n,e,t){if(t.button!=0)return!1;let r=n.state.doc;if(e==-1)return r.inlineContent?(Mn(n,z.create(r,0,r.content.size),"pointer"),!0):!1;let i=r.resolve(e);for(let s=i.depth+1;s>0;s--){let o=s>i.depth?i.nodeAfter:i.node(s),a=i.before(s);if(o.inlineContent)Mn(n,z.create(r,a+1,a+1+o.content.size),"pointer");else if(R.isSelectable(o))Mn(n,R.create(r,a),"pointer");else continue;return!0}}function co(n){return oi(n)}const xu=Re?"metaKey":"ctrlKey";De.mousedown=(n,e)=>{let t=e;n.input.shiftKey=t.shiftKey;let r=co(n),i=Date.now(),s="singleClick";i-n.input.lastClick.time<500&&Yf(t,n.input.lastClick)&&!t[xu]&&(n.input.lastClick.type=="singleClick"?s="doubleClick":n.input.lastClick.type=="doubleClick"&&(s="tripleClick")),n.input.lastClick={time:i,x:t.clientX,y:t.clientY,type:s};let o=n.posAtCoords(Vi(t));!o||(s=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new rh(n,o,t,!!r)):(s=="doubleClick"?eh:th)(n,o.pos,o.inside,t)?t.preventDefault():wt(n,"pointer"))};class rh{constructor(e,t,r,i){this.view=e,this.pos=t,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[xu],this.allowDefault=r.shiftKey;let s,o;if(t.inside>-1)s=e.state.doc.nodeAt(t.inside),o=t.inside;else{let u=e.state.doc.resolve(t.pos);s=u.parent,o=u.depth?u.before():0}const a=i?null:r.target,l=a?e.docView.nearestDesc(a,!0):null;this.target=l?l.dom:null;let{selection:c}=e.state;(r.button==0&&s.type.spec.draggable&&s.type.spec.selectable!==!1||c instanceof R&&c.from<=o&&c.to>o)&&(this.mightDrag={node:s,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Ue&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),wt(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>pt(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(Vi(e))),this.updateAllowDefault(e),this.allowDefault||!t?wt(this.view,"pointer"):Zf(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||be&&this.mightDrag&&!this.mightDrag.node.isAtom||ke&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(Mn(this.view,L.near(this.view.state.doc.resolve(t.pos)),"pointer"),e.preventDefault()):wt(this.view,"pointer")}move(e){this.updateAllowDefault(e),wt(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}De.touchstart=n=>{n.input.lastTouch=Date.now(),co(n),wt(n,"pointer")};De.touchmove=n=>{n.input.lastTouch=Date.now(),wt(n,"pointer")};De.contextmenu=n=>co(n);function Su(n,e){return n.composing?!0:be&&Math.abs(e.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const ih=Qe?5e3:-1;Ce.compositionstart=Ce.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:e}=n,t=e.selection.$from;if(e.selection.empty&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))n.markCursor=n.state.storedMarks||t.marks(),oi(n,!0),n.markCursor=null;else if(oi(n),Ue&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let r=n.domSelectionRange();for(let i=r.focusNode,s=r.focusOffset;i&&i.nodeType==1&&s!=0;){let o=s<0?i.lastChild:i.childNodes[s-1];if(!o)break;if(o.nodeType==3){n.domSelection().collapse(o,o.nodeValue.length);break}else i=o,s=-1}}n.input.composing=!0}Au(n,ih)};Ce.compositionend=(n,e)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=e.timeStamp,Au(n,20))};function Au(n,e){clearTimeout(n.input.composingTimeout),e>-1&&(n.input.composingTimeout=setTimeout(()=>oi(n),e))}function wu(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=sh());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function sh(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function oi(n,e=!1){if(!(Qe&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),wu(n),e||n.docView&&n.docView.dirty){let t=oo(n);return t&&!t.eq(n.state.selection)?n.dispatch(n.state.tr.setSelection(t)):n.updateState(n.state),!0}return!1}}function oh(n,e){if(!n.dom.parentNode)return;let t=n.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(e),n.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),n.focus()},50)}const Rn=Ee&&Ot<15||Bn&&af<604;De.copy=Ce.cut=(n,e)=>{let t=e,r=n.state.selection,i=t.type=="cut";if(r.empty)return;let s=Rn?null:t.clipboardData,o=r.content(),{dom:a,text:l}=yu(n,o);s?(t.preventDefault(),s.clearData(),s.setData("text/html",a.innerHTML),s.setData("text/plain",l)):oh(n,a),i&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function ah(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function lh(n,e){if(!n.dom.parentNode)return;let t=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus(),setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),t?_s(n,r.value,null,e):_s(n,r.textContent,r.innerHTML,e)},50)}function _s(n,e,t,r){let i=vu(n,e,t,n.input.shiftKey,n.state.selection.$from);if(n.someProp("handlePaste",a=>a(n,r,i||w.empty)))return!0;if(!i)return!1;let s=ah(i),o=s?n.state.tr.replaceSelectionWith(s,n.input.shiftKey):n.state.tr.replaceSelection(i);return n.dispatch(o.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}Ce.paste=(n,e)=>{let t=e;if(n.composing&&!Qe)return;let r=Rn?null:t.clipboardData;r&&_s(n,r.getData("text/plain"),r.getData("text/html"),t)?t.preventDefault():lh(n,t)};class uh{constructor(e,t){this.slice=e,this.move=t}}const Ou=Re?"altKey":"ctrlKey";De.dragstart=(n,e)=>{let t=e,r=n.input.mouseDown;if(r&&r.done(),!t.dataTransfer)return;let i=n.state.selection,s=i.empty?null:n.posAtCoords(Vi(t));if(!(s&&s.pos>=i.from&&s.pos<=(i instanceof R?i.to-1:i.to))){if(r&&r.mightDrag)n.dispatch(n.state.tr.setSelection(R.create(n.state.doc,r.mightDrag.pos)));else if(t.target&&t.target.nodeType==1){let c=n.docView.nearestDesc(t.target,!0);c&&c.node.type.spec.draggable&&c!=n.docView&&n.dispatch(n.state.tr.setSelection(R.create(n.state.doc,c.posBefore)))}}let o=n.state.selection.content(),{dom:a,text:l}=yu(n,o);t.dataTransfer.clearData(),t.dataTransfer.setData(Rn?"Text":"text/html",a.innerHTML),t.dataTransfer.effectAllowed="copyMove",Rn||t.dataTransfer.setData("text/plain",l),n.dragging=new uh(o,!t[Ou])};De.dragend=n=>{let e=n.dragging;window.setTimeout(()=>{n.dragging==e&&(n.dragging=null)},50)};Ce.dragover=Ce.dragenter=(n,e)=>e.preventDefault();Ce.drop=(n,e)=>{let t=e,r=n.dragging;if(n.dragging=null,!t.dataTransfer)return;let i=n.posAtCoords(Vi(t));if(!i)return;let s=n.state.doc.resolve(i.pos),o=r&&r.slice;o?n.someProp("transformPasted",p=>{o=p(o,n)}):o=vu(n,t.dataTransfer.getData(Rn?"Text":"text/plain"),Rn?null:t.dataTransfer.getData("text/html"),!1,s);let a=!!(r&&!t[Ou]);if(n.someProp("handleDrop",p=>p(n,t,o||w.empty,a))){t.preventDefault();return}if(!o)return;t.preventDefault();let l=o?ql(n.state.doc,s.pos,o):s.pos;l==null&&(l=s.pos);let c=n.state.tr;a&&c.deleteSelection();let u=c.mapping.map(l),d=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,f=c.doc;if(d?c.replaceRangeWith(u,u,o.content.firstChild):c.replaceRange(u,u,o),c.doc.eq(f))return;let h=c.doc.resolve(u);if(d&&R.isSelectable(o.content.firstChild)&&h.nodeAfter&&h.nodeAfter.sameMarkup(o.content.firstChild))c.setSelection(new R(h));else{let p=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((m,y,v,b)=>p=b),c.setSelection(ao(n,h,c.doc.resolve(p)))}n.focus(),n.dispatch(c.setMeta("uiEvent","drop"))};De.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&pt(n)},20))};De.blur=(n,e)=>{let t=e;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),t.relatedTarget&&n.dom.contains(t.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};De.beforeinput=(n,e)=>{if(ke&&Qe&&e.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:r}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=r||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",s=>s(n,vn(8,"Backspace")))))return;let{$cursor:i}=n.state.selection;i&&i.pos>0&&n.dispatch(n.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let n in Ce)De[n]=Ce[n];function Dr(n,e){if(n==e)return!0;for(let t in n)if(n[t]!==e[t])return!1;for(let t in e)if(!(t in n))return!1;return!0}class fo{constructor(e,t){this.toDOM=e,this.spec=t||Gt,this.side=this.spec.side||0}map(e,t,r,i){let{pos:s,deleted:o}=e.mapResult(t.from+i,this.side<0?-1:1);return o?null:new Te(s-r,s-r,this)}valid(){return!0}eq(e){return this==e||e instanceof fo&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Dr(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Mt{constructor(e,t){this.attrs=e,this.spec=t||Gt}map(e,t,r,i){let s=e.map(t.from+i,this.spec.inclusiveStart?-1:1)-r,o=e.map(t.to+i,this.spec.inclusiveEnd?1:-1)-r;return s>=o?null:new Te(s,o,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof Mt&&Dr(this.attrs,e.attrs)&&Dr(this.spec,e.spec)}static is(e){return e.type instanceof Mt}destroy(){}}class ho{constructor(e,t){this.attrs=e,this.spec=t||Gt}map(e,t,r,i){let s=e.mapResult(t.from+i,1);if(s.deleted)return null;let o=e.mapResult(t.to+i,-1);return o.deleted||o.pos<=s.pos?null:new Te(s.pos-r,o.pos-r,this)}valid(e,t){let{index:r,offset:i}=e.content.findIndex(t.from),s;return i==t.from&&!(s=e.child(r)).isText&&i+s.nodeSize==t.to}eq(e){return this==e||e instanceof ho&&Dr(this.attrs,e.attrs)&&Dr(this.spec,e.spec)}destroy(){}}class Te{constructor(e,t,r){this.from=e,this.to=t,this.type=r}copy(e,t){return new Te(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,r){return this.type.map(e,this,t,r)}static widget(e,t,r){return new Te(e,e,new fo(t,r))}static inline(e,t,r,i){return new Te(e,t,new Mt(r,i))}static node(e,t,r,i){return new Te(e,t,new ho(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof Mt}}const mn=[],Gt={};class te{constructor(e,t){this.local=e.length?e:mn,this.children=t.length?t:mn}static create(e,t){return t.length?ai(t,e,0,Gt):pe}find(e,t,r){let i=[];return this.findInner(e??0,t??1e9,i,0,r),i}findInner(e,t,r,i,s){for(let o=0;o<this.local.length;o++){let a=this.local[o];a.from<=t&&a.to>=e&&(!s||s(a.spec))&&r.push(a.copy(a.from+i,a.to+i))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<t&&this.children[o+1]>e){let a=this.children[o]+1;this.children[o+2].findInner(e-a,t-a,r,i+a,s)}}map(e,t,r){return this==pe||e.maps.length==0?this:this.mapInner(e,t,0,0,r||Gt)}mapInner(e,t,r,i,s){let o;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(e,r,i);l&&l.type.valid(t,l)?(o||(o=[])).push(l):s.onRemove&&s.onRemove(this.local[a].spec)}return this.children.length?ch(this.children,o||[],e,t,r,i,s):o?new te(o.sort(Yt),mn):pe}add(e,t){return t.length?this==pe?te.create(e,t):this.addInner(e,t,0):this}addInner(e,t,r){let i,s=0;e.forEach((a,l)=>{let c=l+r,u;if(!!(u=Tu(t,a,c))){for(i||(i=this.children.slice());s<i.length&&i[s]<l;)s+=3;i[s]==l?i[s+2]=i[s+2].addInner(a,u,c+1):i.splice(s,0,l,l+a.nodeSize,ai(u,a,c+1,Gt)),s+=3}});let o=Mu(s?Fu(t):t,-r);for(let a=0;a<o.length;a++)o[a].type.valid(e,o[a])||o.splice(a--,1);return new te(o.length?this.local.concat(o).sort(Yt):this.local,i||this.children)}remove(e){return e.length==0||this==pe?this:this.removeInner(e,0)}removeInner(e,t){let r=this.children,i=this.local;for(let s=0;s<r.length;s+=3){let o,a=r[s]+t,l=r[s+1]+t;for(let u=0,d;u<e.length;u++)(d=e[u])&&d.from>a&&d.to<l&&(e[u]=null,(o||(o=[])).push(d));if(!o)continue;r==this.children&&(r=this.children.slice());let c=r[s+2].removeInner(o,a+1);c!=pe?r[s+2]=c:(r.splice(s,3),s-=3)}if(i.length){for(let s=0,o;s<e.length;s++)if(o=e[s])for(let a=0;a<i.length;a++)i[a].eq(o,t)&&(i==this.local&&(i=this.local.slice()),i.splice(a--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new te(i,r):pe}forChild(e,t){if(this==pe)return this;if(t.isLeaf)return te.empty;let r,i;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=e){this.children[a]==e&&(r=this.children[a+2]);break}let s=e+1,o=s+t.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<o&&l.to>s&&l.type instanceof Mt){let c=Math.max(s,l.from)-s,u=Math.min(o,l.to)-s;c<u&&(i||(i=[])).push(l.copy(c,u))}}if(i){let a=new te(i.sort(Yt),mn);return r?new xt([a,r]):a}return r||pe}eq(e){if(this==e)return!0;if(!(e instanceof te)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return po(this.localsInner(e))}localsInner(e){if(this==pe)return mn;if(e.inlineContent||!this.local.some(Mt.is))return this.local;let t=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Mt||t.push(this.local[r]);return t}}te.empty=new te([],[]);te.removeOverlap=po;const pe=te.empty;class xt{constructor(e){this.members=e}map(e,t){const r=this.members.map(i=>i.map(e,t,Gt));return xt.from(r)}forChild(e,t){if(t.isLeaf)return te.empty;let r=[];for(let i=0;i<this.members.length;i++){let s=this.members[i].forChild(e,t);s!=pe&&(s instanceof xt?r=r.concat(s.members):r.push(s))}return xt.from(r)}eq(e){if(!(e instanceof xt)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,r=!0;for(let i=0;i<this.members.length;i++){let s=this.members[i].localsInner(e);if(!!s.length)if(!t)t=s;else{r&&(t=t.slice(),r=!1);for(let o=0;o<s.length;o++)t.push(s[o])}}return t?po(r?t:t.sort(Yt)):mn}static from(e){switch(e.length){case 0:return pe;case 1:return e[0];default:return new xt(e.every(t=>t instanceof te)?e:e.reduce((t,r)=>t.concat(r instanceof te?r:r.members),[]))}}}function ch(n,e,t,r,i,s,o){let a=n.slice();for(let c=0,u=s;c<t.maps.length;c++){let d=0;t.maps[c].forEach((f,h,p,m)=>{let y=m-p-(h-f);for(let v=0;v<a.length;v+=3){let b=a[v+1];if(b<0||f>b+u-d)continue;let E=a[v]+u-d;h>=E?a[v+1]=f<=E?-2:-1:p>=i&&y&&(a[v]+=y,a[v+1]+=y)}d+=y}),u=t.maps[c].map(u,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(a[c+1]==-2){l=!0,a[c+1]=-1;continue}let u=t.map(n[c]+s),d=u-i;if(d<0||d>=r.content.size){l=!0;continue}let f=t.map(n[c+1]+s,-1),h=f-i,{index:p,offset:m}=r.content.findIndex(d),y=r.maybeChild(p);if(y&&m==d&&m+y.nodeSize==h){let v=a[c+2].mapInner(t,y,u+1,n[c]+s+1,o);v!=pe?(a[c]=d,a[c+1]=h,a[c+2]=v):(a[c+1]=-2,l=!0)}else l=!0}if(l){let c=dh(a,n,e,t,i,s,o),u=ai(c,r,0,o);e=u.local;for(let d=0;d<a.length;d+=3)a[d+1]<0&&(a.splice(d,3),d-=3);for(let d=0,f=0;d<u.children.length;d+=3){let h=u.children[d];for(;f<a.length&&a[f]<h;)f+=3;a.splice(f,0,u.children[d],u.children[d+1],u.children[d+2])}}return new te(e.sort(Yt),a)}function Mu(n,e){if(!e||!n.length)return n;let t=[];for(let r=0;r<n.length;r++){let i=n[r];t.push(new Te(i.from+e,i.to+e,i.type))}return t}function dh(n,e,t,r,i,s,o){function a(l,c){for(let u=0;u<l.local.length;u++){let d=l.local[u].map(r,i,c);d?t.push(d):o.onRemove&&o.onRemove(l.local[u].spec)}for(let u=0;u<l.children.length;u+=3)a(l.children[u+2],l.children[u]+c+1)}for(let l=0;l<n.length;l+=3)n[l+1]==-1&&a(n[l+2],e[l]+s+1);return t}function Tu(n,e,t){if(e.isLeaf)return null;let r=t+e.nodeSize,i=null;for(let s=0,o;s<n.length;s++)(o=n[s])&&o.from>t&&o.to<r&&((i||(i=[])).push(o),n[s]=null);return i}function Fu(n){let e=[];for(let t=0;t<n.length;t++)n[t]!=null&&e.push(n[t]);return e}function ai(n,e,t,r){let i=[],s=!1;e.forEach((a,l)=>{let c=Tu(n,a,l+t);if(c){s=!0;let u=ai(c,a,t+l+1,r);u!=pe&&i.push(l,l+a.nodeSize,u)}});let o=Mu(s?Fu(n):n,-t).sort(Yt);for(let a=0;a<o.length;a++)o[a].type.valid(e,o[a])||(r.onRemove&&r.onRemove(o[a].spec),o.splice(a--,1));return o.length||i.length?new te(o,i):pe}function Yt(n,e){return n.from-e.from||n.to-e.to}function po(n){let e=n;for(let t=0;t<e.length-1;t++){let r=e[t];if(r.from!=r.to)for(let i=t+1;i<e.length;i++){let s=e[i];if(s.from==r.from){s.to!=r.to&&(e==n&&(e=n.slice()),e[i]=s.copy(s.from,r.to),Ea(e,i+1,s.copy(r.to,s.to)));continue}else{s.from<r.to&&(e==n&&(e=n.slice()),e[t]=r.copy(r.from,s.from),Ea(e,i,r.copy(s.from,r.to)));break}}}return e}function Ea(n,e,t){for(;e<n.length&&Yt(t,n[e])>0;)e++;n.splice(e,0,t)}function fs(n){let e=[];return n.someProp("decorations",t=>{let r=t(n.state);r&&r!=pe&&e.push(r)}),n.cursorWrapper&&e.push(te.create(n.state.doc,[n.cursorWrapper.deco])),xt.from(e)}const fh={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},hh=Ee&&Ot<=11;class ph{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class mh{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new ph,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);Ee&&Ot<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),hh&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,fh)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(!!ga(this.view)){if(this.suppressingSelectionUpdates)return pt(this.view);if(Ee&&Ot<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&en(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,r;for(let s=e.focusNode;s;s=br(s))t.add(s);for(let s=e.anchorNode;s;s=br(s))if(t.has(s)){r=s;break}let i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.observer?this.observer.takeRecords():[];this.queue.length&&(t=this.queue.concat(t),this.queue.length=0);let r=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&ga(e)&&!this.ignoreSelectionChange(r),s=-1,o=-1,a=!1,l=[];if(e.editable)for(let u=0;u<t.length;u++){let d=this.registerMutation(t[u],l);d&&(s=s<0?d.from:Math.min(d.from,s),o=o<0?d.to:Math.max(d.to,o),d.typeOver&&(a=!0))}if(Ue&&l.length>1){let u=l.filter(d=>d.nodeName=="BR");if(u.length==2){let d=u[0],f=u[1];d.parentNode&&d.parentNode.parentNode==f.parentNode?f.remove():d.remove()}}let c=null;s<0&&i&&e.input.lastFocus>Date.now()-200&&e.input.lastTouch<Date.now()-300&&Pi(r)&&(c=oo(e))&&c.eq(L.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,pt(e),this.currentSelection.set(r),e.scrollToSelection()):(s>-1||i)&&(s>-1&&(e.docView.markDirty(s,o),gh(e)),this.handleDOMChange(s,o,a,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||pt(e),this.currentSelection.set(r))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let u=0;u<e.addedNodes.length;u++)t.push(e.addedNodes[u]);if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let i=e.previousSibling,s=e.nextSibling;if(Ee&&Ot<=11&&e.addedNodes.length)for(let u=0;u<e.addedNodes.length;u++){let{previousSibling:d,nextSibling:f}=e.addedNodes[u];(!d||Array.prototype.indexOf.call(e.addedNodes,d)<0)&&(i=d),(!f||Array.prototype.indexOf.call(e.addedNodes,f)<0)&&(s=f)}let o=i&&i.parentNode==e.target?Me(i)+1:0,a=r.localPosFromDOM(e.target,o,-1),l=s&&s.parentNode==e.target?Me(s):e.target.childNodes.length,c=r.localPosFromDOM(e.target,l,1);return{from:a,to:c}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}}}let xa=new WeakMap,Sa=!1;function gh(n){if(!xa.has(n)&&(xa.set(n,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(n.dom).whiteSpace)!==-1)){if(n.requiresGeckoHackNode=Ue,Sa)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),Sa=!0}}function yh(n){let e;function t(l){l.preventDefault(),l.stopImmediatePropagation(),e=l.getTargetRanges()[0]}n.dom.addEventListener("beforeinput",t,!0),document.execCommand("indent"),n.dom.removeEventListener("beforeinput",t,!0);let r=e.startContainer,i=e.startOffset,s=e.endContainer,o=e.endOffset,a=n.domAtPos(n.state.selection.anchor);return en(a.node,a.offset,s,o)&&([r,i,s,o]=[s,o,r,i]),{anchorNode:r,anchorOffset:i,focusNode:s,focusOffset:o}}function vh(n,e,t){let{node:r,fromOffset:i,toOffset:s,from:o,to:a}=n.docView.parseRange(e,t),l=n.domSelectionRange(),c,u=l.anchorNode;if(u&&n.dom.contains(u.nodeType==1?u:u.parentNode)&&(c=[{node:u,offset:l.anchorOffset}],Pi(l)||c.push({node:l.focusNode,offset:l.focusOffset})),ke&&n.input.lastKeyCode===8)for(let y=s;y>i;y--){let v=r.childNodes[y-1],b=v.pmViewDesc;if(v.nodeName=="BR"&&!b){s=y;break}if(!b||b.size)break}let d=n.state.doc,f=n.someProp("domParser")||Tn.fromSchema(n.state.schema),h=d.resolve(o),p=null,m=f.parse(r,{topNode:h.parent,topMatch:h.parent.contentMatchAt(h.index()),topOpen:!0,from:i,to:s,preserveWhitespace:h.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:bh,context:h});if(c&&c[0].pos!=null){let y=c[0].pos,v=c[1]&&c[1].pos;v==null&&(v=y),p={anchor:y+o,head:v+o}}return{doc:m,sel:p,from:o,to:a}}function bh(n){let e=n.pmViewDesc;if(e)return e.parseRule();if(n.nodeName=="BR"&&n.parentNode){if(be&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}else if(n.parentNode.lastChild==n||be&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}function Dh(n,e,t,r,i){if(e<0){let S=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,V=oo(n,S);if(V&&!n.state.selection.eq(V)){let $=n.state.tr.setSelection(V);S=="pointer"?$.setMeta("pointer",!0):S=="key"&&$.scrollIntoView(),n.dispatch($)}return}let s=n.state.doc.resolve(e),o=s.sharedDepth(t);e=s.before(o+1),t=n.state.doc.resolve(t).after(o+1);let a=n.state.selection,l=vh(n,e,t),c=n.state.doc,u=c.slice(l.from,l.to),d,f;n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(d=n.state.selection.to,f="end"):(d=n.state.selection.from,f="start"),n.input.lastKeyCode=null;let h=Eh(u.content,l.doc.content,l.from,d,f);if((Bn&&n.input.lastIOSEnter>Date.now()-225||Qe)&&i.some(S=>S.nodeName=="DIV"||S.nodeName=="P"||S.nodeName=="LI")&&(!h||h.endA>=h.endB)&&n.someProp("handleKeyDown",S=>S(n,vn(13,"Enter")))){n.input.lastIOSEnter=0;return}if(!h)if(r&&a instanceof z&&!a.empty&&a.$head.sameParent(a.$anchor)&&!n.composing&&!(l.sel&&l.sel.anchor!=l.sel.head))h={start:a.from,endA:a.to,endB:a.to};else{if(l.sel){let S=Aa(n,n.state.doc,l.sel);S&&!S.eq(n.state.selection)&&n.dispatch(n.state.tr.setSelection(S))}return}if(ke&&n.cursorWrapper&&l.sel&&l.sel.anchor==n.cursorWrapper.deco.from&&l.sel.head==l.sel.anchor){let S=h.endB-h.start;l.sel={anchor:l.sel.anchor+S,head:l.sel.anchor+S}}n.input.domChangeCount++,n.state.selection.from<n.state.selection.to&&h.start==h.endB&&n.state.selection instanceof z&&(h.start>n.state.selection.from&&h.start<=n.state.selection.from+2&&n.state.selection.from>=l.from?h.start=n.state.selection.from:h.endA<n.state.selection.to&&h.endA>=n.state.selection.to-2&&n.state.selection.to<=l.to&&(h.endB+=n.state.selection.to-h.endA,h.endA=n.state.selection.to)),Ee&&Ot<=11&&h.endB==h.start+1&&h.endA==h.start&&h.start>l.from&&l.doc.textBetween(h.start-l.from-1,h.start-l.from+1)=="  "&&(h.start--,h.endA--,h.endB--);let p=l.doc.resolveNoCache(h.start-l.from),m=l.doc.resolveNoCache(h.endB-l.from),y=c.resolve(h.start),v=p.sameParent(m)&&p.parent.inlineContent&&y.end()>=h.endA,b;if((Bn&&n.input.lastIOSEnter>Date.now()-225&&(!v||i.some(S=>S.nodeName=="DIV"||S.nodeName=="P"))||!v&&p.pos<l.doc.content.size&&(b=L.findFrom(l.doc.resolve(p.pos+1),1,!0))&&b.head==m.pos)&&n.someProp("handleKeyDown",S=>S(n,vn(13,"Enter")))){n.input.lastIOSEnter=0;return}if(n.state.selection.anchor>h.start&&kh(c,h.start,h.endA,p,m)&&n.someProp("handleKeyDown",S=>S(n,vn(8,"Backspace")))){Qe&&ke&&n.domObserver.suppressSelectionUpdates();return}ke&&Qe&&h.endB==h.start&&(n.input.lastAndroidDelete=Date.now()),Qe&&!v&&p.start()!=m.start()&&m.parentOffset==0&&p.depth==m.depth&&l.sel&&l.sel.anchor==l.sel.head&&l.sel.head==h.endA&&(h.endB-=2,m=l.doc.resolveNoCache(h.endB-l.from),setTimeout(()=>{n.someProp("handleKeyDown",function(S){return S(n,vn(13,"Enter"))})},20));let E=h.start,g=h.endA,A,C,T;if(v){if(p.pos==m.pos)Ee&&Ot<=11&&p.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>pt(n),20)),A=n.state.tr.delete(E,g),C=c.resolve(h.start).marksAcross(c.resolve(h.endA));else if(h.endA==h.endB&&(T=Ch(p.parent.content.cut(p.parentOffset,m.parentOffset),y.parent.content.cut(y.parentOffset,h.endA-y.start()))))A=n.state.tr,T.type=="add"?A.addMark(E,g,T.mark):A.removeMark(E,g,T.mark);else if(p.parent.child(p.index()).isText&&p.index()==m.index()-(m.textOffset?0:1)){let S=p.parent.textBetween(p.parentOffset,m.parentOffset);if(n.someProp("handleTextInput",V=>V(n,E,g,S)))return;A=n.state.tr.insertText(S,E,g)}}if(A||(A=n.state.tr.replace(E,g,l.doc.slice(h.start-l.from,h.endB-l.from))),l.sel){let S=Aa(n,A.doc,l.sel);S&&!(ke&&Qe&&n.composing&&S.empty&&(h.start!=h.endB||n.input.lastAndroidDelete<Date.now()-100)&&(S.head==E||S.head==A.mapping.map(g)-1)||Ee&&S.empty&&S.head==E)&&A.setSelection(S)}C&&A.ensureMarks(C),n.dispatch(A.scrollIntoView())}function Aa(n,e,t){return Math.max(t.anchor,t.head)>e.content.size?null:ao(n,e.resolve(t.anchor),e.resolve(t.head))}function Ch(n,e){let t=n.firstChild.marks,r=e.firstChild.marks,i=t,s=r,o,a,l;for(let u=0;u<r.length;u++)i=r[u].removeFromSet(i);for(let u=0;u<t.length;u++)s=t[u].removeFromSet(s);if(i.length==1&&s.length==0)a=i[0],o="add",l=u=>u.mark(a.addToSet(u.marks));else if(i.length==0&&s.length==1)a=s[0],o="remove",l=u=>u.mark(a.removeFromSet(u.marks));else return null;let c=[];for(let u=0;u<e.childCount;u++)c.push(l(e.child(u)));if(k.from(c).eq(n))return{mark:a,type:o}}function kh(n,e,t,r,i){if(!r.parent.isTextblock||t-e<=i.pos-r.pos||hs(r,!0,!1)<i.pos)return!1;let s=n.resolve(e);if(s.parentOffset<s.parent.content.size||!s.parent.isTextblock)return!1;let o=n.resolve(hs(s,!0,!0));return!o.parent.isTextblock||o.pos>t||hs(o,!0,!1)<t?!1:r.parent.content.cut(r.parentOffset).eq(o.parent.content)}function hs(n,e,t){let r=n.depth,i=e?n.end():n.pos;for(;r>0&&(e||n.indexAfter(r)==n.node(r).childCount);)r--,i++,e=!1;if(t){let s=n.node(r).maybeChild(n.indexAfter(r));for(;s&&!s.isLeaf;)s=s.firstChild,i++}return i}function Eh(n,e,t,r,i){let s=n.findDiffStart(e,t);if(s==null)return null;let{a:o,b:a}=n.findDiffEnd(e,t+n.size,t+e.size);if(i=="end"){let l=Math.max(0,s-Math.min(o,a));r-=o+l-s}if(o<s&&n.size<e.size){let l=r<=s&&r>=o?s-r:0;s-=l,a=s+(a-o),o=s}else if(a<s){let l=r<=s&&r>=a?s-r:0;s-=l,o=s+(o-a),a=s}return{start:s,endA:o,endB:a}}class xh{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new Kf,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(Fa),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=Ma(this),Oa(this),this.nodeViews=Ta(this),this.docView=ca(this.state.doc,wa(this),fs(this),this.dom,this),this.domObserver=new mh(this,(r,i,s,o)=>Dh(this,r,i,s,o)),this.domObserver.start(),Uf(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&js(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(Fa),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let r in this._props)t[r]=this._props[r];t.state=this.state;for(let r in e)t[r]=e[r];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){let r=this.state,i=!1,s=!1;e.storedMarks&&this.composing&&(wu(this),s=!0),this.state=e;let o=r.plugins!=e.plugins||this._props.plugins!=t.plugins;if(o||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let f=Ta(this);Ah(f,this.nodeViews)&&(this.nodeViews=f,i=!0)}(o||t.handleDOMEvents!=this._props.handleDOMEvents)&&js(this),this.editable=Ma(this),Oa(this);let a=fs(this),l=wa(this),c=r.plugins!=e.plugins&&!r.doc.eq(e.doc)?"reset":e.scrollToSelection>r.scrollToSelection?"to selection":"preserve",u=i||!this.docView.matchesNode(e.doc,l,a);(u||!e.selection.eq(r.selection))&&(s=!0);let d=c=="preserve"&&s&&this.dom.style.overflowAnchor==null&&cf(this);if(s){this.domObserver.stop();let f=u&&(Ee||ke)&&!this.composing&&!r.selection.empty&&!e.selection.empty&&Sh(r.selection,e.selection);if(u){let h=ke?this.trackWrites=this.domSelectionRange().focusNode:null;(i||!this.docView.update(e.doc,l,a,this))&&(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=ca(e.doc,l,a,this.dom,this)),h&&!this.trackWrites&&(f=!0)}f||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&If(this))?pt(this,f):(pu(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(r),c=="reset"?this.dom.scrollTop=0:c=="to selection"?this.scrollToSelection():d&&df(d)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!this.someProp("handleScrollToSelection",t=>t(this)))if(this.state.selection instanceof R){let t=this.docView.domAfterPos(this.state.selection.from);t.nodeType==1&&sa(this,t.getBoundingClientRect(),e)}else sa(this,this.coordsAtPos(this.state.selection.head,1),e)}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let t=0;t<this.directPlugins.length;t++){let r=this.directPlugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let t=0;t<this.state.plugins.length;t++){let r=this.state.plugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let t=0;t<this.pluginViews.length;t++){let r=this.pluginViews[t];r.update&&r.update(this,e)}}someProp(e,t){let r=this._props&&this._props[e],i;if(r!=null&&(i=t?t(r):r))return i;for(let o=0;o<this.directPlugins.length;o++){let a=this.directPlugins[o].props[e];if(a!=null&&(i=t?t(a):a))return i}let s=this.state.plugins;if(s)for(let o=0;o<s.length;o++){let a=s[o].props[e];if(a!=null&&(i=t?t(a):a))return i}}hasFocus(){if(Ee){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&ff(this.dom),pt(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let t=this.dom.parentNode;t;t=t.parentNode)if(t.nodeType==9||t.nodeType==11&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t}return e||document}posAtCoords(e){return yf(this,e)}coordsAtPos(e,t=1){return ou(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,r=-1){let i=this.docView.posFromDOM(e,t,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,t){return kf(this,t||this.state,e)}destroy(){!this.docView||(qf(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],fs(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)}get isDestroyed(){return this.docView==null}dispatchEvent(e){return Gf(this,e)}dispatch(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){return be&&this.root.nodeType===11&&sf(this.dom.ownerDocument)==this.dom?yh(this):this.domSelection()}domSelection(){return this.root.getSelection()}}function wa(n){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(n.editable),e.translate="no",n.someProp("attributes",t=>{if(typeof t=="function"&&(t=t(n.state)),t)for(let r in t)r=="class"&&(e.class+=" "+t[r]),r=="style"?e.style=(e.style?e.style+";":"")+t[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(t[r]))}),[Te.node(0,n.state.doc.content.size,e)]}function Oa(n){if(n.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),n.cursorWrapper={dom:e,deco:Te.widget(n.state.selection.head,e,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function Ma(n){return!n.someProp("editable",e=>e(n.state)===!1)}function Sh(n,e){let t=Math.min(n.$anchor.sharedDepth(n.head),e.$anchor.sharedDepth(e.head));return n.$anchor.start(t)!=e.$anchor.start(t)}function Ta(n){let e=Object.create(null);function t(r){for(let i in r)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=r[i])}return n.someProp("nodeViews",t),n.someProp("markViews",t),e}function Ah(n,e){let t=0,r=0;for(let i in n){if(n[i]!=e[i])return!0;t++}for(let i in e)r++;return t!=r}function Fa(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var Nt={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},li={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Na=typeof navigator<"u"&&/Chrome\/(\d+)/.exec(navigator.userAgent),wh=typeof navigator<"u"&&/Mac/.test(navigator.platform),Oh=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Mh=wh||Na&&+Na[1]<57;for(var de=0;de<10;de++)Nt[48+de]=Nt[96+de]=String(de);for(var de=1;de<=24;de++)Nt[de+111]="F"+de;for(var de=65;de<=90;de++)Nt[de]=String.fromCharCode(de+32),li[de]=String.fromCharCode(de);for(var ps in Nt)li.hasOwnProperty(ps)||(li[ps]=Nt[ps]);function Th(n){var e=Mh&&(n.ctrlKey||n.altKey||n.metaKey)||Oh&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?li:Nt)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}const Fh=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function Nh(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let r,i,s,o;for(let a=0;a<e.length-1;a++){let l=e[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))s=!0;else if(/^mod$/i.test(l))Fh?o=!0:i=!0;else throw new Error("Unrecognized modifier name: "+l)}return r&&(t="Alt-"+t),i&&(t="Ctrl-"+t),o&&(t="Meta-"+t),s&&(t="Shift-"+t),t}function Bh(n){let e=Object.create(null);for(let t in n)e[Nh(t)]=n[t];return e}function ms(n,e,t){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t!==!1&&e.shiftKey&&(n="Shift-"+n),n}function Rh(n){return new ue({props:{handleKeyDown:Nu(n)}})}function Nu(n){let e=Bh(n);return function(t,r){let i=Th(r),s=i.length==1&&i!=" ",o,a=e[ms(i,r,!s)];if(a&&a(t.state,t.dispatch,t))return!0;if(s&&(r.shiftKey||r.altKey||r.metaKey||i.charCodeAt(0)>127)&&(o=Nt[r.keyCode])&&o!=i){let l=e[ms(o,r,!0)];if(l&&l(t.state,t.dispatch,t))return!0}else if(s&&r.shiftKey){let l=e[ms(i,r,!0)];if(l&&l(t.state,t.dispatch,t))return!0}return!1}}const Ih=(n,e)=>n.selection.empty?!1:(e&&e(n.tr.deleteSelection().scrollIntoView()),!0);function Ph(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("backward",n):t.parentOffset>0)?null:t}const Lh=(n,e,t)=>{let r=Ph(n,t);if(!r)return!1;let i=Bu(r);if(!i){let o=r.blockRange(),a=o&&jn(o);return a==null?!1:(e&&e(n.tr.lift(o,a).scrollIntoView()),!0)}let s=i.nodeBefore;if(!s.type.spec.isolating&&Pu(n,i,e))return!0;if(r.parent.content.size==0&&(In(s,"end")||R.isSelectable(s))){let o=ro(n.doc,r.before(),r.after(),w.empty);if(o&&o.slice.size<o.to-o.from){if(e){let a=n.tr.step(o);a.setSelection(In(s,"end")?L.findFrom(a.doc.resolve(a.mapping.map(i.pos,-1)),-1):R.create(a.doc,i.pos-s.nodeSize)),e(a.scrollIntoView())}return!0}}return s.isAtom&&i.depth==r.depth-1?(e&&e(n.tr.delete(i.pos-s.nodeSize,i.pos).scrollIntoView()),!0):!1};function In(n,e,t=!1){for(let r=n;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(t&&r.childCount!=1)return!1}return!1}const zh=(n,e,t)=>{let{$head:r,empty:i}=n.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("backward",n):r.parentOffset>0)return!1;s=Bu(r)}let o=s&&s.nodeBefore;return!o||!R.isSelectable(o)?!1:(e&&e(n.tr.setSelection(R.create(n.doc,s.pos-o.nodeSize)).scrollIntoView()),!0)};function Bu(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){if(n.index(e)>0)return n.doc.resolve(n.before(e+1));if(n.node(e).type.spec.isolating)break}return null}function Vh(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("forward",n):t.parentOffset<t.parent.content.size)?null:t}const Hh=(n,e,t)=>{let r=Vh(n,t);if(!r)return!1;let i=Ru(r);if(!i)return!1;let s=i.nodeAfter;if(Pu(n,i,e))return!0;if(r.parent.content.size==0&&(In(s,"start")||R.isSelectable(s))){let o=ro(n.doc,r.before(),r.after(),w.empty);if(o&&o.slice.size<o.to-o.from){if(e){let a=n.tr.step(o);a.setSelection(In(s,"start")?L.findFrom(a.doc.resolve(a.mapping.map(i.pos)),1):R.create(a.doc,a.mapping.map(i.pos))),e(a.scrollIntoView())}return!0}}return s.isAtom&&i.depth==r.depth-1?(e&&e(n.tr.delete(i.pos,i.pos+s.nodeSize).scrollIntoView()),!0):!1},$h=(n,e,t)=>{let{$head:r,empty:i}=n.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size)return!1;s=Ru(r)}let o=s&&s.nodeAfter;return!o||!R.isSelectable(o)?!1:(e&&e(n.tr.setSelection(R.create(n.doc,s.pos)).scrollIntoView()),!0)};function Ru(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){let t=n.node(e);if(n.index(e)+1<t.childCount)return n.doc.resolve(n.after(e+1));if(t.type.spec.isolating)break}return null}const jh=(n,e)=>{let t=n.selection,r=t instanceof R,i;if(r){if(t.node.isTextblock||!Bt(n.doc,t.from))return!1;i=t.from}else if(i=Ul(n.doc,t.from,-1),i==null)return!1;if(e){let s=n.tr.join(i);r&&s.setSelection(R.create(s.doc,i-n.doc.resolve(i).nodeBefore.nodeSize)),e(s.scrollIntoView())}return!0},_h=(n,e)=>{let t=n.selection,r;if(t instanceof R){if(t.node.isTextblock||!Bt(n.doc,t.to))return!1;r=t.to}else if(r=Ul(n.doc,t.to,1),r==null)return!1;return e&&e(n.tr.join(r).scrollIntoView()),!0},Wh=(n,e)=>{let{$from:t,$to:r}=n.selection,i=t.blockRange(r),s=i&&jn(i);return s==null?!1:(e&&e(n.tr.lift(i,s).scrollIntoView()),!0)},Kh=(n,e)=>{let{$head:t,$anchor:r}=n.selection;return!t.parent.type.spec.code||!t.sameParent(r)?!1:(e&&e(n.tr.insertText(`
`).scrollIntoView()),!0)};function Iu(n){for(let e=0;e<n.edgeCount;e++){let{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const Uh=(n,e)=>{let{$head:t,$anchor:r}=n.selection;if(!t.parent.type.spec.code||!t.sameParent(r))return!1;let i=t.node(-1),s=t.indexAfter(-1),o=Iu(i.contentMatchAt(s));if(!o||!i.canReplaceWith(s,s,o))return!1;if(e){let a=t.after(),l=n.tr.replaceWith(a,a,o.createAndFill());l.setSelection(L.near(l.doc.resolve(a),1)),e(l.scrollIntoView())}return!0},qh=(n,e)=>{let t=n.selection,{$from:r,$to:i}=t;if(t instanceof We||r.parent.inlineContent||i.parent.inlineContent)return!1;let s=Iu(i.parent.contentMatchAt(i.indexAfter()));if(!s||!s.isTextblock)return!1;if(e){let o=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,a=n.tr.insert(o,s.createAndFill());a.setSelection(z.create(a.doc,o+1)),e(a.scrollIntoView())}return!0},Jh=(n,e)=>{let{$cursor:t}=n.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let s=t.before();if(wn(n.doc,s))return e&&e(n.tr.split(s).scrollIntoView()),!0}let r=t.blockRange(),i=r&&jn(r);return i==null?!1:(e&&e(n.tr.lift(r,i).scrollIntoView()),!0)},Gh=(n,e)=>{let{$from:t,to:r}=n.selection,i,s=t.sharedDepth(r);return s==0?!1:(i=t.before(s),e&&e(n.tr.setSelection(R.create(n.doc,i))),!0)};function Yh(n,e,t){let r=e.nodeBefore,i=e.nodeAfter,s=e.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&e.parent.canReplace(s-1,s)?(t&&t(n.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(s,s+1)||!(i.isTextblock||Bt(n.doc,e.pos))?!1:(t&&t(n.tr.clearIncompatible(e.pos,r.type,r.contentMatchAt(r.childCount)).join(e.pos).scrollIntoView()),!0)}function Pu(n,e,t){let r=e.nodeBefore,i=e.nodeAfter,s,o;if(r.type.spec.isolating||i.type.spec.isolating)return!1;if(Yh(n,e,t))return!0;let a=e.parent.canReplace(e.index(),e.index()+1);if(a&&(s=(o=r.contentMatchAt(r.childCount)).findWrapping(i.type))&&o.matchType(s[0]||i.type).validEnd){if(t){let d=e.pos+i.nodeSize,f=k.empty;for(let m=s.length-1;m>=0;m--)f=k.from(s[m].create(null,f));f=k.from(r.copy(f));let h=n.tr.step(new ae(e.pos-1,d,e.pos,d,new w(f,1,0),s.length,!0)),p=d+2*s.length;Bt(h.doc,p)&&h.join(p),t(h.scrollIntoView())}return!0}let l=L.findFrom(e,1),c=l&&l.$from.blockRange(l.$to),u=c&&jn(c);if(u!=null&&u>=e.depth)return t&&t(n.tr.lift(c,u).scrollIntoView()),!0;if(a&&In(i,"start",!0)&&In(r,"end")){let d=r,f=[];for(;f.push(d),!d.isTextblock;)d=d.lastChild;let h=i,p=1;for(;!h.isTextblock;h=h.firstChild)p++;if(d.canReplace(d.childCount,d.childCount,h.content)){if(t){let m=k.empty;for(let v=f.length-1;v>=0;v--)m=k.from(f[v].copy(m));let y=n.tr.step(new ae(e.pos-f.length,e.pos+i.nodeSize,e.pos+p,e.pos+i.nodeSize-p,new w(m,f.length,0),0,!0));t(y.scrollIntoView())}return!0}}return!1}function Lu(n){return function(e,t){let r=e.selection,i=n<0?r.$from:r.$to,s=i.depth;for(;i.node(s).isInline;){if(!s)return!1;s--}return i.node(s).isTextblock?(t&&t(e.tr.setSelection(z.create(e.doc,n<0?i.start(s):i.end(s)))),!0):!1}}const Xh=Lu(-1),Qh=Lu(1);function Zh(n,e=null){return function(t,r){let{$from:i,$to:s}=t.selection,o=i.blockRange(s),a=o&&no(o,n,e);return a?(r&&r(t.tr.wrap(o,a).scrollIntoView()),!0):!1}}function Ba(n,e=null){return function(t,r){let i=!1;for(let s=0;s<t.selection.ranges.length&&!i;s++){let{$from:{pos:o},$to:{pos:a}}=t.selection.ranges[s];t.doc.nodesBetween(o,a,(l,c)=>{if(i)return!1;if(!(!l.isTextblock||l.hasMarkup(n,e)))if(l.type==n)i=!0;else{let u=t.doc.resolve(c),d=u.index();i=u.parent.canReplaceWith(d,d+1,n)}})}if(!i)return!1;if(r){let s=t.tr;for(let o=0;o<t.selection.ranges.length;o++){let{$from:{pos:a},$to:{pos:l}}=t.selection.ranges[o];s.setBlockType(a,l,n,e)}r(s.scrollIntoView())}return!0}}typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function ep(n,e=null){return function(t,r){let{$from:i,$to:s}=t.selection,o=i.blockRange(s),a=!1,l=o;if(!o)return!1;if(o.depth>=2&&i.node(o.depth-1).type.compatibleContent(n)&&o.startIndex==0){if(i.index(o.depth-1)==0)return!1;let u=t.doc.resolve(o.start-2);l=new ti(u,u,o.depth),o.endIndex<o.parent.childCount&&(o=new ti(i,t.doc.resolve(s.end(o.depth)),o.depth)),a=!0}let c=no(l,n,e,o);return c?(r&&r(tp(t.tr,o,c,a,n).scrollIntoView()),!0):!1}}function tp(n,e,t,r,i){let s=k.empty;for(let u=t.length-1;u>=0;u--)s=k.from(t[u].type.create(t[u].attrs,s));n.step(new ae(e.start-(r?2:0),e.end,e.start,e.end,new w(s,0,0),t.length,!0));let o=0;for(let u=0;u<t.length;u++)t[u].type==i&&(o=u+1);let a=t.length-o,l=e.start+t.length-(r?2:0),c=e.parent;for(let u=e.startIndex,d=e.endIndex,f=!0;u<d;u++,f=!1)!f&&wn(n.doc,l,a)&&(n.split(l,a),l+=2*a),l+=c.child(u).nodeSize;return n}function np(n){return function(e,t){let{$from:r,$to:i}=e.selection,s=r.blockRange(i,o=>o.childCount>0&&o.firstChild.type==n);return s?t?r.node(s.depth-1).type==n?rp(e,t,n,s):ip(e,t,s):!0:!1}}function rp(n,e,t,r){let i=n.tr,s=r.end,o=r.$to.end(r.depth);s<o&&(i.step(new ae(s-1,o,s,o,new w(k.from(t.create(null,r.parent.copy())),1,0),1,!0)),r=new ti(i.doc.resolve(r.$from.pos),i.doc.resolve(o),r.depth));const a=jn(r);if(a==null)return!1;i.lift(r,a);let l=i.mapping.map(s,-1)-1;return Bt(i.doc,l)&&i.join(l),e(i.scrollIntoView()),!0}function ip(n,e,t){let r=n.tr,i=t.parent;for(let h=t.end,p=t.endIndex-1,m=t.startIndex;p>m;p--)h-=i.child(p).nodeSize,r.delete(h-1,h+1);let s=r.doc.resolve(t.start),o=s.nodeAfter;if(r.mapping.map(t.end)!=t.start+s.nodeAfter.nodeSize)return!1;let a=t.startIndex==0,l=t.endIndex==i.childCount,c=s.node(-1),u=s.index(-1);if(!c.canReplace(u+(a?0:1),u+1,o.content.append(l?k.empty:k.from(i))))return!1;let d=s.pos,f=d+o.nodeSize;return r.step(new ae(d-(a?1:0),f+(l?1:0),d+1,f-1,new w((a?k.empty:k.from(i.copy(k.empty))).append(l?k.empty:k.from(i.copy(k.empty))),a?0:1,l?0:1),a?0:1)),e(r.scrollIntoView()),!0}function sp(n){return function(e,t){let{$from:r,$to:i}=e.selection,s=r.blockRange(i,c=>c.childCount>0&&c.firstChild.type==n);if(!s)return!1;let o=s.startIndex;if(o==0)return!1;let a=s.parent,l=a.child(o-1);if(l.type!=n)return!1;if(t){let c=l.lastChild&&l.lastChild.type==a.type,u=k.from(c?n.create():null),d=new w(k.from(n.create(null,k.from(a.type.create(null,u)))),c?3:1,0),f=s.start,h=s.end;t(e.tr.step(new ae(f-(c?3:1),h,f,h,d,1,!0)).scrollIntoView())}return!0}}function Hi(n){const{state:e,transaction:t}=n;let{selection:r}=t,{doc:i}=t,{storedMarks:s}=t;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),filterTransaction:e.filterTransaction,plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return s},get selection(){return r},get doc(){return i},get tr(){return r=t.selection,i=t.doc,s=t.storedMarks,t}}}class $i{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:r}=this,{view:i}=t,{tr:s}=r,o=this.buildProps(s);return Object.fromEntries(Object.entries(e).map(([a,l])=>[a,(...u)=>{const d=l(...u)(o);return!s.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(s),d}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:r,editor:i,state:s}=this,{view:o}=i,a=[],l=!!e,c=e||s.tr,u=()=>(!l&&t&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(c),a.every(f=>f===!0)),d={...Object.fromEntries(Object.entries(r).map(([f,h])=>[f,(...m)=>{const y=this.buildProps(c,t),v=h(...m)(y);return a.push(v),d}])),run:u};return d}createCan(e){const{rawCommands:t,state:r}=this,i=!1,s=e||r.tr,o=this.buildProps(s,i);return{...Object.fromEntries(Object.entries(t).map(([l,c])=>[l,(...u)=>c(...u)({...o,dispatch:void 0})])),chain:()=>this.createChain(s,i)}}buildProps(e,t=!0){const{rawCommands:r,editor:i,state:s}=this,{view:o}=i;s.storedMarks&&e.setStoredMarks(s.storedMarks);const a={tr:e,editor:i,view:o,state:Hi({state:s,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([l,c])=>[l,(...u)=>c(...u)(a)]))}};return a}}class op{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){const r=this.callbacks[e];return r&&r.forEach(i=>i.apply(this,t)),this}off(e,t){const r=this.callbacks[e];return r&&(t?this.callbacks[e]=r.filter(i=>i!==t):delete this.callbacks[e]),this}removeAllListeners(){this.callbacks={}}}function O(n,e,t){return n.config[e]===void 0&&n.parent?O(n.parent,e,t):typeof n.config[e]=="function"?n.config[e].bind({...t,parent:n.parent?O(n.parent,e,t):null}):n.config[e]}function ji(n){const e=n.filter(i=>i.type==="extension"),t=n.filter(i=>i.type==="node"),r=n.filter(i=>i.type==="mark");return{baseExtensions:e,nodeExtensions:t,markExtensions:r}}function zu(n){const e=[],{nodeExtensions:t,markExtensions:r}=ji(n),i=[...t,...r],s={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return n.forEach(o=>{const a={name:o.name,options:o.options,storage:o.storage},l=O(o,"addGlobalAttributes",a);if(!l)return;l().forEach(u=>{u.types.forEach(d=>{Object.entries(u.attributes).forEach(([f,h])=>{e.push({type:d,name:f,attribute:{...s,...h}})})})})}),i.forEach(o=>{const a={name:o.name,options:o.options,storage:o.storage},l=O(o,"addAttributes",a);if(!l)return;const c=l();Object.entries(c).forEach(([u,d])=>{const f={...s,...d};(d==null?void 0:d.isRequired)&&(d==null?void 0:d.default)===void 0&&delete f.default,e.push({type:o.name,name:u,attribute:f})})}),e}function le(n,e){if(typeof n=="string"){if(!e.nodes[n])throw Error(`There is no node type named '${n}'. Maybe you forgot to add the extension?`);return e.nodes[n]}return n}function ge(...n){return n.filter(e=>!!e).reduce((e,t)=>{const r={...e};return Object.entries(t).forEach(([i,s])=>{if(!r[i]){r[i]=s;return}i==="class"?r[i]=[r[i],s].join(" "):i==="style"?r[i]=[r[i],s].join("; "):r[i]=s}),r},{})}function Ws(n,e){return e.filter(t=>t.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(n.attrs)||{}:{[t.name]:n.attrs[t.name]}).reduce((t,r)=>ge(t,r),{})}function Vu(n){return typeof n=="function"}function P(n,e=void 0,...t){return Vu(n)?e?n.bind(e)(...t):n(...t):n}function ap(n={}){return Object.keys(n).length===0&&n.constructor===Object}function lp(n){return typeof n!="string"?n:n.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(n):n==="true"?!0:n==="false"?!1:n}function Ra(n,e){return n.style?n:{...n,getAttrs:t=>{const r=n.getAttrs?n.getAttrs(t):n.attrs;if(r===!1)return!1;const i=e.reduce((s,o)=>{const a=o.attribute.parseHTML?o.attribute.parseHTML(t):lp(t.getAttribute(o.name));return a==null?s:{...s,[o.name]:a}},{});return{...r,...i}}}}function Ia(n){return Object.fromEntries(Object.entries(n).filter(([e,t])=>e==="attrs"&&ap(t)?!1:t!=null))}function up(n){var e;const t=zu(n),{nodeExtensions:r,markExtensions:i}=ji(n),s=(e=r.find(l=>O(l,"topNode")))===null||e===void 0?void 0:e.name,o=Object.fromEntries(r.map(l=>{const c=t.filter(y=>y.type===l.name),u={name:l.name,options:l.options,storage:l.storage},d=n.reduce((y,v)=>{const b=O(v,"extendNodeSchema",u);return{...y,...b?b(l):{}}},{}),f=Ia({...d,content:P(O(l,"content",u)),marks:P(O(l,"marks",u)),group:P(O(l,"group",u)),inline:P(O(l,"inline",u)),atom:P(O(l,"atom",u)),selectable:P(O(l,"selectable",u)),draggable:P(O(l,"draggable",u)),code:P(O(l,"code",u)),defining:P(O(l,"defining",u)),isolating:P(O(l,"isolating",u)),attrs:Object.fromEntries(c.map(y=>{var v;return[y.name,{default:(v=y==null?void 0:y.attribute)===null||v===void 0?void 0:v.default}]}))}),h=P(O(l,"parseHTML",u));h&&(f.parseDOM=h.map(y=>Ra(y,c)));const p=O(l,"renderHTML",u);p&&(f.toDOM=y=>p({node:y,HTMLAttributes:Ws(y,c)}));const m=O(l,"renderText",u);return m&&(f.toText=m),[l.name,f]})),a=Object.fromEntries(i.map(l=>{const c=t.filter(m=>m.type===l.name),u={name:l.name,options:l.options,storage:l.storage},d=n.reduce((m,y)=>{const v=O(y,"extendMarkSchema",u);return{...m,...v?v(l):{}}},{}),f=Ia({...d,inclusive:P(O(l,"inclusive",u)),excludes:P(O(l,"excludes",u)),group:P(O(l,"group",u)),spanning:P(O(l,"spanning",u)),code:P(O(l,"code",u)),attrs:Object.fromEntries(c.map(m=>{var y;return[m.name,{default:(y=m==null?void 0:m.attribute)===null||y===void 0?void 0:y.default}]}))}),h=P(O(l,"parseHTML",u));h&&(f.parseDOM=h.map(m=>Ra(m,c)));const p=O(l,"renderHTML",u);return p&&(f.toDOM=m=>p({mark:m,HTMLAttributes:Ws(m,c)})),[l.name,f]}));return new kd({topNode:s,nodes:o,marks:a})}function gs(n,e){return e.nodes[n]||e.marks[n]||null}function Pa(n,e){return Array.isArray(e)?e.some(t=>(typeof t=="string"?t:t.name)===n.name):e}const cp=(n,e=500)=>{let t="";const r=n.parentOffset;return n.parent.nodesBetween(Math.max(0,r-e),r,(i,s,o,a)=>{var l,c;const u=((c=(l=i.type.spec).toText)===null||c===void 0?void 0:c.call(l,{node:i,pos:s,parent:o,index:a}))||i.textContent||"%leaf%";t+=u.slice(0,Math.max(0,r-s))}),t};function mo(n){return Object.prototype.toString.call(n)==="[object RegExp]"}class _i{constructor(e){this.find=e.find,this.handler=e.handler}}const dp=(n,e)=>{if(mo(e))return e.exec(n);const t=e(n);if(!t)return null;const r=[];return r.push(t.text),r.index=t.index,r.input=n,r.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(t.replaceWith)),r};function ys(n){var e;const{editor:t,from:r,to:i,text:s,rules:o,plugin:a}=n,{view:l}=t;if(l.composing)return!1;const c=l.state.doc.resolve(r);if(c.parent.type.spec.code||!!(!((e=c.nodeBefore||c.nodeAfter)===null||e===void 0)&&e.marks.find(f=>f.type.spec.code)))return!1;let u=!1;const d=cp(c)+s;return o.forEach(f=>{if(u)return;const h=dp(d,f.find);if(!h)return;const p=l.state.tr,m=Hi({state:l.state,transaction:p}),y={from:r-(h[0].length-s.length),to:i},{commands:v,chain:b,can:E}=new $i({editor:t,state:m});f.handler({state:m,range:y,match:h,commands:v,chain:b,can:E})===null||!p.steps.length||(p.setMeta(a,{transform:p,from:r,to:i,text:s}),l.dispatch(p),u=!0)}),u}function fp(n){const{editor:e,rules:t}=n,r=new ue({state:{init(){return null},apply(i,s){const o=i.getMeta(r);return o||(i.selectionSet||i.docChanged?null:s)}},props:{handleTextInput(i,s,o,a){return ys({editor:e,from:s,to:o,text:a,rules:t,plugin:r})},handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:s}=i.state.selection;s&&ys({editor:e,from:s.pos,to:s.pos,text:"",rules:t,plugin:r})}),!1)},handleKeyDown(i,s){if(s.key!=="Enter")return!1;const{$cursor:o}=i.state.selection;return o?ys({editor:e,from:o.pos,to:o.pos,text:`
`,rules:t,plugin:r}):!1}},isInputRules:!0});return r}function hp(n){return typeof n=="number"}class pp{constructor(e){this.find=e.find,this.handler=e.handler}}const mp=(n,e)=>{if(mo(e))return[...n.matchAll(e)];const t=e(n);return t?t.map(r=>{const i=[];return i.push(r.text),i.index=r.index,i.input=n,i.data=r.data,r.replaceWith&&(r.text.includes(r.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),i.push(r.replaceWith)),i}):[]};function gp(n){const{editor:e,state:t,from:r,to:i,rule:s}=n,{commands:o,chain:a,can:l}=new $i({editor:e,state:t}),c=[];return t.doc.nodesBetween(r,i,(d,f)=>{if(!d.isTextblock||d.type.spec.code)return;const h=Math.max(r,f),p=Math.min(i,f+d.content.size),m=d.textBetween(h-f,p-f,void 0,"￼");mp(m,s.find).forEach(v=>{if(v.index===void 0)return;const b=h+v.index+1,E=b+v[0].length,g={from:t.tr.mapping.map(b),to:t.tr.mapping.map(E)},A=s.handler({state:t,range:g,match:v,commands:o,chain:a,can:l});c.push(A)})}),c.every(d=>d!==null)}function yp(n){const{editor:e,rules:t}=n;let r=null,i=!1,s=!1;return t.map(a=>new ue({view(l){const c=u=>{var d;r=!((d=l.dom.parentElement)===null||d===void 0)&&d.contains(u.target)?l.dom.parentElement:null};return window.addEventListener("dragstart",c),{destroy(){window.removeEventListener("dragstart",c)}}},props:{handleDOMEvents:{drop:l=>(s=r===l.dom.parentElement,!1),paste:(l,c)=>{var u;const d=(u=c.clipboardData)===null||u===void 0?void 0:u.getData("text/html");return i=!!(d!=null&&d.includes("data-pm-slice")),!1}}},appendTransaction:(l,c,u)=>{const d=l[0],f=d.getMeta("uiEvent")==="paste"&&!i,h=d.getMeta("uiEvent")==="drop"&&!s;if(!f&&!h)return;const p=c.doc.content.findDiffStart(u.doc.content),m=c.doc.content.findDiffEnd(u.doc.content);if(!hp(p)||!m||p===m.b)return;const y=u.tr,v=Hi({state:u,transaction:y});if(!(!gp({editor:e,state:v,from:Math.max(p-1,0),to:m.b-1,rule:a})||!y.steps.length))return y}}))}function vp(n){const e=n.filter((t,r)=>n.indexOf(t)!==r);return[...new Set(e)]}class Dn{constructor(e,t){this.splittableMarks=[],this.editor=t,this.extensions=Dn.resolve(e),this.schema=up(this.extensions),this.extensions.forEach(r=>{var i;this.editor.extensionStorage[r.name]=r.storage;const s={name:r.name,options:r.options,storage:r.storage,editor:this.editor,type:gs(r.name,this.schema)};r.type==="mark"&&((i=P(O(r,"keepOnSplit",s)))!==null&&i!==void 0?i:!0)&&this.splittableMarks.push(r.name);const o=O(r,"onBeforeCreate",s);o&&this.editor.on("beforeCreate",o);const a=O(r,"onCreate",s);a&&this.editor.on("create",a);const l=O(r,"onUpdate",s);l&&this.editor.on("update",l);const c=O(r,"onSelectionUpdate",s);c&&this.editor.on("selectionUpdate",c);const u=O(r,"onTransaction",s);u&&this.editor.on("transaction",u);const d=O(r,"onFocus",s);d&&this.editor.on("focus",d);const f=O(r,"onBlur",s);f&&this.editor.on("blur",f);const h=O(r,"onDestroy",s);h&&this.editor.on("destroy",h)})}static resolve(e){const t=Dn.sort(Dn.flatten(e)),r=vp(t.map(i=>i.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(i=>`'${i}'`).join(", ")}]. This can lead to issues.`),t}static flatten(e){return e.map(t=>{const r={name:t.name,options:t.options,storage:t.storage},i=O(t,"addExtensions",r);return i?[t,...this.flatten(i())]:t}).flat(10)}static sort(e){return e.sort((r,i)=>{const s=O(r,"priority")||100,o=O(i,"priority")||100;return s>o?-1:s<o?1:0})}get commands(){return this.extensions.reduce((e,t)=>{const r={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:gs(t.name,this.schema)},i=O(t,"addCommands",r);return i?{...e,...i()}:e},{})}get plugins(){const{editor:e}=this,t=Dn.sort([...this.extensions].reverse()),r=[],i=[],s=t.map(o=>{const a={name:o.name,options:o.options,storage:o.storage,editor:e,type:gs(o.name,this.schema)},l=[],c=O(o,"addKeyboardShortcuts",a);let u={};if(o.type==="mark"&&o.config.exitable&&(u.ArrowRight=()=>mt.handleExit({editor:e,mark:o})),c){const m=Object.fromEntries(Object.entries(c()).map(([y,v])=>[y,()=>v({editor:e})]));u={...u,...m}}const d=Rh(u);l.push(d);const f=O(o,"addInputRules",a);Pa(o,e.options.enableInputRules)&&f&&r.push(...f());const h=O(o,"addPasteRules",a);Pa(o,e.options.enablePasteRules)&&h&&i.push(...h());const p=O(o,"addProseMirrorPlugins",a);if(p){const m=p();l.push(...m)}return l}).flat();return[fp({editor:e,rules:r}),...yp({editor:e,rules:i}),...s]}get attributes(){return zu(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=ji(this.extensions);return Object.fromEntries(t.filter(r=>!!O(r,"addNodeView")).map(r=>{const i=this.attributes.filter(l=>l.type===r.name),s={name:r.name,options:r.options,storage:r.storage,editor:e,type:le(r.name,this.schema)},o=O(r,"addNodeView",s);if(!o)return[];const a=(l,c,u,d)=>{const f=Ws(l,i);return o()({editor:e,node:l,getPos:u,decorations:d,HTMLAttributes:f,extension:r})};return[r.name,a]}))}}function bp(n){return Object.prototype.toString.call(n).slice(8,-1)}function vs(n){return bp(n)!=="Object"?!1:n.constructor===Object&&Object.getPrototypeOf(n)===Object.prototype}function Wi(n,e){const t={...n};return vs(n)&&vs(e)&&Object.keys(e).forEach(r=>{vs(e[r])?r in n?t[r]=Wi(n[r],e[r]):Object.assign(t,{[r]:e[r]}):Object.assign(t,{[r]:e[r]})}),t}class ye{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=P(O(this,"addOptions",{name:this.name}))),this.storage=P(O(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new ye(e)}configure(e={}){const t=this.extend();return t.options=Wi(this.options,e),t.storage=P(O(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new ye(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=P(O(t,"addOptions",{name:t.name})),t.storage=P(O(t,"addStorage",{name:t.name,options:t.options})),t}}function Hu(n,e,t){const{from:r,to:i}=e,{blockSeparator:s=`

`,textSerializers:o={}}=t||{};let a="",l=!0;return n.nodesBetween(r,i,(c,u,d,f)=>{var h;const p=o==null?void 0:o[c.type.name];p?(c.isBlock&&!l&&(a+=s,l=!0),d&&(a+=p({node:c,pos:u,parent:d,index:f,range:e}))):c.isText?(a+=(h=c==null?void 0:c.text)===null||h===void 0?void 0:h.slice(Math.max(r,u)-u,i-u),l=!1):c.isBlock&&!l&&(a+=s,l=!0)}),a}function $u(n){return Object.fromEntries(Object.entries(n.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}const Dp=ye.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new ue({key:new Fe("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:n}=this,{state:e,schema:t}=n,{doc:r,selection:i}=e,{ranges:s}=i,o=Math.min(...s.map(u=>u.$from.pos)),a=Math.max(...s.map(u=>u.$to.pos)),l=$u(t);return Hu(r,{from:o,to:a},{textSerializers:l})}}})]}}),Cp=()=>({editor:n,view:e})=>(requestAnimationFrame(()=>{var t;n.isDestroyed||(e.dom.blur(),(t=window==null?void 0:window.getSelection())===null||t===void 0||t.removeAllRanges())}),!0),kp=(n=!1)=>({commands:e})=>e.setContent("",n),Ep=()=>({state:n,tr:e,dispatch:t})=>{const{selection:r}=e,{ranges:i}=r;return t&&i.forEach(({$from:s,$to:o})=>{n.doc.nodesBetween(s.pos,o.pos,(a,l)=>{if(a.type.isText)return;const{doc:c,mapping:u}=e,d=c.resolve(u.map(l)),f=c.resolve(u.map(l+a.nodeSize)),h=d.blockRange(f);if(!h)return;const p=jn(h);if(a.type.isTextblock){const{defaultType:m}=d.parent.contentMatchAt(d.index());e.setNodeMarkup(h.start,m)}(p||p===0)&&e.lift(h,p)})}),!0},xp=n=>e=>n(e),Sp=()=>({state:n,dispatch:e})=>qh(n,e),Ap=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,r=t.$anchor.node();if(r.content.size>0)return!1;const i=n.selection.$anchor;for(let s=i.depth;s>0;s-=1)if(i.node(s).type===r.type){if(e){const a=i.before(s),l=i.after(s);n.delete(a,l).scrollIntoView()}return!0}return!1},wp=n=>({tr:e,state:t,dispatch:r})=>{const i=le(n,t.schema),s=e.selection.$anchor;for(let o=s.depth;o>0;o-=1)if(s.node(o).type===i){if(r){const l=s.before(o),c=s.after(o);e.delete(l,c).scrollIntoView()}return!0}return!1},Op=n=>({tr:e,dispatch:t})=>{const{from:r,to:i}=n;return t&&e.delete(r,i),!0},Mp=()=>({state:n,dispatch:e})=>Ih(n,e),Tp=()=>({commands:n})=>n.keyboardShortcut("Enter"),Fp=()=>({state:n,dispatch:e})=>Uh(n,e);function ui(n,e,t={strict:!0}){const r=Object.keys(e);return r.length?r.every(i=>t.strict?e[i]===n[i]:mo(e[i])?e[i].test(n[i]):e[i]===n[i]):!0}function Ks(n,e,t={}){return n.find(r=>r.type===e&&ui(r.attrs,t))}function Np(n,e,t={}){return!!Ks(n,e,t)}function go(n,e,t={}){if(!n||!e)return;let r=n.parent.childAfter(n.parentOffset);if(n.parentOffset===r.offset&&r.offset!==0&&(r=n.parent.childBefore(n.parentOffset)),!r.node)return;const i=Ks([...r.node.marks],e,t);if(!i)return;let s=r.index,o=n.start()+r.offset,a=s+1,l=o+r.node.nodeSize;for(Ks([...r.node.marks],e,t);s>0&&i.isInSet(n.parent.child(s-1).marks);)s-=1,o-=n.parent.child(s).nodeSize;for(;a<n.parent.childCount&&Np([...n.parent.child(a).marks],e,t);)l+=n.parent.child(a).nodeSize,a+=1;return{from:o,to:l}}function It(n,e){if(typeof n=="string"){if(!e.marks[n])throw Error(`There is no mark type named '${n}'. Maybe you forgot to add the extension?`);return e.marks[n]}return n}const Bp=(n,e={})=>({tr:t,state:r,dispatch:i})=>{const s=It(n,r.schema),{doc:o,selection:a}=t,{$from:l,from:c,to:u}=a;if(i){const d=go(l,s,e);if(d&&d.from<=c&&d.to>=u){const f=z.create(o,d.from,d.to);t.setSelection(f)}}return!0},Rp=n=>e=>{const t=typeof n=="function"?n(e):n;for(let r=0;r<t.length;r+=1)if(t[r](e))return!0;return!1};function yo(n){return n instanceof z}function ft(n=0,e=0,t=0){return Math.min(Math.max(n,e),t)}function ju(n,e=null){if(!e)return null;const t=L.atStart(n),r=L.atEnd(n);if(e==="start"||e===!0)return t;if(e==="end")return r;const i=t.from,s=r.to;return e==="all"?z.create(n,ft(0,i,s),ft(n.content.size,i,s)):z.create(n,ft(e,i,s),ft(e,i,s))}function vo(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const Ip=(n=null,e={})=>({editor:t,view:r,tr:i,dispatch:s})=>{e={scrollIntoView:!0,...e};const o=()=>{vo()&&r.dom.focus(),requestAnimationFrame(()=>{t.isDestroyed||(r.focus(),e!=null&&e.scrollIntoView&&t.commands.scrollIntoView())})};if(r.hasFocus()&&n===null||n===!1)return!0;if(s&&n===null&&!yo(t.state.selection))return o(),!0;const a=ju(i.doc,n)||t.state.selection,l=t.state.selection.eq(a);return s&&(l||i.setSelection(a),l&&i.storedMarks&&i.setStoredMarks(i.storedMarks),o()),!0},Pp=(n,e)=>t=>n.every((r,i)=>e(r,{...t,index:i})),Lp=(n,e)=>({tr:t,commands:r})=>r.insertContentAt({from:t.selection.from,to:t.selection.to},n,e);function La(n){const e=`<body>${n}</body>`;return new window.DOMParser().parseFromString(e,"text/html").body}function ci(n,e,t){if(t={slice:!0,parseOptions:{},...t},typeof n=="object"&&n!==null)try{return Array.isArray(n)?k.fromArray(n.map(r=>e.nodeFromJSON(r))):e.nodeFromJSON(n)}catch(r){return console.warn("[tiptap warn]: Invalid content.","Passed value:",n,"Error:",r),ci("",e,t)}if(typeof n=="string"){const r=Tn.fromSchema(e);return t.slice?r.parseSlice(La(n),t.parseOptions).content:r.parse(La(n),t.parseOptions)}return ci("",e,t)}function zp(n,e,t){const r=n.steps.length-1;if(r<e)return;const i=n.steps[r];if(!(i instanceof me||i instanceof ae))return;const s=n.mapping.maps[r];let o=0;s.forEach((a,l,c,u)=>{o===0&&(o=u)}),n.setSelection(L.near(n.doc.resolve(o),t))}const Vp=n=>n.toString().startsWith("<"),Hp=(n,e,t)=>({tr:r,dispatch:i,editor:s})=>{if(i){t={parseOptions:{},updateSelection:!0,...t};const o=ci(e,s.schema,{parseOptions:{preserveWhitespace:"full",...t.parseOptions}});if(o.toString()==="<>")return!0;let{from:a,to:l}=typeof n=="number"?{from:n,to:n}:n,c=!0,u=!0;if((Vp(o)?o:[o]).forEach(f=>{f.check(),c=c?f.isText&&f.marks.length===0:!1,u=u?f.isBlock:!1}),a===l&&u){const{parent:f}=r.doc.resolve(a);f.isTextblock&&!f.type.spec.code&&!f.childCount&&(a-=1,l+=1)}c?r.insertText(e,a,l):r.replaceWith(a,l,o),t.updateSelection&&zp(r,r.steps.length-1,-1)}return!0},$p=()=>({state:n,dispatch:e})=>jh(n,e),jp=()=>({state:n,dispatch:e})=>_h(n,e),_p=()=>({state:n,dispatch:e})=>Lh(n,e),Wp=()=>({state:n,dispatch:e})=>Hh(n,e);function _u(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function Kp(n){const e=n.split(/-(?!$)/);let t=e[e.length-1];t==="Space"&&(t=" ");let r,i,s,o;for(let a=0;a<e.length-1;a+=1){const l=e[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))s=!0;else if(/^mod$/i.test(l))vo()||_u()?o=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return r&&(t=`Alt-${t}`),i&&(t=`Ctrl-${t}`),o&&(t=`Meta-${t}`),s&&(t=`Shift-${t}`),t}const Up=n=>({editor:e,view:t,tr:r,dispatch:i})=>{const s=Kp(n).split(/-(?!$)/),o=s.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:s.includes("Alt"),ctrlKey:s.includes("Ctrl"),metaKey:s.includes("Meta"),shiftKey:s.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{t.someProp("handleKeyDown",c=>c(t,a))});return l==null||l.steps.forEach(c=>{const u=c.map(r.mapping);u&&i&&r.maybeStep(u)}),!0};function Cr(n,e,t={}){const{from:r,to:i,empty:s}=n.selection,o=e?le(e,n.schema):null,a=[];n.doc.nodesBetween(r,i,(d,f)=>{if(d.isText)return;const h=Math.max(r,f),p=Math.min(i,f+d.nodeSize);a.push({node:d,from:h,to:p})});const l=i-r,c=a.filter(d=>o?o.name===d.node.type.name:!0).filter(d=>ui(d.node.attrs,t,{strict:!1}));return s?!!c.length:c.reduce((d,f)=>d+f.to-f.from,0)>=l}const qp=(n,e={})=>({state:t,dispatch:r})=>{const i=le(n,t.schema);return Cr(t,i,e)?Wh(t,r):!1},Jp=()=>({state:n,dispatch:e})=>Jh(n,e),Gp=n=>({state:e,dispatch:t})=>{const r=le(n,e.schema);return np(r)(e,t)},Yp=()=>({state:n,dispatch:e})=>Kh(n,e);function Ki(n,e){return e.nodes[n]?"node":e.marks[n]?"mark":null}function za(n,e){const t=typeof e=="string"?[e]:e;return Object.keys(n).reduce((r,i)=>(t.includes(i)||(r[i]=n[i]),r),{})}const Xp=(n,e)=>({tr:t,state:r,dispatch:i})=>{let s=null,o=null;const a=Ki(typeof n=="string"?n:n.name,r.schema);return a?(a==="node"&&(s=le(n,r.schema)),a==="mark"&&(o=It(n,r.schema)),i&&t.selection.ranges.forEach(l=>{r.doc.nodesBetween(l.$from.pos,l.$to.pos,(c,u)=>{s&&s===c.type&&t.setNodeMarkup(u,void 0,za(c.attrs,e)),o&&c.marks.length&&c.marks.forEach(d=>{o===d.type&&t.addMark(u,u+c.nodeSize,o.create(za(d.attrs,e)))})})}),!0):!1},Qp=()=>({tr:n,dispatch:e})=>(e&&n.scrollIntoView(),!0),Zp=()=>({tr:n,commands:e})=>e.setTextSelection({from:0,to:n.doc.content.size}),em=()=>({state:n,dispatch:e})=>zh(n,e),tm=()=>({state:n,dispatch:e})=>$h(n,e),nm=()=>({state:n,dispatch:e})=>Gh(n,e),rm=()=>({state:n,dispatch:e})=>Qh(n,e),im=()=>({state:n,dispatch:e})=>Xh(n,e);function Wu(n,e,t={}){return ci(n,e,{slice:!1,parseOptions:t})}const sm=(n,e=!1,t={})=>({tr:r,editor:i,dispatch:s})=>{const{doc:o}=r,a=Wu(n,i.schema,t);return s&&r.replaceWith(0,o.content.size,a).setMeta("preventUpdate",!e),!0};function om(n,e){const t=new Ql(n);return e.forEach(r=>{r.steps.forEach(i=>{t.step(i)})}),t}function am(n){for(let e=0;e<n.edgeCount;e+=1){const{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}function lm(n,e,t){const r=[];return n.nodesBetween(e.from,e.to,(i,s)=>{t(i)&&r.push({node:i,pos:s})}),r}function um(n,e){for(let t=n.depth;t>0;t-=1){const r=n.node(t);if(e(r))return{pos:t>0?n.before(t):0,start:n.start(t),depth:t,node:r}}}function bo(n){return e=>um(e.$from,n)}function cm(n,e){const t=Ze.fromSchema(e).serializeFragment(n),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(t),i.innerHTML}function dm(n,e){const t={from:0,to:n.content.size};return Hu(n,t,e)}function Ku(n,e){const t=It(e,n.schema),{from:r,to:i,empty:s}=n.selection,o=[];s?(n.storedMarks&&o.push(...n.storedMarks),o.push(...n.selection.$head.marks())):n.doc.nodesBetween(r,i,l=>{o.push(...l.marks)});const a=o.find(l=>l.type.name===t.name);return a?{...a.attrs}:{}}function fm(n,e){const t=le(e,n.schema),{from:r,to:i}=n.selection,s=[];n.doc.nodesBetween(r,i,a=>{s.push(a)});const o=s.reverse().find(a=>a.type.name===t.name);return o?{...o.attrs}:{}}function Uu(n,e){const t=Ki(typeof e=="string"?e:e.name,n.schema);return t==="node"?fm(n,e):t==="mark"?Ku(n,e):{}}function hm(n,e=JSON.stringify){const t={};return n.filter(r=>{const i=e(r);return Object.prototype.hasOwnProperty.call(t,i)?!1:t[i]=!0})}function pm(n){const e=hm(n);return e.length===1?e:e.filter((t,r)=>!e.filter((s,o)=>o!==r).some(s=>t.oldRange.from>=s.oldRange.from&&t.oldRange.to<=s.oldRange.to&&t.newRange.from>=s.newRange.from&&t.newRange.to<=s.newRange.to))}function mm(n){const{mapping:e,steps:t}=n,r=[];return e.maps.forEach((i,s)=>{const o=[];if(i.ranges.length)i.forEach((a,l)=>{o.push({from:a,to:l})});else{const{from:a,to:l}=t[s];if(a===void 0||l===void 0)return;o.push({from:a,to:l})}o.forEach(({from:a,to:l})=>{const c=e.slice(s).map(a,-1),u=e.slice(s).map(l),d=e.invert().map(c,-1),f=e.invert().map(u);r.push({oldRange:{from:d,to:f},newRange:{from:c,to:u}})})}),pm(r)}function di(n,e,t){const r=[];return n===e?t.resolve(n).marks().forEach(i=>{const s=t.resolve(n-1),o=go(s,i.type);!o||r.push({mark:i,...o})}):t.nodesBetween(n,e,(i,s)=>{r.push(...i.marks.map(o=>({from:s,to:s+i.nodeSize,mark:o})))}),r}function Us(n,e,t={}){const{empty:r,ranges:i}=n.selection,s=e?It(e,n.schema):null;if(r)return!!(n.storedMarks||n.selection.$from.marks()).filter(d=>s?s.name===d.type.name:!0).find(d=>ui(d.attrs,t,{strict:!1}));let o=0;const a=[];if(i.forEach(({$from:d,$to:f})=>{const h=d.pos,p=f.pos;n.doc.nodesBetween(h,p,(m,y)=>{if(!m.isText&&!m.marks.length)return;const v=Math.max(h,y),b=Math.min(p,y+m.nodeSize),E=b-v;o+=E,a.push(...m.marks.map(g=>({mark:g,from:v,to:b})))})}),o===0)return!1;const l=a.filter(d=>s?s.name===d.mark.type.name:!0).filter(d=>ui(d.mark.attrs,t,{strict:!1})).reduce((d,f)=>d+f.to-f.from,0),c=a.filter(d=>s?d.mark.type!==s&&d.mark.type.excludes(s):!0).reduce((d,f)=>d+f.to-f.from,0);return(l>0?l+c:l)>=o}function gm(n,e,t={}){if(!e)return Cr(n,null,t)||Us(n,null,t);const r=Ki(e,n.schema);return r==="node"?Cr(n,e,t):r==="mark"?Us(n,e,t):!1}function Va(n,e){const{nodeExtensions:t}=ji(e),r=t.find(o=>o.name===n);if(!r)return!1;const i={name:r.name,options:r.options,storage:r.storage},s=P(O(r,"group",i));return typeof s!="string"?!1:s.split(" ").includes("list")}function ym(n){var e;const t=(e=n.type.createAndFill())===null||e===void 0?void 0:e.toJSON(),r=n.toJSON();return JSON.stringify(t)===JSON.stringify(r)}function vm(n){return n instanceof R}function qu(n,e,t){const i=n.state.doc.content.size,s=ft(e,0,i),o=ft(t,0,i),a=n.coordsAtPos(s),l=n.coordsAtPos(o,-1),c=Math.min(a.top,l.top),u=Math.max(a.bottom,l.bottom),d=Math.min(a.left,l.left),f=Math.max(a.right,l.right),h=f-d,p=u-c,v={top:c,bottom:u,left:d,right:f,width:h,height:p,x:d,y:c};return{...v,toJSON:()=>v}}function bm(n,e,t){var r;const{selection:i}=e;let s=null;if(yo(i)&&(s=i.$cursor),s){const a=(r=n.storedMarks)!==null&&r!==void 0?r:s.marks();return!!t.isInSet(a)||!a.some(l=>l.type.excludes(t))}const{ranges:o}=i;return o.some(({$from:a,$to:l})=>{let c=a.depth===0?n.doc.inlineContent&&n.doc.type.allowsMarkType(t):!1;return n.doc.nodesBetween(a.pos,l.pos,(u,d,f)=>{if(c)return!1;if(u.isInline){const h=!f||f.type.allowsMarkType(t),p=!!t.isInSet(u.marks)||!u.marks.some(m=>m.type.excludes(t));c=h&&p}return!c}),c})}const Dm=(n,e={})=>({tr:t,state:r,dispatch:i})=>{const{selection:s}=t,{empty:o,ranges:a}=s,l=It(n,r.schema);if(i)if(o){const c=Ku(r,l);t.addStoredMark(l.create({...c,...e}))}else a.forEach(c=>{const u=c.$from.pos,d=c.$to.pos;r.doc.nodesBetween(u,d,(f,h)=>{const p=Math.max(h,u),m=Math.min(h+f.nodeSize,d);f.marks.find(v=>v.type===l)?f.marks.forEach(v=>{l===v.type&&t.addMark(p,m,l.create({...v.attrs,...e}))}):t.addMark(p,m,l.create(e))})});return bm(r,t,l)},Cm=(n,e)=>({tr:t})=>(t.setMeta(n,e),!0),km=(n,e={})=>({state:t,dispatch:r,chain:i})=>{const s=le(n,t.schema);return s.isTextblock?i().command(({commands:o})=>Ba(s,e)(t)?!0:o.clearNodes()).command(({state:o})=>Ba(s,e)(o,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},Em=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,i=ft(n,0,r.content.size),s=R.create(r,i);e.setSelection(s)}return!0},xm=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,{from:i,to:s}=typeof n=="number"?{from:n,to:n}:n,o=z.atStart(r).from,a=z.atEnd(r).to,l=ft(i,o,a),c=ft(s,o,a),u=z.create(r,l,c);e.setSelection(u)}return!0},Sm=n=>({state:e,dispatch:t})=>{const r=le(n,e.schema);return sp(r)(e,t)};function Jr(n,e,t){return Object.fromEntries(Object.entries(t).filter(([r])=>{const i=n.find(s=>s.type===e&&s.name===r);return i?i.attribute.keepOnSplit:!1}))}function Ha(n,e){const t=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();if(t){const r=t.filter(i=>e==null?void 0:e.includes(i.type.name));n.tr.ensureMarks(r)}}const Am=({keepMarks:n=!0}={})=>({tr:e,state:t,dispatch:r,editor:i})=>{const{selection:s,doc:o}=e,{$from:a,$to:l}=s,c=i.extensionManager.attributes,u=Jr(c,a.node().type.name,a.node().attrs);if(s instanceof R&&s.node.isBlock)return!a.parentOffset||!wn(o,a.pos)?!1:(r&&(n&&Ha(t,i.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;if(r){const d=l.parentOffset===l.parent.content.size;s instanceof z&&e.deleteSelection();const f=a.depth===0?void 0:am(a.node(-1).contentMatchAt(a.indexAfter(-1)));let h=d&&f?[{type:f,attrs:u}]:void 0,p=wn(e.doc,e.mapping.map(a.pos),1,h);if(!h&&!p&&wn(e.doc,e.mapping.map(a.pos),1,f?[{type:f}]:void 0)&&(p=!0,h=f?[{type:f,attrs:u}]:void 0),p&&(e.split(e.mapping.map(a.pos),1,h),f&&!d&&!a.parentOffset&&a.parent.type!==f)){const m=e.mapping.map(a.before()),y=e.doc.resolve(m);a.node(-1).canReplaceWith(y.index(),y.index()+1,f)&&e.setNodeMarkup(e.mapping.map(a.before()),f)}n&&Ha(t,i.extensionManager.splittableMarks),e.scrollIntoView()}return!0},wm=n=>({tr:e,state:t,dispatch:r,editor:i})=>{var s;const o=le(n,t.schema),{$from:a,$to:l}=t.selection,c=t.selection.node;if(c&&c.isBlock||a.depth<2||!a.sameParent(l))return!1;const u=a.node(-1);if(u.type!==o)return!1;const d=i.extensionManager.attributes;if(a.parent.content.size===0&&a.node(-1).childCount===a.indexAfter(-1)){if(a.depth===2||a.node(-3).type!==o||a.index(-2)!==a.node(-2).childCount-1)return!1;if(r){let y=k.empty;const v=a.index(-1)?1:a.index(-2)?2:3;for(let T=a.depth-v;T>=a.depth-3;T-=1)y=k.from(a.node(T).copy(y));const b=a.indexAfter(-1)<a.node(-2).childCount?1:a.indexAfter(-2)<a.node(-3).childCount?2:3,E=Jr(d,a.node().type.name,a.node().attrs),g=((s=o.contentMatch.defaultType)===null||s===void 0?void 0:s.createAndFill(E))||void 0;y=y.append(k.from(o.createAndFill(null,g)||void 0));const A=a.before(a.depth-(v-1));e.replace(A,a.after(-b),new w(y,4-v,0));let C=-1;e.doc.nodesBetween(A,e.doc.content.size,(T,S)=>{if(C>-1)return!1;T.isTextblock&&T.content.size===0&&(C=S+1)}),C>-1&&e.setSelection(z.near(e.doc.resolve(C))),e.scrollIntoView()}return!0}const f=l.pos===a.end()?u.contentMatchAt(0).defaultType:null,h=Jr(d,u.type.name,u.attrs),p=Jr(d,a.node().type.name,a.node().attrs);e.delete(a.pos,l.pos);const m=f?[{type:o,attrs:h},{type:f,attrs:p}]:[{type:o,attrs:h}];return wn(e.doc,a.pos,2)?(r&&e.split(a.pos,2,m).scrollIntoView(),!0):!1},$a=(n,e)=>{const t=bo(o=>o.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(Math.max(0,t.pos-1)).before(t.depth);if(r===void 0)return!0;const i=n.doc.nodeAt(r);return t.node.type===(i==null?void 0:i.type)&&Bt(n.doc,t.pos)&&n.join(t.pos),!0},ja=(n,e)=>{const t=bo(o=>o.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(t.start).after(t.depth);if(r===void 0)return!0;const i=n.doc.nodeAt(r);return t.node.type===(i==null?void 0:i.type)&&Bt(n.doc,r)&&n.join(r),!0},Om=(n,e)=>({editor:t,tr:r,state:i,dispatch:s,chain:o,commands:a,can:l})=>{const{extensions:c}=t.extensionManager,u=le(n,i.schema),d=le(e,i.schema),{selection:f}=i,{$from:h,$to:p}=f,m=h.blockRange(p);if(!m)return!1;const y=bo(v=>Va(v.type.name,c))(f);if(m.depth>=1&&y&&m.depth-y.depth<=1){if(y.node.type===u)return a.liftListItem(d);if(Va(y.node.type.name,c)&&u.validContent(y.node.content)&&s)return o().command(()=>(r.setNodeMarkup(y.pos,u),!0)).command(()=>$a(r,u)).command(()=>ja(r,u)).run()}return o().command(()=>l().wrapInList(u)?!0:a.clearNodes()).wrapInList(u).command(()=>$a(r,u)).command(()=>ja(r,u)).run()},Mm=(n,e={},t={})=>({state:r,commands:i})=>{const{extendEmptyMarkRange:s=!1}=t,o=It(n,r.schema);return Us(r,o,e)?i.unsetMark(o,{extendEmptyMarkRange:s}):i.setMark(o,e)},Tm=(n,e,t={})=>({state:r,commands:i})=>{const s=le(n,r.schema),o=le(e,r.schema);return Cr(r,s,t)?i.setNode(o):i.setNode(s,t)},Fm=(n,e={})=>({state:t,commands:r})=>{const i=le(n,t.schema);return Cr(t,i,e)?r.lift(i):r.wrapIn(i,e)},Nm=()=>({state:n,dispatch:e})=>{const t=n.plugins;for(let r=0;r<t.length;r+=1){const i=t[r];let s;if(i.spec.isInputRules&&(s=i.getState(n))){if(e){const o=n.tr,a=s.transform;for(let l=a.steps.length-1;l>=0;l-=1)o.step(a.steps[l].invert(a.docs[l]));if(s.text){const l=o.doc.resolve(s.from).marks();o.replaceWith(s.from,s.to,n.schema.text(s.text,l))}else o.delete(s.from,s.to)}return!0}}return!1},Bm=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,{empty:r,ranges:i}=t;return r||e&&i.forEach(s=>{n.removeMark(s.$from.pos,s.$to.pos)}),!0},Rm=(n,e={})=>({tr:t,state:r,dispatch:i})=>{var s;const{extendEmptyMarkRange:o=!1}=e,{selection:a}=t,l=It(n,r.schema),{$from:c,empty:u,ranges:d}=a;if(!i)return!0;if(u&&o){let{from:f,to:h}=a;const p=(s=c.marks().find(y=>y.type===l))===null||s===void 0?void 0:s.attrs,m=go(c,l,p);m&&(f=m.from,h=m.to),t.removeMark(f,h,l)}else d.forEach(f=>{t.removeMark(f.$from.pos,f.$to.pos,l)});return t.removeStoredMark(l),!0},Im=(n,e={})=>({tr:t,state:r,dispatch:i})=>{let s=null,o=null;const a=Ki(typeof n=="string"?n:n.name,r.schema);return a?(a==="node"&&(s=le(n,r.schema)),a==="mark"&&(o=It(n,r.schema)),i&&t.selection.ranges.forEach(l=>{const c=l.$from.pos,u=l.$to.pos;r.doc.nodesBetween(c,u,(d,f)=>{s&&s===d.type&&t.setNodeMarkup(f,void 0,{...d.attrs,...e}),o&&d.marks.length&&d.marks.forEach(h=>{if(o===h.type){const p=Math.max(f,c),m=Math.min(f+d.nodeSize,u);t.addMark(p,m,o.create({...h.attrs,...e}))}})})}),!0):!1},Pm=(n,e={})=>({state:t,dispatch:r})=>{const i=le(n,t.schema);return Zh(i,e)(t,r)},Lm=(n,e={})=>({state:t,dispatch:r})=>{const i=le(n,t.schema);return ep(i,e)(t,r)};var zm=Object.freeze({__proto__:null,blur:Cp,clearContent:kp,clearNodes:Ep,command:xp,createParagraphNear:Sp,deleteCurrentNode:Ap,deleteNode:wp,deleteRange:Op,deleteSelection:Mp,enter:Tp,exitCode:Fp,extendMarkRange:Bp,first:Rp,focus:Ip,forEach:Pp,insertContent:Lp,insertContentAt:Hp,joinUp:$p,joinDown:jp,joinBackward:_p,joinForward:Wp,keyboardShortcut:Up,lift:qp,liftEmptyBlock:Jp,liftListItem:Gp,newlineInCode:Yp,resetAttributes:Xp,scrollIntoView:Qp,selectAll:Zp,selectNodeBackward:em,selectNodeForward:tm,selectParentNode:nm,selectTextblockEnd:rm,selectTextblockStart:im,setContent:sm,setMark:Dm,setMeta:Cm,setNode:km,setNodeSelection:Em,setTextSelection:xm,sinkListItem:Sm,splitBlock:Am,splitListItem:wm,toggleList:Om,toggleMark:Mm,toggleNode:Tm,toggleWrap:Fm,undoInputRule:Nm,unsetAllMarks:Bm,unsetMark:Rm,updateAttributes:Im,wrapIn:Pm,wrapInList:Lm});const Vm=ye.create({name:"commands",addCommands(){return{...zm}}}),Hm=ye.create({name:"editable",addProseMirrorPlugins(){return[new ue({key:new Fe("editable"),props:{editable:()=>this.editor.options.editable}})]}}),$m=ye.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:n}=this;return[new ue({key:new Fe("focusEvents"),props:{handleDOMEvents:{focus:(e,t)=>{n.isFocused=!0;const r=n.state.tr.setMeta("focus",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,t)=>{n.isFocused=!1;const r=n.state.tr.setMeta("blur",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),jm=ye.create({name:"keymap",addKeyboardShortcuts(){const n=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:a})=>{const{selection:l,doc:c}=a,{empty:u,$anchor:d}=l,{pos:f,parent:h}=d,p=L.atStart(c).from===f;return!u||!p||!h.type.isTextblock||h.textContent.length?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.deleteCurrentNode(),()=>o.joinForward(),()=>o.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:n,"Mod-Backspace":n,"Shift-Backspace":n,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i={...r},s={...r,"Ctrl-h":n,"Alt-Backspace":n,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return vo()||_u()?s:i},addProseMirrorPlugins(){return[new ue({key:new Fe("clearDocument"),appendTransaction:(n,e,t)=>{if(!(n.some(p=>p.docChanged)&&!e.doc.eq(t.doc)))return;const{empty:i,from:s,to:o}=e.selection,a=L.atStart(e.doc).from,l=L.atEnd(e.doc).to,c=s===a&&o===l,u=t.doc.textBetween(0,t.doc.content.size," "," ").length===0;if(i||!c||!u)return;const d=t.tr,f=Hi({state:t,transaction:d}),{commands:h}=new $i({editor:this.editor,state:f});if(h.clearNodes(),!!d.steps.length)return d}})]}}),_m=ye.create({name:"tabindex",addProseMirrorPlugins(){return[new ue({key:new Fe("tabindex"),props:{attributes:this.editor.isEditable?{tabindex:"0"}:{}}})]}});var Wm=Object.freeze({__proto__:null,ClipboardTextSerializer:Dp,Commands:Vm,Editable:Hm,FocusEvents:$m,Keymap:jm,Tabindex:_m});const Km=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 1px !important;
  height: 1px !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function Um(n,e){const t=document.querySelector("style[data-tiptap-style]");if(t!==null)return t;const r=document.createElement("style");return e&&r.setAttribute("nonce",e),r.setAttribute("data-tiptap-style",""),r.innerHTML=n,document.getElementsByTagName("head")[0].appendChild(r),r}let qm=class extends op{constructor(e={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=Um(Km,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e){this.setOptions({editable:e}),this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,t){const r=Vu(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],i=this.state.reconfigure({plugins:r});this.view.updateState(i)}unregisterPlugin(e){if(this.isDestroyed)return;const t=typeof e=="string"?`${e}$`:e.key,r=this.state.reconfigure({plugins:this.state.plugins.filter(i=>!i.key.startsWith(t))});this.view.updateState(r)}createExtensionManager(){const t=[...this.options.enableCoreExtensions?Object.values(Wm):[],...this.options.extensions].filter(r=>["extension","node","mark"].includes(r==null?void 0:r.type));this.extensionManager=new Dn(t,this)}createCommandManager(){this.commandManager=new $i({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){const e=Wu(this.options.content,this.schema,this.options.parseOptions),t=ju(e,this.options.autofocus);this.view=new xh(this.options.element,{...this.options.editorProps,dispatchTransaction:this.dispatchTransaction.bind(this),state:yn.create({doc:e,selection:t||void 0})});const r=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(r),this.createNodeViews();const i=this.view.dom;i.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(o=>{var a;return(a=this.capturedTransaction)===null||a===void 0?void 0:a.step(o)});return}const t=this.state.apply(e),r=!this.state.selection.eq(t.selection);this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const i=e.getMeta("focus"),s=e.getMeta("blur");i&&this.emit("focus",{editor:this,event:i.event,transaction:e}),s&&this.emit("blur",{editor:this,event:s.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return Uu(this.state,e)}isActive(e,t){const r=typeof e=="string"?e:null,i=typeof e=="string"?t:e;return gm(this.state,r,i)}getJSON(){return this.state.doc.toJSON()}getHTML(){return cm(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t=`

`,textSerializers:r={}}=e||{};return dm(this.state.doc,{blockSeparator:t,textSerializers:{...r,...$u(this.schema)}})}get isEmpty(){return ym(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}};function Pn(n){return new _i({find:n.find,handler:({state:e,range:t,match:r})=>{const i=P(n.getAttributes,void 0,r);if(i===!1||i===null)return null;const{tr:s}=e,o=r[r.length-1],a=r[0];let l=t.to;if(o){const c=a.search(/\S/),u=t.from+a.indexOf(o),d=u+o.length;if(di(t.from,t.to,e.doc).filter(h=>h.mark.type.excluded.find(m=>m===n.type&&m!==h.mark.type)).filter(h=>h.to>u).length)return null;d<t.to&&s.delete(d,t.to),u>t.from&&s.delete(t.from+c,u),l=t.from+c+o.length,s.addMark(t.from+c,l,n.type.create(i||{})),s.removeStoredMark(n.type)}}})}function Jm(n){return new _i({find:n.find,handler:({state:e,range:t,match:r})=>{const i=P(n.getAttributes,void 0,r)||{},{tr:s}=e,o=t.from;let a=t.to;if(r[1]){const l=r[0].lastIndexOf(r[1]);let c=o+l;c>a?c=a:a=c+r[1].length;const u=r[0][r[0].length-1];s.insertText(u,o+r[0].length-1),s.replaceWith(c,a,n.type.create(i))}else r[0]&&s.replaceWith(o,a,n.type.create(i))}})}function qs(n){return new _i({find:n.find,handler:({state:e,range:t,match:r})=>{const i=e.doc.resolve(t.from),s=P(n.getAttributes,void 0,r)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),n.type))return null;e.tr.delete(t.from,t.to).setBlockType(t.from,t.from,n.type,s)}})}function Do(n){return new _i({find:n.find,handler:({state:e,range:t,match:r})=>{const i=P(n.getAttributes,void 0,r)||{},s=e.tr.delete(t.from,t.to),a=s.doc.resolve(t.from).blockRange(),l=a&&no(a,n.type,i);if(!l)return null;s.wrap(a,l);const c=s.doc.resolve(t.from-1).nodeBefore;c&&c.type===n.type&&Bt(s.doc,t.from-1)&&(!n.joinPredicate||n.joinPredicate(r,c))&&s.join(t.from-1)}})}class mt{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=P(O(this,"addOptions",{name:this.name}))),this.storage=P(O(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new mt(e)}configure(e={}){const t=this.extend();return t.options=Wi(this.options,e),t.storage=P(O(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new mt(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=P(O(t,"addOptions",{name:t.name})),t.storage=P(O(t,"addStorage",{name:t.name,options:t.options})),t}static handleExit({editor:e,mark:t}){const{tr:r}=e.state,i=e.state.selection.$from;if(i.pos===i.end()){const o=i.marks();if(!!!o.find(c=>(c==null?void 0:c.type.name)===t.name))return!1;const l=o.find(c=>(c==null?void 0:c.type.name)===t.name);return l&&r.removeStoredMark(l),r.insertText(" ",i.pos),e.view.dispatch(r),!0}return!1}}class Ae{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=P(O(this,"addOptions",{name:this.name}))),this.storage=P(O(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Ae(e)}configure(e={}){const t=this.extend();return t.options=Wi(this.options,e),t.storage=P(O(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new Ae(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=P(O(t,"addOptions",{name:t.name})),t.storage=P(O(t,"addStorage",{name:t.name,options:t.options})),t}}function rn(n){return new pp({find:n.find,handler:({state:e,range:t,match:r})=>{const i=P(n.getAttributes,void 0,r);if(i===!1||i===null)return null;const{tr:s}=e,o=r[r.length-1],a=r[0];let l=t.to;if(o){const c=a.search(/\S/),u=t.from+a.indexOf(o),d=u+o.length;if(di(t.from,t.to,e.doc).filter(h=>h.mark.type.excluded.find(m=>m===n.type&&m!==h.mark.type)).filter(h=>h.to>u).length)return null;d<t.to&&s.delete(d,t.to),u>t.from&&s.delete(t.from+c,u),l=t.from+c+o.length,s.addMark(t.from+c,l,n.type.create(i||{})),s.removeStoredMark(n.type)}}})}var xe="top",Le="bottom",ze="right",Se="left",Co="auto",Ar=[xe,Le,ze,Se],Ln="start",kr="end",Gm="clippingParents",Ju="viewport",Qn="popper",Ym="reference",_a=Ar.reduce(function(n,e){return n.concat([e+"-"+Ln,e+"-"+kr])},[]),Gu=[].concat(Ar,[Co]).reduce(function(n,e){return n.concat([e,e+"-"+Ln,e+"-"+kr])},[]),Xm="beforeRead",Qm="read",Zm="afterRead",eg="beforeMain",tg="main",ng="afterMain",rg="beforeWrite",ig="write",sg="afterWrite",og=[Xm,Qm,Zm,eg,tg,ng,rg,ig,sg];function rt(n){return n?(n.nodeName||"").toLowerCase():null}function Ve(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function sn(n){var e=Ve(n).Element;return n instanceof e||n instanceof Element}function Pe(n){var e=Ve(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function ko(n){if(typeof ShadowRoot>"u")return!1;var e=Ve(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function ag(n){var e=n.state;Object.keys(e.elements).forEach(function(t){var r=e.styles[t]||{},i=e.attributes[t]||{},s=e.elements[t];!Pe(s)||!rt(s)||(Object.assign(s.style,r),Object.keys(i).forEach(function(o){var a=i[o];a===!1?s.removeAttribute(o):s.setAttribute(o,a===!0?"":a)}))})}function lg(n){var e=n.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(r){var i=e.elements[r],s=e.attributes[r]||{},o=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:t[r]),a=o.reduce(function(l,c){return l[c]="",l},{});!Pe(i)||!rt(i)||(Object.assign(i.style,a),Object.keys(s).forEach(function(l){i.removeAttribute(l)}))})}}const Yu={name:"applyStyles",enabled:!0,phase:"write",fn:ag,effect:lg,requires:["computeStyles"]};function tt(n){return n.split("-")[0]}var Xt=Math.max,fi=Math.min,zn=Math.round;function Js(){var n=navigator.userAgentData;return n!=null&&n.brands?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function Xu(){return!/^((?!chrome|android).)*safari/i.test(Js())}function Vn(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var r=n.getBoundingClientRect(),i=1,s=1;e&&Pe(n)&&(i=n.offsetWidth>0&&zn(r.width)/n.offsetWidth||1,s=n.offsetHeight>0&&zn(r.height)/n.offsetHeight||1);var o=sn(n)?Ve(n):window,a=o.visualViewport,l=!Xu()&&t,c=(r.left+(l&&a?a.offsetLeft:0))/i,u=(r.top+(l&&a?a.offsetTop:0))/s,d=r.width/i,f=r.height/s;return{width:d,height:f,top:u,right:c+d,bottom:u+f,left:c,x:c,y:u}}function Eo(n){var e=Vn(n),t=n.offsetWidth,r=n.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:n.offsetLeft,y:n.offsetTop,width:t,height:r}}function Qu(n,e){var t=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(t&&ko(t)){var r=e;do{if(r&&n.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function gt(n){return Ve(n).getComputedStyle(n)}function ug(n){return["table","td","th"].indexOf(rt(n))>=0}function Pt(n){return((sn(n)?n.ownerDocument:n.document)||window.document).documentElement}function Ui(n){return rt(n)==="html"?n:n.assignedSlot||n.parentNode||(ko(n)?n.host:null)||Pt(n)}function Wa(n){return!Pe(n)||gt(n).position==="fixed"?null:n.offsetParent}function cg(n){var e=/firefox/i.test(Js()),t=/Trident/i.test(Js());if(t&&Pe(n)){var r=gt(n);if(r.position==="fixed")return null}var i=Ui(n);for(ko(i)&&(i=i.host);Pe(i)&&["html","body"].indexOf(rt(i))<0;){var s=gt(i);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||e&&s.willChange==="filter"||e&&s.filter&&s.filter!=="none")return i;i=i.parentNode}return null}function wr(n){for(var e=Ve(n),t=Wa(n);t&&ug(t)&&gt(t).position==="static";)t=Wa(t);return t&&(rt(t)==="html"||rt(t)==="body"&&gt(t).position==="static")?e:t||cg(n)||e}function xo(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function dr(n,e,t){return Xt(n,fi(e,t))}function dg(n,e,t){var r=dr(n,e,t);return r>t?t:r}function Zu(){return{top:0,right:0,bottom:0,left:0}}function ec(n){return Object.assign({},Zu(),n)}function tc(n,e){return e.reduce(function(t,r){return t[r]=n,t},{})}var fg=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,ec(typeof e!="number"?e:tc(e,Ar))};function hg(n){var e,t=n.state,r=n.name,i=n.options,s=t.elements.arrow,o=t.modifiersData.popperOffsets,a=tt(t.placement),l=xo(a),c=[Se,ze].indexOf(a)>=0,u=c?"height":"width";if(!(!s||!o)){var d=fg(i.padding,t),f=Eo(s),h=l==="y"?xe:Se,p=l==="y"?Le:ze,m=t.rects.reference[u]+t.rects.reference[l]-o[l]-t.rects.popper[u],y=o[l]-t.rects.reference[l],v=wr(s),b=v?l==="y"?v.clientHeight||0:v.clientWidth||0:0,E=m/2-y/2,g=d[h],A=b-f[u]-d[p],C=b/2-f[u]/2+E,T=dr(g,C,A),S=l;t.modifiersData[r]=(e={},e[S]=T,e.centerOffset=T-C,e)}}function pg(n){var e=n.state,t=n.options,r=t.element,i=r===void 0?"[data-popper-arrow]":r;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||!Qu(e.elements.popper,i)||(e.elements.arrow=i))}const mg={name:"arrow",enabled:!0,phase:"main",fn:hg,effect:pg,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Hn(n){return n.split("-")[1]}var gg={top:"auto",right:"auto",bottom:"auto",left:"auto"};function yg(n){var e=n.x,t=n.y,r=window,i=r.devicePixelRatio||1;return{x:zn(e*i)/i||0,y:zn(t*i)/i||0}}function Ka(n){var e,t=n.popper,r=n.popperRect,i=n.placement,s=n.variation,o=n.offsets,a=n.position,l=n.gpuAcceleration,c=n.adaptive,u=n.roundOffsets,d=n.isFixed,f=o.x,h=f===void 0?0:f,p=o.y,m=p===void 0?0:p,y=typeof u=="function"?u({x:h,y:m}):{x:h,y:m};h=y.x,m=y.y;var v=o.hasOwnProperty("x"),b=o.hasOwnProperty("y"),E=Se,g=xe,A=window;if(c){var C=wr(t),T="clientHeight",S="clientWidth";if(C===Ve(t)&&(C=Pt(t),gt(C).position!=="static"&&a==="absolute"&&(T="scrollHeight",S="scrollWidth")),C=C,i===xe||(i===Se||i===ze)&&s===kr){g=Le;var V=d&&C===A&&A.visualViewport?A.visualViewport.height:C[T];m-=V-r.height,m*=l?1:-1}if(i===Se||(i===xe||i===Le)&&s===kr){E=ze;var $=d&&C===A&&A.visualViewport?A.visualViewport.width:C[S];h-=$-r.width,h*=l?1:-1}}var X=Object.assign({position:a},c&&gg),q=u===!0?yg({x:h,y:m}):{x:h,y:m};if(h=q.x,m=q.y,l){var F;return Object.assign({},X,(F={},F[g]=b?"0":"",F[E]=v?"0":"",F.transform=(A.devicePixelRatio||1)<=1?"translate("+h+"px, "+m+"px)":"translate3d("+h+"px, "+m+"px, 0)",F))}return Object.assign({},X,(e={},e[g]=b?m+"px":"",e[E]=v?h+"px":"",e.transform="",e))}function vg(n){var e=n.state,t=n.options,r=t.gpuAcceleration,i=r===void 0?!0:r,s=t.adaptive,o=s===void 0?!0:s,a=t.roundOffsets,l=a===void 0?!0:a,c={placement:tt(e.placement),variation:Hn(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Ka(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:o,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Ka(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const bg={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:vg,data:{}};var jr={passive:!0};function Dg(n){var e=n.state,t=n.instance,r=n.options,i=r.scroll,s=i===void 0?!0:i,o=r.resize,a=o===void 0?!0:o,l=Ve(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return s&&c.forEach(function(u){u.addEventListener("scroll",t.update,jr)}),a&&l.addEventListener("resize",t.update,jr),function(){s&&c.forEach(function(u){u.removeEventListener("scroll",t.update,jr)}),a&&l.removeEventListener("resize",t.update,jr)}}const Cg={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Dg,data:{}};var kg={left:"right",right:"left",bottom:"top",top:"bottom"};function Gr(n){return n.replace(/left|right|bottom|top/g,function(e){return kg[e]})}var Eg={start:"end",end:"start"};function Ua(n){return n.replace(/start|end/g,function(e){return Eg[e]})}function So(n){var e=Ve(n),t=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:t,scrollTop:r}}function Ao(n){return Vn(Pt(n)).left+So(n).scrollLeft}function xg(n,e){var t=Ve(n),r=Pt(n),i=t.visualViewport,s=r.clientWidth,o=r.clientHeight,a=0,l=0;if(i){s=i.width,o=i.height;var c=Xu();(c||!c&&e==="fixed")&&(a=i.offsetLeft,l=i.offsetTop)}return{width:s,height:o,x:a+Ao(n),y:l}}function Sg(n){var e,t=Pt(n),r=So(n),i=(e=n.ownerDocument)==null?void 0:e.body,s=Xt(t.scrollWidth,t.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),o=Xt(t.scrollHeight,t.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),a=-r.scrollLeft+Ao(n),l=-r.scrollTop;return gt(i||t).direction==="rtl"&&(a+=Xt(t.clientWidth,i?i.clientWidth:0)-s),{width:s,height:o,x:a,y:l}}function wo(n){var e=gt(n),t=e.overflow,r=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+i+r)}function nc(n){return["html","body","#document"].indexOf(rt(n))>=0?n.ownerDocument.body:Pe(n)&&wo(n)?n:nc(Ui(n))}function fr(n,e){var t;e===void 0&&(e=[]);var r=nc(n),i=r===((t=n.ownerDocument)==null?void 0:t.body),s=Ve(r),o=i?[s].concat(s.visualViewport||[],wo(r)?r:[]):r,a=e.concat(o);return i?a:a.concat(fr(Ui(o)))}function Gs(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function Ag(n,e){var t=Vn(n,!1,e==="fixed");return t.top=t.top+n.clientTop,t.left=t.left+n.clientLeft,t.bottom=t.top+n.clientHeight,t.right=t.left+n.clientWidth,t.width=n.clientWidth,t.height=n.clientHeight,t.x=t.left,t.y=t.top,t}function qa(n,e,t){return e===Ju?Gs(xg(n,t)):sn(e)?Ag(e,t):Gs(Sg(Pt(n)))}function wg(n){var e=fr(Ui(n)),t=["absolute","fixed"].indexOf(gt(n).position)>=0,r=t&&Pe(n)?wr(n):n;return sn(r)?e.filter(function(i){return sn(i)&&Qu(i,r)&&rt(i)!=="body"}):[]}function Og(n,e,t,r){var i=e==="clippingParents"?wg(n):[].concat(e),s=[].concat(i,[t]),o=s[0],a=s.reduce(function(l,c){var u=qa(n,c,r);return l.top=Xt(u.top,l.top),l.right=fi(u.right,l.right),l.bottom=fi(u.bottom,l.bottom),l.left=Xt(u.left,l.left),l},qa(n,o,r));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function rc(n){var e=n.reference,t=n.element,r=n.placement,i=r?tt(r):null,s=r?Hn(r):null,o=e.x+e.width/2-t.width/2,a=e.y+e.height/2-t.height/2,l;switch(i){case xe:l={x:o,y:e.y-t.height};break;case Le:l={x:o,y:e.y+e.height};break;case ze:l={x:e.x+e.width,y:a};break;case Se:l={x:e.x-t.width,y:a};break;default:l={x:e.x,y:e.y}}var c=i?xo(i):null;if(c!=null){var u=c==="y"?"height":"width";switch(s){case Ln:l[c]=l[c]-(e[u]/2-t[u]/2);break;case kr:l[c]=l[c]+(e[u]/2-t[u]/2);break}}return l}function Er(n,e){e===void 0&&(e={});var t=e,r=t.placement,i=r===void 0?n.placement:r,s=t.strategy,o=s===void 0?n.strategy:s,a=t.boundary,l=a===void 0?Gm:a,c=t.rootBoundary,u=c===void 0?Ju:c,d=t.elementContext,f=d===void 0?Qn:d,h=t.altBoundary,p=h===void 0?!1:h,m=t.padding,y=m===void 0?0:m,v=ec(typeof y!="number"?y:tc(y,Ar)),b=f===Qn?Ym:Qn,E=n.rects.popper,g=n.elements[p?b:f],A=Og(sn(g)?g:g.contextElement||Pt(n.elements.popper),l,u,o),C=Vn(n.elements.reference),T=rc({reference:C,element:E,strategy:"absolute",placement:i}),S=Gs(Object.assign({},E,T)),V=f===Qn?S:C,$={top:A.top-V.top+v.top,bottom:V.bottom-A.bottom+v.bottom,left:A.left-V.left+v.left,right:V.right-A.right+v.right},X=n.modifiersData.offset;if(f===Qn&&X){var q=X[i];Object.keys($).forEach(function(F){var Y=[ze,Le].indexOf(F)>=0?1:-1,Z=[xe,Le].indexOf(F)>=0?"y":"x";$[F]+=q[Z]*Y})}return $}function Mg(n,e){e===void 0&&(e={});var t=e,r=t.placement,i=t.boundary,s=t.rootBoundary,o=t.padding,a=t.flipVariations,l=t.allowedAutoPlacements,c=l===void 0?Gu:l,u=Hn(r),d=u?a?_a:_a.filter(function(p){return Hn(p)===u}):Ar,f=d.filter(function(p){return c.indexOf(p)>=0});f.length===0&&(f=d);var h=f.reduce(function(p,m){return p[m]=Er(n,{placement:m,boundary:i,rootBoundary:s,padding:o})[tt(m)],p},{});return Object.keys(h).sort(function(p,m){return h[p]-h[m]})}function Tg(n){if(tt(n)===Co)return[];var e=Gr(n);return[Ua(n),e,Ua(e)]}function Fg(n){var e=n.state,t=n.options,r=n.name;if(!e.modifiersData[r]._skip){for(var i=t.mainAxis,s=i===void 0?!0:i,o=t.altAxis,a=o===void 0?!0:o,l=t.fallbackPlacements,c=t.padding,u=t.boundary,d=t.rootBoundary,f=t.altBoundary,h=t.flipVariations,p=h===void 0?!0:h,m=t.allowedAutoPlacements,y=e.options.placement,v=tt(y),b=v===y,E=l||(b||!p?[Gr(y)]:Tg(y)),g=[y].concat(E).reduce(function(it,He){return it.concat(tt(He)===Co?Mg(e,{placement:He,boundary:u,rootBoundary:d,padding:c,flipVariations:p,allowedAutoPlacements:m}):He)},[]),A=e.rects.reference,C=e.rects.popper,T=new Map,S=!0,V=g[0],$=0;$<g.length;$++){var X=g[$],q=tt(X),F=Hn(X)===Ln,Y=[xe,Le].indexOf(q)>=0,Z=Y?"width":"height",Q=Er(e,{placement:X,boundary:u,rootBoundary:d,altBoundary:f,padding:c}),ne=Y?F?ze:Se:F?Le:xe;A[Z]>C[Z]&&(ne=Gr(ne));var re=Gr(ne),J=[];if(s&&J.push(Q[q]<=0),a&&J.push(Q[ne]<=0,Q[re]<=0),J.every(function(it){return it})){V=X,S=!1;break}T.set(X,J)}if(S)for(var G=p?3:1,Oe=function(He){var st=g.find(function(ln){var ot=T.get(ln);if(ot)return ot.slice(0,He).every(function(un){return un})});if(st)return V=st,"break"},qe=G;qe>0;qe--){var Lt=Oe(qe);if(Lt==="break")break}e.placement!==V&&(e.modifiersData[r]._skip=!0,e.placement=V,e.reset=!0)}}const Ng={name:"flip",enabled:!0,phase:"main",fn:Fg,requiresIfExists:["offset"],data:{_skip:!1}};function Ja(n,e,t){return t===void 0&&(t={x:0,y:0}),{top:n.top-e.height-t.y,right:n.right-e.width+t.x,bottom:n.bottom-e.height+t.y,left:n.left-e.width-t.x}}function Ga(n){return[xe,ze,Le,Se].some(function(e){return n[e]>=0})}function Bg(n){var e=n.state,t=n.name,r=e.rects.reference,i=e.rects.popper,s=e.modifiersData.preventOverflow,o=Er(e,{elementContext:"reference"}),a=Er(e,{altBoundary:!0}),l=Ja(o,r),c=Ja(a,i,s),u=Ga(l),d=Ga(c);e.modifiersData[t]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:d},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":d})}const Rg={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Bg};function Ig(n,e,t){var r=tt(n),i=[Se,xe].indexOf(r)>=0?-1:1,s=typeof t=="function"?t(Object.assign({},e,{placement:n})):t,o=s[0],a=s[1];return o=o||0,a=(a||0)*i,[Se,ze].indexOf(r)>=0?{x:a,y:o}:{x:o,y:a}}function Pg(n){var e=n.state,t=n.options,r=n.name,i=t.offset,s=i===void 0?[0,0]:i,o=Gu.reduce(function(u,d){return u[d]=Ig(d,e.rects,s),u},{}),a=o[e.placement],l=a.x,c=a.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[r]=o}const Lg={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Pg};function zg(n){var e=n.state,t=n.name;e.modifiersData[t]=rc({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const Vg={name:"popperOffsets",enabled:!0,phase:"read",fn:zg,data:{}};function Hg(n){return n==="x"?"y":"x"}function $g(n){var e=n.state,t=n.options,r=n.name,i=t.mainAxis,s=i===void 0?!0:i,o=t.altAxis,a=o===void 0?!1:o,l=t.boundary,c=t.rootBoundary,u=t.altBoundary,d=t.padding,f=t.tether,h=f===void 0?!0:f,p=t.tetherOffset,m=p===void 0?0:p,y=Er(e,{boundary:l,rootBoundary:c,padding:d,altBoundary:u}),v=tt(e.placement),b=Hn(e.placement),E=!b,g=xo(v),A=Hg(g),C=e.modifiersData.popperOffsets,T=e.rects.reference,S=e.rects.popper,V=typeof m=="function"?m(Object.assign({},e.rects,{placement:e.placement})):m,$=typeof V=="number"?{mainAxis:V,altAxis:V}:Object.assign({mainAxis:0,altAxis:0},V),X=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,q={x:0,y:0};if(!!C){if(s){var F,Y=g==="y"?xe:Se,Z=g==="y"?Le:ze,Q=g==="y"?"height":"width",ne=C[g],re=ne+y[Y],J=ne-y[Z],G=h?-S[Q]/2:0,Oe=b===Ln?T[Q]:S[Q],qe=b===Ln?-S[Q]:-T[Q],Lt=e.elements.arrow,it=h&&Lt?Eo(Lt):{width:0,height:0},He=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:Zu(),st=He[Y],ln=He[Z],ot=dr(0,T[Q],it[Q]),un=E?T[Q]/2-G-ot-st-$.mainAxis:Oe-ot-st-$.mainAxis,yt=E?-T[Q]/2+G+ot+ln+$.mainAxis:qe+ot+ln+$.mainAxis,cn=e.elements.arrow&&wr(e.elements.arrow),Or=cn?g==="y"?cn.clientTop||0:cn.clientLeft||0:0,Wn=(F=X==null?void 0:X[g])!=null?F:0,Mr=ne+un-Wn-Or,Tr=ne+yt-Wn,Kn=dr(h?fi(re,Mr):re,ne,h?Xt(J,Tr):J);C[g]=Kn,q[g]=Kn-ne}if(a){var Un,Fr=g==="x"?xe:Se,Nr=g==="x"?Le:ze,at=C[A],vt=A==="y"?"height":"width",qn=at+y[Fr],zt=at-y[Nr],Jn=[xe,Se].indexOf(v)!==-1,Br=(Un=X==null?void 0:X[A])!=null?Un:0,Rr=Jn?qn:at-T[vt]-S[vt]-Br+$.altAxis,Ir=Jn?at+T[vt]+S[vt]-Br-$.altAxis:zt,Pr=h&&Jn?dg(Rr,at,Ir):dr(h?Rr:qn,at,h?Ir:zt);C[A]=Pr,q[A]=Pr-at}e.modifiersData[r]=q}}const jg={name:"preventOverflow",enabled:!0,phase:"main",fn:$g,requiresIfExists:["offset"]};function _g(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function Wg(n){return n===Ve(n)||!Pe(n)?So(n):_g(n)}function Kg(n){var e=n.getBoundingClientRect(),t=zn(e.width)/n.offsetWidth||1,r=zn(e.height)/n.offsetHeight||1;return t!==1||r!==1}function Ug(n,e,t){t===void 0&&(t=!1);var r=Pe(e),i=Pe(e)&&Kg(e),s=Pt(e),o=Vn(n,i,t),a={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(r||!r&&!t)&&((rt(e)!=="body"||wo(s))&&(a=Wg(e)),Pe(e)?(l=Vn(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):s&&(l.x=Ao(s))),{x:o.left+a.scrollLeft-l.x,y:o.top+a.scrollTop-l.y,width:o.width,height:o.height}}function qg(n){var e=new Map,t=new Set,r=[];n.forEach(function(s){e.set(s.name,s)});function i(s){t.add(s.name);var o=[].concat(s.requires||[],s.requiresIfExists||[]);o.forEach(function(a){if(!t.has(a)){var l=e.get(a);l&&i(l)}}),r.push(s)}return n.forEach(function(s){t.has(s.name)||i(s)}),r}function Jg(n){var e=qg(n);return og.reduce(function(t,r){return t.concat(e.filter(function(i){return i.phase===r}))},[])}function Gg(n){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(n())})})),e}}function Yg(n){var e=n.reduce(function(t,r){var i=t[r.name];return t[r.name]=i?Object.assign({},i,r,{options:Object.assign({},i.options,r.options),data:Object.assign({},i.data,r.data)}):r,t},{});return Object.keys(e).map(function(t){return e[t]})}var Ya={placement:"bottom",modifiers:[],strategy:"absolute"};function Xa(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function Xg(n){n===void 0&&(n={});var e=n,t=e.defaultModifiers,r=t===void 0?[]:t,i=e.defaultOptions,s=i===void 0?Ya:i;return function(a,l,c){c===void 0&&(c=s);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},Ya,s),modifiersData:{},elements:{reference:a,popper:l},attributes:{},styles:{}},d=[],f=!1,h={state:u,setOptions:function(v){var b=typeof v=="function"?v(u.options):v;m(),u.options=Object.assign({},s,u.options,b),u.scrollParents={reference:sn(a)?fr(a):a.contextElement?fr(a.contextElement):[],popper:fr(l)};var E=Jg(Yg([].concat(r,u.options.modifiers)));return u.orderedModifiers=E.filter(function(g){return g.enabled}),p(),h.update()},forceUpdate:function(){if(!f){var v=u.elements,b=v.reference,E=v.popper;if(!!Xa(b,E)){u.rects={reference:Ug(b,wr(E),u.options.strategy==="fixed"),popper:Eo(E)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function($){return u.modifiersData[$.name]=Object.assign({},$.data)});for(var g=0;g<u.orderedModifiers.length;g++){if(u.reset===!0){u.reset=!1,g=-1;continue}var A=u.orderedModifiers[g],C=A.fn,T=A.options,S=T===void 0?{}:T,V=A.name;typeof C=="function"&&(u=C({state:u,options:S,name:V,instance:h})||u)}}}},update:Gg(function(){return new Promise(function(y){h.forceUpdate(),y(u)})}),destroy:function(){m(),f=!0}};if(!Xa(a,l))return h;h.setOptions(c).then(function(y){!f&&c.onFirstUpdate&&c.onFirstUpdate(y)});function p(){u.orderedModifiers.forEach(function(y){var v=y.name,b=y.options,E=b===void 0?{}:b,g=y.effect;if(typeof g=="function"){var A=g({state:u,name:v,instance:h,options:E}),C=function(){};d.push(A||C)}})}function m(){d.forEach(function(y){return y()}),d=[]}return h}}var Qg=[Cg,Vg,bg,Yu,Lg,Ng,jg,mg,Rg],Zg=Xg({defaultModifiers:Qg}),e0="tippy-box",ic="tippy-content",t0="tippy-backdrop",sc="tippy-arrow",oc="tippy-svg-arrow",$t={passive:!0,capture:!0},ac=function(){return document.body};function bs(n,e,t){if(Array.isArray(n)){var r=n[e];return r??(Array.isArray(t)?t[e]:t)}return n}function Oo(n,e){var t={}.toString.call(n);return t.indexOf("[object")===0&&t.indexOf(e+"]")>-1}function lc(n,e){return typeof n=="function"?n.apply(void 0,e):n}function Qa(n,e){if(e===0)return n;var t;return function(r){clearTimeout(t),t=setTimeout(function(){n(r)},e)}}function n0(n){return n.split(/\s+/).filter(Boolean)}function gn(n){return[].concat(n)}function Za(n,e){n.indexOf(e)===-1&&n.push(e)}function r0(n){return n.filter(function(e,t){return n.indexOf(e)===t})}function i0(n){return n.split("-")[0]}function hi(n){return[].slice.call(n)}function el(n){return Object.keys(n).reduce(function(e,t){return n[t]!==void 0&&(e[t]=n[t]),e},{})}function hr(){return document.createElement("div")}function qi(n){return["Element","Fragment"].some(function(e){return Oo(n,e)})}function s0(n){return Oo(n,"NodeList")}function o0(n){return Oo(n,"MouseEvent")}function a0(n){return!!(n&&n._tippy&&n._tippy.reference===n)}function l0(n){return qi(n)?[n]:s0(n)?hi(n):Array.isArray(n)?n:hi(document.querySelectorAll(n))}function Ds(n,e){n.forEach(function(t){t&&(t.style.transitionDuration=e+"ms")})}function tl(n,e){n.forEach(function(t){t&&t.setAttribute("data-state",e)})}function u0(n){var e,t=gn(n),r=t[0];return r!=null&&(e=r.ownerDocument)!=null&&e.body?r.ownerDocument:document}function c0(n,e){var t=e.clientX,r=e.clientY;return n.every(function(i){var s=i.popperRect,o=i.popperState,a=i.props,l=a.interactiveBorder,c=i0(o.placement),u=o.modifiersData.offset;if(!u)return!0;var d=c==="bottom"?u.top.y:0,f=c==="top"?u.bottom.y:0,h=c==="right"?u.left.x:0,p=c==="left"?u.right.x:0,m=s.top-r+d>l,y=r-s.bottom-f>l,v=s.left-t+h>l,b=t-s.right-p>l;return m||y||v||b})}function Cs(n,e,t){var r=e+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(i){n[r](i,t)})}function nl(n,e){for(var t=e;t;){var r;if(n.contains(t))return!0;t=t.getRootNode==null||(r=t.getRootNode())==null?void 0:r.host}return!1}var Ye={isTouch:!1},rl=0;function d0(){Ye.isTouch||(Ye.isTouch=!0,window.performance&&document.addEventListener("mousemove",uc))}function uc(){var n=performance.now();n-rl<20&&(Ye.isTouch=!1,document.removeEventListener("mousemove",uc)),rl=n}function f0(){var n=document.activeElement;if(a0(n)){var e=n._tippy;n.blur&&!e.state.isVisible&&n.blur()}}function h0(){document.addEventListener("touchstart",d0,$t),window.addEventListener("blur",f0)}var p0=typeof window<"u"&&typeof document<"u",m0=p0?!!window.msCrypto:!1,g0={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},y0={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},_e=Object.assign({appendTo:ac,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},g0,y0),v0=Object.keys(_e),b0=function(e){var t=Object.keys(e);t.forEach(function(r){_e[r]=e[r]})};function cc(n){var e=n.plugins||[],t=e.reduce(function(r,i){var s=i.name,o=i.defaultValue;if(s){var a;r[s]=n[s]!==void 0?n[s]:(a=_e[s])!=null?a:o}return r},{});return Object.assign({},n,t)}function D0(n,e){var t=e?Object.keys(cc(Object.assign({},_e,{plugins:e}))):v0,r=t.reduce(function(i,s){var o=(n.getAttribute("data-tippy-"+s)||"").trim();if(!o)return i;if(s==="content")i[s]=o;else try{i[s]=JSON.parse(o)}catch{i[s]=o}return i},{});return r}function il(n,e){var t=Object.assign({},e,{content:lc(e.content,[n])},e.ignoreAttributes?{}:D0(n,e.plugins));return t.aria=Object.assign({},_e.aria,t.aria),t.aria={expanded:t.aria.expanded==="auto"?e.interactive:t.aria.expanded,content:t.aria.content==="auto"?e.interactive?null:"describedby":t.aria.content},t}var C0=function(){return"innerHTML"};function Ys(n,e){n[C0()]=e}function sl(n){var e=hr();return n===!0?e.className=sc:(e.className=oc,qi(n)?e.appendChild(n):Ys(e,n)),e}function ol(n,e){qi(e.content)?(Ys(n,""),n.appendChild(e.content)):typeof e.content!="function"&&(e.allowHTML?Ys(n,e.content):n.textContent=e.content)}function Xs(n){var e=n.firstElementChild,t=hi(e.children);return{box:e,content:t.find(function(r){return r.classList.contains(ic)}),arrow:t.find(function(r){return r.classList.contains(sc)||r.classList.contains(oc)}),backdrop:t.find(function(r){return r.classList.contains(t0)})}}function dc(n){var e=hr(),t=hr();t.className=e0,t.setAttribute("data-state","hidden"),t.setAttribute("tabindex","-1");var r=hr();r.className=ic,r.setAttribute("data-state","hidden"),ol(r,n.props),e.appendChild(t),t.appendChild(r),i(n.props,n.props);function i(s,o){var a=Xs(e),l=a.box,c=a.content,u=a.arrow;o.theme?l.setAttribute("data-theme",o.theme):l.removeAttribute("data-theme"),typeof o.animation=="string"?l.setAttribute("data-animation",o.animation):l.removeAttribute("data-animation"),o.inertia?l.setAttribute("data-inertia",""):l.removeAttribute("data-inertia"),l.style.maxWidth=typeof o.maxWidth=="number"?o.maxWidth+"px":o.maxWidth,o.role?l.setAttribute("role",o.role):l.removeAttribute("role"),(s.content!==o.content||s.allowHTML!==o.allowHTML)&&ol(c,n.props),o.arrow?u?s.arrow!==o.arrow&&(l.removeChild(u),l.appendChild(sl(o.arrow))):l.appendChild(sl(o.arrow)):u&&l.removeChild(u)}return{popper:e,onUpdate:i}}dc.$$tippy=!0;var k0=1,_r=[],ks=[];function E0(n,e){var t=il(n,Object.assign({},_e,cc(el(e)))),r,i,s,o=!1,a=!1,l=!1,c=!1,u,d,f,h=[],p=Qa(Mr,t.interactiveDebounce),m,y=k0++,v=null,b=r0(t.plugins),E={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},g={id:y,reference:n,popper:hr(),popperInstance:v,props:t,state:E,plugins:b,clearDelayTimeouts:Rr,setProps:Ir,setContent:Pr,show:wc,hide:Oc,hideWithInteractivity:Mc,enable:Jn,disable:Br,unmount:Tc,destroy:Fc};if(!t.render)return g;var A=t.render(g),C=A.popper,T=A.onUpdate;C.setAttribute("data-tippy-root",""),C.id="tippy-"+g.id,g.popper=C,n._tippy=g,C._tippy=g;var S=b.map(function(D){return D.fn(g)}),V=n.hasAttribute("aria-expanded");return cn(),G(),ne(),re("onCreate",[g]),t.showOnCreate&&qn(),C.addEventListener("mouseenter",function(){g.props.interactive&&g.state.isVisible&&g.clearDelayTimeouts()}),C.addEventListener("mouseleave",function(){g.props.interactive&&g.props.trigger.indexOf("mouseenter")>=0&&Y().addEventListener("mousemove",p)}),g;function $(){var D=g.props.touch;return Array.isArray(D)?D:[D,0]}function X(){return $()[0]==="hold"}function q(){var D;return!!((D=g.props.render)!=null&&D.$$tippy)}function F(){return m||n}function Y(){var D=F().parentNode;return D?u0(D):document}function Z(){return Xs(C)}function Q(D){return g.state.isMounted&&!g.state.isVisible||Ye.isTouch||u&&u.type==="focus"?0:bs(g.props.delay,D?0:1,_e.delay)}function ne(D){D===void 0&&(D=!1),C.style.pointerEvents=g.props.interactive&&!D?"":"none",C.style.zIndex=""+g.props.zIndex}function re(D,M,I){if(I===void 0&&(I=!0),S.forEach(function(j){j[D]&&j[D].apply(j,M)}),I){var _;(_=g.props)[D].apply(_,M)}}function J(){var D=g.props.aria;if(!!D.content){var M="aria-"+D.content,I=C.id,_=gn(g.props.triggerTarget||n);_.forEach(function(j){var ve=j.getAttribute(M);if(g.state.isVisible)j.setAttribute(M,ve?ve+" "+I:I);else{var Ne=ve&&ve.replace(I,"").trim();Ne?j.setAttribute(M,Ne):j.removeAttribute(M)}})}}function G(){if(!(V||!g.props.aria.expanded)){var D=gn(g.props.triggerTarget||n);D.forEach(function(M){g.props.interactive?M.setAttribute("aria-expanded",g.state.isVisible&&M===F()?"true":"false"):M.removeAttribute("aria-expanded")})}}function Oe(){Y().removeEventListener("mousemove",p),_r=_r.filter(function(D){return D!==p})}function qe(D){if(!(Ye.isTouch&&(l||D.type==="mousedown"))){var M=D.composedPath&&D.composedPath()[0]||D.target;if(!(g.props.interactive&&nl(C,M))){if(gn(g.props.triggerTarget||n).some(function(I){return nl(I,M)})){if(Ye.isTouch||g.state.isVisible&&g.props.trigger.indexOf("click")>=0)return}else re("onClickOutside",[g,D]);g.props.hideOnClick===!0&&(g.clearDelayTimeouts(),g.hide(),a=!0,setTimeout(function(){a=!1}),g.state.isMounted||st())}}}function Lt(){l=!0}function it(){l=!1}function He(){var D=Y();D.addEventListener("mousedown",qe,!0),D.addEventListener("touchend",qe,$t),D.addEventListener("touchstart",it,$t),D.addEventListener("touchmove",Lt,$t)}function st(){var D=Y();D.removeEventListener("mousedown",qe,!0),D.removeEventListener("touchend",qe,$t),D.removeEventListener("touchstart",it,$t),D.removeEventListener("touchmove",Lt,$t)}function ln(D,M){un(D,function(){!g.state.isVisible&&C.parentNode&&C.parentNode.contains(C)&&M()})}function ot(D,M){un(D,M)}function un(D,M){var I=Z().box;function _(j){j.target===I&&(Cs(I,"remove",_),M())}if(D===0)return M();Cs(I,"remove",d),Cs(I,"add",_),d=_}function yt(D,M,I){I===void 0&&(I=!1);var _=gn(g.props.triggerTarget||n);_.forEach(function(j){j.addEventListener(D,M,I),h.push({node:j,eventType:D,handler:M,options:I})})}function cn(){X()&&(yt("touchstart",Wn,{passive:!0}),yt("touchend",Tr,{passive:!0})),n0(g.props.trigger).forEach(function(D){if(D!=="manual")switch(yt(D,Wn),D){case"mouseenter":yt("mouseleave",Tr);break;case"focus":yt(m0?"focusout":"blur",Kn);break;case"focusin":yt("focusout",Kn);break}})}function Or(){h.forEach(function(D){var M=D.node,I=D.eventType,_=D.handler,j=D.options;M.removeEventListener(I,_,j)}),h=[]}function Wn(D){var M,I=!1;if(!(!g.state.isEnabled||Un(D)||a)){var _=((M=u)==null?void 0:M.type)==="focus";u=D,m=D.currentTarget,G(),!g.state.isVisible&&o0(D)&&_r.forEach(function(j){return j(D)}),D.type==="click"&&(g.props.trigger.indexOf("mouseenter")<0||o)&&g.props.hideOnClick!==!1&&g.state.isVisible?I=!0:qn(D),D.type==="click"&&(o=!I),I&&!_&&zt(D)}}function Mr(D){var M=D.target,I=F().contains(M)||C.contains(M);if(!(D.type==="mousemove"&&I)){var _=vt().concat(C).map(function(j){var ve,Ne=j._tippy,dn=(ve=Ne.popperInstance)==null?void 0:ve.state;return dn?{popperRect:j.getBoundingClientRect(),popperState:dn,props:t}:null}).filter(Boolean);c0(_,D)&&(Oe(),zt(D))}}function Tr(D){var M=Un(D)||g.props.trigger.indexOf("click")>=0&&o;if(!M){if(g.props.interactive){g.hideWithInteractivity(D);return}zt(D)}}function Kn(D){g.props.trigger.indexOf("focusin")<0&&D.target!==F()||g.props.interactive&&D.relatedTarget&&C.contains(D.relatedTarget)||zt(D)}function Un(D){return Ye.isTouch?X()!==D.type.indexOf("touch")>=0:!1}function Fr(){Nr();var D=g.props,M=D.popperOptions,I=D.placement,_=D.offset,j=D.getReferenceClientRect,ve=D.moveTransition,Ne=q()?Xs(C).arrow:null,dn=j?{getBoundingClientRect:j,contextElement:j.contextElement||F()}:n,zo={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(Lr){var fn=Lr.state;if(q()){var Nc=Z(),Gi=Nc.box;["placement","reference-hidden","escaped"].forEach(function(zr){zr==="placement"?Gi.setAttribute("data-placement",fn.placement):fn.attributes.popper["data-popper-"+zr]?Gi.setAttribute("data-"+zr,""):Gi.removeAttribute("data-"+zr)}),fn.attributes.popper={}}}},Vt=[{name:"offset",options:{offset:_}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!ve}},zo];q()&&Ne&&Vt.push({name:"arrow",options:{element:Ne,padding:3}}),Vt.push.apply(Vt,(M==null?void 0:M.modifiers)||[]),g.popperInstance=Zg(dn,C,Object.assign({},M,{placement:I,onFirstUpdate:f,modifiers:Vt}))}function Nr(){g.popperInstance&&(g.popperInstance.destroy(),g.popperInstance=null)}function at(){var D=g.props.appendTo,M,I=F();g.props.interactive&&D===ac||D==="parent"?M=I.parentNode:M=lc(D,[I]),M.contains(C)||M.appendChild(C),g.state.isMounted=!0,Fr()}function vt(){return hi(C.querySelectorAll("[data-tippy-root]"))}function qn(D){g.clearDelayTimeouts(),D&&re("onTrigger",[g,D]),He();var M=Q(!0),I=$(),_=I[0],j=I[1];Ye.isTouch&&_==="hold"&&j&&(M=j),M?r=setTimeout(function(){g.show()},M):g.show()}function zt(D){if(g.clearDelayTimeouts(),re("onUntrigger",[g,D]),!g.state.isVisible){st();return}if(!(g.props.trigger.indexOf("mouseenter")>=0&&g.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(D.type)>=0&&o)){var M=Q(!1);M?i=setTimeout(function(){g.state.isVisible&&g.hide()},M):s=requestAnimationFrame(function(){g.hide()})}}function Jn(){g.state.isEnabled=!0}function Br(){g.hide(),g.state.isEnabled=!1}function Rr(){clearTimeout(r),clearTimeout(i),cancelAnimationFrame(s)}function Ir(D){if(!g.state.isDestroyed){re("onBeforeUpdate",[g,D]),Or();var M=g.props,I=il(n,Object.assign({},M,el(D),{ignoreAttributes:!0}));g.props=I,cn(),M.interactiveDebounce!==I.interactiveDebounce&&(Oe(),p=Qa(Mr,I.interactiveDebounce)),M.triggerTarget&&!I.triggerTarget?gn(M.triggerTarget).forEach(function(_){_.removeAttribute("aria-expanded")}):I.triggerTarget&&n.removeAttribute("aria-expanded"),G(),ne(),T&&T(M,I),g.popperInstance&&(Fr(),vt().forEach(function(_){requestAnimationFrame(_._tippy.popperInstance.forceUpdate)})),re("onAfterUpdate",[g,D])}}function Pr(D){g.setProps({content:D})}function wc(){var D=g.state.isVisible,M=g.state.isDestroyed,I=!g.state.isEnabled,_=Ye.isTouch&&!g.props.touch,j=bs(g.props.duration,0,_e.duration);if(!(D||M||I||_)&&!F().hasAttribute("disabled")&&(re("onShow",[g],!1),g.props.onShow(g)!==!1)){if(g.state.isVisible=!0,q()&&(C.style.visibility="visible"),ne(),He(),g.state.isMounted||(C.style.transition="none"),q()){var ve=Z(),Ne=ve.box,dn=ve.content;Ds([Ne,dn],0)}f=function(){var Vt;if(!(!g.state.isVisible||c)){if(c=!0,C.offsetHeight,C.style.transition=g.props.moveTransition,q()&&g.props.animation){var Ji=Z(),Lr=Ji.box,fn=Ji.content;Ds([Lr,fn],j),tl([Lr,fn],"visible")}J(),G(),Za(ks,g),(Vt=g.popperInstance)==null||Vt.forceUpdate(),re("onMount",[g]),g.props.animation&&q()&&ot(j,function(){g.state.isShown=!0,re("onShown",[g])})}},at()}}function Oc(){var D=!g.state.isVisible,M=g.state.isDestroyed,I=!g.state.isEnabled,_=bs(g.props.duration,1,_e.duration);if(!(D||M||I)&&(re("onHide",[g],!1),g.props.onHide(g)!==!1)){if(g.state.isVisible=!1,g.state.isShown=!1,c=!1,o=!1,q()&&(C.style.visibility="hidden"),Oe(),st(),ne(!0),q()){var j=Z(),ve=j.box,Ne=j.content;g.props.animation&&(Ds([ve,Ne],_),tl([ve,Ne],"hidden"))}J(),G(),g.props.animation?q()&&ln(_,g.unmount):g.unmount()}}function Mc(D){Y().addEventListener("mousemove",p),Za(_r,p),p(D)}function Tc(){g.state.isVisible&&g.hide(),g.state.isMounted&&(Nr(),vt().forEach(function(D){D._tippy.unmount()}),C.parentNode&&C.parentNode.removeChild(C),ks=ks.filter(function(D){return D!==g}),g.state.isMounted=!1,re("onHidden",[g]))}function Fc(){g.state.isDestroyed||(g.clearDelayTimeouts(),g.unmount(),Or(),delete n._tippy,g.state.isDestroyed=!0,re("onDestroy",[g]))}}function _n(n,e){e===void 0&&(e={});var t=_e.plugins.concat(e.plugins||[]);h0();var r=Object.assign({},e,{plugins:t}),i=l0(n),s=i.reduce(function(o,a){var l=a&&E0(a,r);return l&&o.push(l),o},[]);return qi(n)?s[0]:s}_n.defaultProps=_e;_n.setDefaultProps=b0;_n.currentInput=Ye;Object.assign({},Yu,{effect:function(e){var t=e.state,r={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(t.elements.popper.style,r.popper),t.styles=r,t.elements.arrow&&Object.assign(t.elements.arrow.style,r.arrow)}});_n.setDefaultProps({render:dc});var Wr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function x0(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}var fc=x0,S0=typeof Wr=="object"&&Wr&&Wr.Object===Object&&Wr,A0=S0,w0=A0,O0=typeof self=="object"&&self&&self.Object===Object&&self,M0=w0||O0||Function("return this")(),hc=M0,T0=hc,F0=function(){return T0.Date.now()},N0=F0,B0=/\s/;function R0(n){for(var e=n.length;e--&&B0.test(n.charAt(e)););return e}var I0=R0,P0=I0,L0=/^\s+/;function z0(n){return n&&n.slice(0,P0(n)+1).replace(L0,"")}var V0=z0,H0=hc,$0=H0.Symbol,pc=$0,al=pc,mc=Object.prototype,j0=mc.hasOwnProperty,_0=mc.toString,Zn=al?al.toStringTag:void 0;function W0(n){var e=j0.call(n,Zn),t=n[Zn];try{n[Zn]=void 0;var r=!0}catch{}var i=_0.call(n);return r&&(e?n[Zn]=t:delete n[Zn]),i}var K0=W0,U0=Object.prototype,q0=U0.toString;function J0(n){return q0.call(n)}var G0=J0,ll=pc,Y0=K0,X0=G0,Q0="[object Null]",Z0="[object Undefined]",ul=ll?ll.toStringTag:void 0;function ey(n){return n==null?n===void 0?Z0:Q0:ul&&ul in Object(n)?Y0(n):X0(n)}var ty=ey;function ny(n){return n!=null&&typeof n=="object"}var ry=ny,iy=ty,sy=ry,oy="[object Symbol]";function ay(n){return typeof n=="symbol"||sy(n)&&iy(n)==oy}var ly=ay,uy=V0,cl=fc,cy=ly,dl=0/0,dy=/^[-+]0x[0-9a-f]+$/i,fy=/^0b[01]+$/i,hy=/^0o[0-7]+$/i,py=parseInt;function my(n){if(typeof n=="number")return n;if(cy(n))return dl;if(cl(n)){var e=typeof n.valueOf=="function"?n.valueOf():n;n=cl(e)?e+"":e}if(typeof n!="string")return n===0?n:+n;n=uy(n);var t=fy.test(n);return t||hy.test(n)?py(n.slice(2),t?2:8):dy.test(n)?dl:+n}var gy=my,yy=fc,Es=N0,fl=gy,vy="Expected a function",by=Math.max,Dy=Math.min;function Cy(n,e,t){var r,i,s,o,a,l,c=0,u=!1,d=!1,f=!0;if(typeof n!="function")throw new TypeError(vy);e=fl(e)||0,yy(t)&&(u=!!t.leading,d="maxWait"in t,s=d?by(fl(t.maxWait)||0,e):s,f="trailing"in t?!!t.trailing:f);function h(C){var T=r,S=i;return r=i=void 0,c=C,o=n.apply(S,T),o}function p(C){return c=C,a=setTimeout(v,e),u?h(C):o}function m(C){var T=C-l,S=C-c,V=e-T;return d?Dy(V,s-S):V}function y(C){var T=C-l,S=C-c;return l===void 0||T>=e||T<0||d&&S>=s}function v(){var C=Es();if(y(C))return b(C);a=setTimeout(v,m(C))}function b(C){return a=void 0,f&&r?h(C):(r=i=void 0,o)}function E(){a!==void 0&&clearTimeout(a),c=0,r=l=i=a=void 0}function g(){return a===void 0?o:b(Es())}function A(){var C=Es(),T=y(C);if(r=arguments,i=this,l=C,T){if(a===void 0)return p(l);if(d)return clearTimeout(a),a=setTimeout(v,e),h(l)}return a===void 0&&(a=setTimeout(v,e)),o}return A.cancel=E,A.flush=g,A}var ky=Cy;class Ey{constructor({editor:e,element:t,view:r,tippyOptions:i={},updateDelay:s=250,shouldShow:o}){this.preventHide=!1,this.shouldShow=({view:a,state:l,from:c,to:u})=>{const{doc:d,selection:f}=l,{empty:h}=f,p=!d.textBetween(c,u).length&&yo(l.selection),m=this.element.contains(document.activeElement);return!(!(a.hasFocus()||m)||h||p||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.dragstartHandler=()=>{this.hide()},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:a})=>{var l;if(this.preventHide){this.preventHide=!1;return}(a==null?void 0:a.relatedTarget)&&((l=this.element.parentNode)===null||l===void 0?void 0:l.contains(a.relatedTarget))||this.hide()},this.tippyBlurHandler=a=>{this.blurHandler({event:a})},this.updateHandler=(a,l)=>{var c,u,d;const{state:f,composing:h}=a,{doc:p,selection:m}=f,y=l&&l.doc.eq(p)&&l.selection.eq(m);if(h||y)return;this.createTooltip();const{ranges:v}=m,b=Math.min(...v.map(A=>A.$from.pos)),E=Math.max(...v.map(A=>A.$to.pos));if(!((c=this.shouldShow)===null||c===void 0?void 0:c.call(this,{editor:this.editor,view:a,state:f,oldState:l,from:b,to:E}))){this.hide();return}(u=this.tippy)===null||u===void 0||u.setProps({getReferenceClientRect:((d=this.tippyOptions)===null||d===void 0?void 0:d.getReferenceClientRect)||(()=>{if(vm(f.selection)){const A=a.nodeDOM(b);if(A)return A.getBoundingClientRect()}return qu(a,b,E)})}),this.show()},this.editor=e,this.element=t,this.view=r,this.updateDelay=s,o&&(this.shouldShow=o),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.addEventListener("dragstart",this.dragstartHandler),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=i,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:e}=this.editor.options,t=!!e.parentElement;this.tippy||!t||(this.tippy=_n(e,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"top",hideOnClick:"toggle",...this.tippyOptions}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(e,t){const{state:r}=e,i=r.selection.$from.pos!==r.selection.$to.pos;this.updateDelay>0&&i?ky(this.updateHandler,this.updateDelay)(e,t):this.updateHandler(e,t)}show(){var e;(e=this.tippy)===null||e===void 0||e.show()}hide(){var e;(e=this.tippy)===null||e===void 0||e.hide()}destroy(){var e,t;!((e=this.tippy)===null||e===void 0)&&e.popper.firstChild&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),(t=this.tippy)===null||t===void 0||t.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.removeEventListener("dragstart",this.dragstartHandler),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const gc=n=>new ue({key:typeof n.pluginKey=="string"?new Fe(n.pluginKey):n.pluginKey,view:e=>new Ey({view:e,...n})});ye.create({name:"bubbleMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"bubbleMenu",updateDelay:void 0,shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[gc({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,updateDelay:this.options.updateDelay,shouldShow:this.options.shouldShow})]:[]}});class xy{constructor({editor:e,element:t,view:r,tippyOptions:i={},shouldShow:s}){this.preventHide=!1,this.shouldShow=({view:o,state:a})=>{const{selection:l}=a,{$anchor:c,empty:u}=l,d=c.depth===1,f=c.parent.isTextblock&&!c.parent.type.spec.code&&!c.parent.textContent;return!(!o.hasFocus()||!u||!d||!f||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:o})=>{var a;if(this.preventHide){this.preventHide=!1;return}(o==null?void 0:o.relatedTarget)&&((a=this.element.parentNode)===null||a===void 0?void 0:a.contains(o.relatedTarget))||this.hide()},this.tippyBlurHandler=o=>{this.blurHandler({event:o})},this.editor=e,this.element=t,this.view=r,s&&(this.shouldShow=s),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=i,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:e}=this.editor.options,t=!!e.parentElement;this.tippy||!t||(this.tippy=_n(e,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"right",hideOnClick:"toggle",...this.tippyOptions}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(e,t){var r,i,s;const{state:o}=e,{doc:a,selection:l}=o,{from:c,to:u}=l;if(t&&t.doc.eq(a)&&t.selection.eq(l))return;if(this.createTooltip(),!((r=this.shouldShow)===null||r===void 0?void 0:r.call(this,{editor:this.editor,view:e,state:o,oldState:t}))){this.hide();return}(i=this.tippy)===null||i===void 0||i.setProps({getReferenceClientRect:((s=this.tippyOptions)===null||s===void 0?void 0:s.getReferenceClientRect)||(()=>qu(e,c,u))}),this.show()}show(){var e;(e=this.tippy)===null||e===void 0||e.show()}hide(){var e;(e=this.tippy)===null||e===void 0||e.hide()}destroy(){var e,t;!((e=this.tippy)===null||e===void 0)&&e.popper.firstChild&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),(t=this.tippy)===null||t===void 0||t.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const yc=n=>new ue({key:typeof n.pluginKey=="string"?new Fe(n.pluginKey):n.pluginKey,view:e=>new xy({view:e,...n})});ye.create({name:"floatingMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"floatingMenu",shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[yc({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,shouldShow:this.options.shouldShow})]:[]}});on({name:"BubbleMenu",props:{pluginKey:{type:null,default:"bubbleMenu"},editor:{type:Object,required:!0},updateDelay:{type:Number,default:void 0},tippyOptions:{type:Object,default:()=>({})},shouldShow:{type:Function,default:null}},setup(n,{slots:e}){const t=Qt(null);return eo(()=>{const{updateDelay:r,editor:i,pluginKey:s,shouldShow:o,tippyOptions:a}=n;i.registerPlugin(gc({updateDelay:r,editor:i,element:t.value,pluginKey:s,shouldShow:o,tippyOptions:a}))}),xr(()=>{const{pluginKey:r,editor:i}=n;i.unregisterPlugin(r)}),()=>{var r;return Ut("div",{ref:t},(r=e.default)===null||r===void 0?void 0:r.call(e))}}});function hl(n){return Vc((e,t)=>({get(){return e(),n},set(r){n=r,requestAnimationFrame(()=>{requestAnimationFrame(()=>{t()})})}}))}class Sy extends qm{constructor(e={}){return super(e),this.vueRenderers=Ur(new Map),this.contentComponent=null,this.reactiveState=hl(this.view.state),this.reactiveExtensionStorage=hl(this.extensionStorage),this.on("transaction",()=>{this.reactiveState.value=this.view.state,this.reactiveExtensionStorage.value=this.extensionStorage}),Lc(this)}get state(){return this.reactiveState?this.reactiveState.value:this.view.state}get storage(){return this.reactiveExtensionStorage?this.reactiveExtensionStorage.value:super.storage}registerPlugin(e,t){super.registerPlugin(e,t),this.reactiveState.value=this.view.state}unregisterPlugin(e){super.unregisterPlugin(e),this.reactiveState.value=this.view.state}}const Ay=on({name:"EditorContent",props:{editor:{default:null,type:Object}},setup(n){const e=Qt(),t=zc();return Bc(()=>{const r=n.editor;r&&r.options.element&&e.value&&Rc(()=>{if(!e.value||!r.options.element.firstChild)return;const i=N(e.value);e.value.append(...r.options.element.childNodes),r.contentComponent=t.ctx._,r.setOptions({element:i}),r.createNodeViews()})}),xr(()=>{const r=n.editor;if(!r||(r.isDestroyed||r.view.setProps({nodeViews:{}}),r.contentComponent=null,!r.options.element.firstChild))return;const i=document.createElement("div");i.append(...r.options.element.childNodes),r.setOptions({element:i})}),{rootEl:e}},render(){const n=[];return this.editor&&this.editor.vueRenderers.forEach(e=>{const t=Ut(Ic,{to:e.teleportElement,key:e.id},Ut(e.component,{ref:e.id,...e.props}));n.push(t)}),Ut("div",{ref:e=>{this.rootEl=e}},...n)}});on({name:"FloatingMenu",props:{pluginKey:{type:null,default:"floatingMenu"},editor:{type:Object,required:!0},tippyOptions:{type:Object,default:()=>({})},shouldShow:{type:Function,default:null}},setup(n,{slots:e}){const t=Qt(null);return eo(()=>{const{pluginKey:r,editor:i,tippyOptions:s,shouldShow:o}=n;i.registerPlugin(yc({pluginKey:r,editor:i,element:t.value,tippyOptions:s,shouldShow:o}))}),xr(()=>{const{pluginKey:r,editor:i}=n;i.unregisterPlugin(r)}),()=>{var r;return Ut("div",{ref:t},(r=e.default)===null||r===void 0?void 0:r.call(e))}}});on({props:{as:{type:String,default:"div"}},render(){return Ut(this.as,{style:{whiteSpace:"pre-wrap"},"data-node-view-content":""})}});on({props:{as:{type:String,default:"div"}},inject:["onDragStart","decorationClasses"],render(){var n,e;return Ut(this.as,{class:this.decorationClasses,style:{whiteSpace:"normal"},"data-node-view-wrapper":"",onDragstart:this.onDragStart},(e=(n=this.$slots).default)===null||e===void 0?void 0:e.call(n))}});const wy=(n={})=>{const e=Pc();return eo(()=>{e.value=new Sy(n)}),xr(()=>{var t;(t=e.value)===null||t===void 0||t.destroy()}),e},Oy=/^\s*>\s$/,My=Ae.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:n}){return["blockquote",ge(this.options.HTMLAttributes,n),0]},addCommands(){return{setBlockquote:()=>({commands:n})=>n.wrapIn(this.name),toggleBlockquote:()=>({commands:n})=>n.toggleWrap(this.name),unsetBlockquote:()=>({commands:n})=>n.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Do({find:Oy,type:this.type})]}}),Ty=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))$/,Fy=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))/g,Ny=/(?:^|\s)((?:__)((?:[^__]+))(?:__))$/,By=/(?:^|\s)((?:__)((?:[^__]+))(?:__))/g,Ry=mt.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:n=>n.style.fontWeight!=="normal"&&null},{style:"font-weight",getAttrs:n=>/^(bold(er)?|[5-9]\d{2,})$/.test(n)&&null}]},renderHTML({HTMLAttributes:n}){return["strong",ge(this.options.HTMLAttributes,n),0]},addCommands(){return{setBold:()=>({commands:n})=>n.setMark(this.name),toggleBold:()=>({commands:n})=>n.toggleMark(this.name),unsetBold:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Pn({find:Ty,type:this.type}),Pn({find:Ny,type:this.type})]},addPasteRules(){return[rn({find:Fy,type:this.type}),rn({find:By,type:this.type})]}}),Iy=/^\s*([-+*])\s$/,Py=Ae.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:n}){return["ul",ge(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleBulletList:()=>({commands:n})=>n.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){return[Do({find:Iy,type:this.type})]}}),Ly=/(?:^|\s)((?:`)((?:[^`]+))(?:`))$/,zy=/(?:^|\s)((?:`)((?:[^`]+))(?:`))/g,Vy=mt.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:n}){return["code",ge(this.options.HTMLAttributes,n),0]},addCommands(){return{setCode:()=>({commands:n})=>n.setMark(this.name),toggleCode:()=>({commands:n})=>n.toggleMark(this.name),unsetCode:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Pn({find:Ly,type:this.type})]},addPasteRules(){return[rn({find:zy,type:this.type})]}}),Hy=/^```([a-z]+)?[\s\n]$/,$y=/^~~~([a-z]+)?[\s\n]$/,jy=Ae.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:n=>{var e;const{languageClassPrefix:t}=this.options,s=[...((e=n.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(o=>o.startsWith(t)).map(o=>o.replace(t,""))[0];return s||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:n,HTMLAttributes:e}){return["pre",ge(this.options.HTMLAttributes,e),["code",{class:n.attrs.language?this.options.languageClassPrefix+n.attrs.language:null},0]]},addCommands(){return{setCodeBlock:n=>({commands:e})=>e.setNode(this.name,n),toggleCodeBlock:n=>({commands:e})=>e.toggleNode(this.name,"paragraph",n)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:n,$anchor:e}=this.editor.state.selection,t=e.pos===1;return!n||e.parent.type.name!==this.name?!1:t||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:n})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=n,{selection:t}=e,{$from:r,empty:i}=t;if(!i||r.parent.type!==this.type)return!1;const s=r.parentOffset===r.parent.nodeSize-2,o=r.parent.textContent.endsWith(`

`);return!s||!o?!1:n.chain().command(({tr:a})=>(a.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:n})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=n,{selection:t,doc:r}=e,{$from:i,empty:s}=t;if(!s||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const a=i.after();return a===void 0||r.nodeAt(a)?!1:n.commands.exitCode()}}},addInputRules(){return[qs({find:Hy,type:this.type,getAttributes:n=>({language:n[1]})}),qs({find:$y,type:this.type,getAttributes:n=>({language:n[1]})})]},addProseMirrorPlugins(){return[new ue({key:new Fe("codeBlockVSCodeHandler"),props:{handlePaste:(n,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const t=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),i=r?JSON.parse(r):void 0,s=i==null?void 0:i.mode;if(!t||!s)return!1;const{tr:o}=n.state;return o.replaceSelectionWith(this.type.create({language:s})),o.setSelection(z.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.insertText(t.replace(/\r\n?/g,`
`)),o.setMeta("paste",!0),n.dispatch(o),!0}}})]}}),_y=Ae.create({name:"doc",topNode:!0,content:"block+"});function Wy(n={}){return new ue({view(e){return new Ky(e,n)}})}class Ky{constructor(e,t){this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=t.width||1,this.color=t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(r=>{let i=s=>{this[r](s)};return e.dom.addEventListener(r,i),{name:r,handler:i}})}destroy(){this.handlers.forEach(({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t))}update(e,t){this.cursorPos!=null&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),t;if(!e.parent.inlineContent){let o=e.nodeBefore,a=e.nodeAfter;if(o||a){let l=this.editorView.nodeDOM(this.cursorPos-(o?o.nodeSize:0));if(l){let c=l.getBoundingClientRect(),u=o?c.bottom:c.top;o&&a&&(u=(u+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),t={left:c.left,right:c.right,top:u-this.width/2,bottom:u+this.width/2}}}}if(!t){let o=this.editorView.coordsAtPos(this.cursorPos);t={left:o.left-this.width/2,right:o.left+this.width/2,top:o.top,bottom:o.bottom}}let r=this.editorView.dom.offsetParent;this.element||(this.element=r.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none; background-color: "+this.color);let i,s;if(!r||r==document.body&&getComputedStyle(r).position=="static")i=-pageXOffset,s=-pageYOffset;else{let o=r.getBoundingClientRect();i=o.left-r.scrollLeft,s=o.top-r.scrollTop}this.element.style.left=t.left-i+"px",this.element.style.top=t.top-s+"px",this.element.style.width=t.right-t.left+"px",this.element.style.height=t.bottom-t.top+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),i=r&&r.type.spec.disableDropCursor,s=typeof i=="function"?i(this.editorView,t,e):i;if(t&&!s){let o=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice&&(o=ql(this.editorView.state.doc,o,this.editorView.dragging.slice),o==null))return this.setCursor(null);this.setCursor(o),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){(e.target==this.editorView.dom||!this.editorView.dom.contains(e.relatedTarget))&&this.setCursor(null)}}const Uy=ye.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[Wy(this.options)]}});class ee extends L{constructor(e){super(e,e)}map(e,t){let r=e.resolve(t.map(this.head));return ee.valid(r)?new ee(r):L.near(r)}content(){return w.empty}eq(e){return e instanceof ee&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new ee(e.resolve(t.pos))}getBookmark(){return new Mo(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!qy(e)||!Jy(e))return!1;let r=t.type.spec.allowGapCursor;if(r!=null)return r;let i=t.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,t,r=!1){e:for(;;){if(!r&&ee.valid(e))return e;let i=e.pos,s=null;for(let o=e.depth;;o--){let a=e.node(o);if(t>0?e.indexAfter(o)<a.childCount:e.index(o)>0){s=a.child(t>0?e.indexAfter(o):e.index(o)-1);break}else if(o==0)return null;i+=t;let l=e.doc.resolve(i);if(ee.valid(l))return l}for(;;){let o=t>0?s.firstChild:s.lastChild;if(!o){if(s.isAtom&&!s.isText&&!R.isSelectable(s)){e=e.doc.resolve(i+s.nodeSize*t),r=!1;continue e}break}s=o,i+=t;let a=e.doc.resolve(i);if(ee.valid(a))return a}return null}}}ee.prototype.visible=!1;ee.findFrom=ee.findGapCursorFrom;L.jsonID("gapcursor",ee);class Mo{constructor(e){this.pos=e}map(e){return new Mo(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return ee.valid(t)?new ee(t):L.near(t)}}function qy(n){for(let e=n.depth;e>=0;e--){let t=n.index(e),r=n.node(e);if(t==0){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(t-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function Jy(n){for(let e=n.depth;e>=0;e--){let t=n.indexAfter(e),r=n.node(e);if(t==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(t);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function Gy(){return new ue({props:{decorations:Zy,createSelectionBetween(n,e,t){return e.pos==t.pos&&ee.valid(t)?new ee(t):null},handleClick:Xy,handleKeyDown:Yy,handleDOMEvents:{beforeinput:Qy}}})}const Yy=Nu({ArrowLeft:Kr("horiz",-1),ArrowRight:Kr("horiz",1),ArrowUp:Kr("vert",-1),ArrowDown:Kr("vert",1)});function Kr(n,e){const t=n=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,i,s){let o=r.selection,a=e>0?o.$to:o.$from,l=o.empty;if(o instanceof z){if(!s.endOfTextblock(t)||a.depth==0)return!1;l=!1,a=r.doc.resolve(e>0?a.after():a.before())}let c=ee.findGapCursorFrom(a,e,l);return c?(i&&i(r.tr.setSelection(new ee(c))),!0):!1}}function Xy(n,e,t){if(!n||!n.editable)return!1;let r=n.state.doc.resolve(e);if(!ee.valid(r))return!1;let i=n.posAtCoords({left:t.clientX,top:t.clientY});return i&&i.inside>-1&&R.isSelectable(n.state.doc.nodeAt(i.inside))?!1:(n.dispatch(n.state.tr.setSelection(new ee(r))),!0)}function Qy(n,e){if(e.inputType!="insertCompositionText"||!(n.state.selection instanceof ee))return!1;let{$from:t}=n.state.selection,r=t.parent.contentMatchAt(t.index()).findWrapping(n.state.schema.nodes.text);if(!r)return!1;let i=k.empty;for(let o=r.length-1;o>=0;o--)i=k.from(r[o].createAndFill(null,i));let s=n.state.tr.replace(t.pos,t.pos,new w(i,0,0));return s.setSelection(z.near(s.doc.resolve(t.pos+1))),n.dispatch(s),!1}function Zy(n){if(!(n.selection instanceof ee))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",te.create(n.doc,[Te.widget(n.selection.head,e,{key:"gapcursor"})])}const ev=ye.create({name:"gapCursor",addProseMirrorPlugins(){return[Gy()]},extendNodeSchema(n){var e;const t={name:n.name,options:n.options,storage:n.storage};return{allowGapCursor:(e=P(O(n,"allowGapCursor",t)))!==null&&e!==void 0?e:null}}}),tv=Ae.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:n}){return["br",ge(this.options.HTMLAttributes,n)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:n,chain:e,state:t,editor:r})=>n.first([()=>n.exitCode(),()=>n.command(()=>{const{selection:i,storedMarks:s}=t;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:a}=r.extensionManager,l=s||i.$to.parentOffset&&i.$from.marks();return e().insertContent({type:this.name}).command(({tr:c,dispatch:u})=>{if(u&&l&&o){const d=l.filter(f=>a.includes(f.type.name));c.ensureMarks(d)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),nv=Ae.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(n=>({tag:`h${n}`,attrs:{level:n}}))},renderHTML({node:n,HTMLAttributes:e}){return[`h${this.options.levels.includes(n.attrs.level)?n.attrs.level:this.options.levels[0]}`,ge(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.setNode(this.name,n):!1,toggleHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.toggleNode(this.name,"paragraph",n):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((n,e)=>({...n,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(n=>qs({find:new RegExp(`^(#{1,${n}})\\s$`),type:this.type,getAttributes:{level:n}}))}});var pi=200,fe=function(){};fe.prototype.append=function(e){return e.length?(e=fe.from(e),!this.length&&e||e.length<pi&&this.leafAppend(e)||this.length<pi&&e.leafPrepend(this)||this.appendInner(e)):this};fe.prototype.prepend=function(e){return e.length?fe.from(e).append(this):this};fe.prototype.appendInner=function(e){return new rv(this,e)};fe.prototype.slice=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=this.length),e>=t?fe.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))};fe.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};fe.prototype.forEach=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length),t<=r?this.forEachInner(e,t,r,0):this.forEachInvertedInner(e,t,r,0)};fe.prototype.map=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length);var i=[];return this.forEach(function(s,o){return i.push(e(s,o))},t,r),i};fe.from=function(e){return e instanceof fe?e:e&&e.length?new vc(e):fe.empty};var vc=function(n){function e(r){n.call(this),this.values=r}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(i,s){return i==0&&s==this.length?this:new e(this.values.slice(i,s))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(i,s,o,a){for(var l=s;l<o;l++)if(i(this.values[l],a+l)===!1)return!1},e.prototype.forEachInvertedInner=function(i,s,o,a){for(var l=s-1;l>=o;l--)if(i(this.values[l],a+l)===!1)return!1},e.prototype.leafAppend=function(i){if(this.length+i.length<=pi)return new e(this.values.concat(i.flatten()))},e.prototype.leafPrepend=function(i){if(this.length+i.length<=pi)return new e(i.flatten().concat(this.values))},t.length.get=function(){return this.values.length},t.depth.get=function(){return 0},Object.defineProperties(e.prototype,t),e}(fe);fe.empty=new vc([]);var rv=function(n){function e(t,r){n.call(this),this.left=t,this.right=r,this.length=t.length+r.length,this.depth=Math.max(t.depth,r.depth)+1}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,i,s,o){var a=this.left.length;if(i<a&&this.left.forEachInner(r,i,Math.min(s,a),o)===!1||s>a&&this.right.forEachInner(r,Math.max(i-a,0),Math.min(this.length,s)-a,o+a)===!1)return!1},e.prototype.forEachInvertedInner=function(r,i,s,o){var a=this.left.length;if(i>a&&this.right.forEachInvertedInner(r,i-a,Math.max(s,a)-a,o+a)===!1||s<a&&this.left.forEachInvertedInner(r,Math.min(i,a),s,o)===!1)return!1},e.prototype.sliceInner=function(r,i){if(r==0&&i==this.length)return this;var s=this.left.length;return i<=s?this.left.slice(r,i):r>=s?this.right.slice(r-s,i-s):this.left.slice(r,s).append(this.right.slice(0,i-s))},e.prototype.leafAppend=function(r){var i=this.right.leafAppend(r);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(r){var i=this.left.leafPrepend(r);if(i)return new e(i,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(fe),bc=fe;const iv=500;class je{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let i,s;t&&(i=this.remapping(r,this.items.length),s=i.maps.length);let o=e.tr,a,l,c=[],u=[];return this.items.forEach((d,f)=>{if(!d.step){i||(i=this.remapping(r,f+1),s=i.maps.length),s--,u.push(d);return}if(i){u.push(new Je(d.map));let h=d.step.map(i.slice(s)),p;h&&o.maybeStep(h).doc&&(p=o.mapping.maps[o.mapping.maps.length-1],c.push(new Je(p,void 0,void 0,c.length+u.length))),s--,p&&i.appendMap(p,s)}else o.maybeStep(d.step);if(d.selection)return a=i?d.selection.map(i.slice(s)):d.selection,l=new je(this.items.slice(0,r).append(u.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:o,selection:a}}addTransform(e,t,r,i){let s=[],o=this.eventCount,a=this.items,l=!i&&a.length?a.get(a.length-1):null;for(let u=0;u<e.steps.length;u++){let d=e.steps[u].invert(e.docs[u]),f=new Je(e.mapping.maps[u],d,t),h;(h=l&&l.merge(f))&&(f=h,u?s.pop():a=a.slice(0,a.length-1)),s.push(f),t&&(o++,t=void 0),i||(l=f)}let c=o-r.depth;return c>ov&&(a=sv(a,c),o-=c),new je(a.append(s),o)}remapping(e,t){let r=new An;return this.items.forEach((i,s)=>{let o=i.mirrorOffset!=null&&s-i.mirrorOffset>=e?r.maps.length-i.mirrorOffset:void 0;r.appendMap(i.map,o)},e,t),r}addMaps(e){return this.eventCount==0?this:new je(this.items.append(e.map(t=>new Je(t))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let r=[],i=Math.max(0,this.items.length-t),s=e.mapping,o=e.steps.length,a=this.eventCount;this.items.forEach(f=>{f.selection&&a--},i);let l=t;this.items.forEach(f=>{let h=s.getMirror(--l);if(h==null)return;o=Math.min(o,h);let p=s.maps[h];if(f.step){let m=e.steps[h].invert(e.docs[h]),y=f.selection&&f.selection.map(s.slice(l+1,h));y&&a++,r.push(new Je(p,m,y))}else r.push(new Je(p))},i);let c=[];for(let f=t;f<o;f++)c.push(new Je(s.maps[f]));let u=this.items.slice(0,i).append(c).append(r),d=new je(u,a);return d.emptyItemCount()>iv&&(d=d.compress(this.items.length-r.length)),d}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),r=t.maps.length,i=[],s=0;return this.items.forEach((o,a)=>{if(a>=e)i.push(o),o.selection&&s++;else if(o.step){let l=o.step.map(t.slice(r)),c=l&&l.getMap();if(r--,c&&t.appendMap(c,r),l){let u=o.selection&&o.selection.map(t.slice(r));u&&s++;let d=new Je(c.invert(),l,u),f,h=i.length-1;(f=i.length&&i[h].merge(d))?i[h]=f:i.push(d)}}else o.map&&r--},this.items.length,0),new je(bc.from(i.reverse()),s)}}je.empty=new je(bc.empty,0);function sv(n,e){let t;return n.forEach((r,i)=>{if(r.selection&&e--==0)return t=i,!1}),n.slice(t)}class Je{constructor(e,t,r,i){this.map=e,this.step=t,this.selection=r,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new Je(t.getMap().invert(),t,this.selection)}}}class kt{constructor(e,t,r,i){this.done=e,this.undone=t,this.prevRanges=r,this.prevTime=i}}const ov=20;function av(n,e,t,r){let i=t.getMeta(Tt),s;if(i)return i.historyState;t.getMeta(uv)&&(n=new kt(n.done,n.undone,null,0));let o=t.getMeta("appendedTransaction");if(t.steps.length==0)return n;if(o&&o.getMeta(Tt))return o.getMeta(Tt).redo?new kt(n.done.addTransform(t,void 0,r,Yr(e)),n.undone,pl(t.mapping.maps[t.steps.length-1]),n.prevTime):new kt(n.done,n.undone.addTransform(t,void 0,r,Yr(e)),null,n.prevTime);if(t.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let a=n.prevTime==0||!o&&(n.prevTime<(t.time||0)-r.newGroupDelay||!lv(t,n.prevRanges)),l=o?xs(n.prevRanges,t.mapping):pl(t.mapping.maps[t.steps.length-1]);return new kt(n.done.addTransform(t,a?e.selection.getBookmark():void 0,r,Yr(e)),je.empty,l,t.time)}else return(s=t.getMeta("rebased"))?new kt(n.done.rebased(t,s),n.undone.rebased(t,s),xs(n.prevRanges,t.mapping),n.prevTime):new kt(n.done.addMaps(t.mapping.maps),n.undone.addMaps(t.mapping.maps),xs(n.prevRanges,t.mapping),n.prevTime)}function lv(n,e){if(!e)return!1;if(!n.docChanged)return!0;let t=!1;return n.mapping.maps[0].forEach((r,i)=>{for(let s=0;s<e.length;s+=2)r<=e[s+1]&&i>=e[s]&&(t=!0)}),t}function pl(n){let e=[];return n.forEach((t,r,i,s)=>e.push(i,s)),e}function xs(n,e){if(!n)return null;let t=[];for(let r=0;r<n.length;r+=2){let i=e.map(n[r],1),s=e.map(n[r+1],-1);i<=s&&t.push(i,s)}return t}function Dc(n,e,t,r){let i=Yr(e),s=Tt.get(e).spec.config,o=(r?n.undone:n.done).popEvent(e,i);if(!o)return;let a=o.selection.resolve(o.transform.doc),l=(r?n.done:n.undone).addTransform(o.transform,e.selection.getBookmark(),s,i),c=new kt(r?l:o.remaining,r?o.remaining:l,null,0);t(o.transform.setSelection(a).setMeta(Tt,{redo:r,historyState:c}).scrollIntoView())}let Ss=!1,ml=null;function Yr(n){let e=n.plugins;if(ml!=e){Ss=!1,ml=e;for(let t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){Ss=!0;break}}return Ss}const Tt=new Fe("history"),uv=new Fe("closeHistory");function cv(n={}){return n={depth:n.depth||100,newGroupDelay:n.newGroupDelay||500},new ue({key:Tt,state:{init(){return new kt(je.empty,je.empty,null,0)},apply(e,t,r){return av(t,r,e,n)}},config:n,props:{handleDOMEvents:{beforeinput(e,t){let r=t.inputType,i=r=="historyUndo"?Cc:r=="historyRedo"?kc:null;return i?(t.preventDefault(),i(e.state,e.dispatch)):!1}}}})}const Cc=(n,e)=>{let t=Tt.getState(n);return!t||t.done.eventCount==0?!1:(e&&Dc(t,n,e,!1),!0)},kc=(n,e)=>{let t=Tt.getState(n);return!t||t.undone.eventCount==0?!1:(e&&Dc(t,n,e,!0),!0)},dv=ye.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:n,dispatch:e})=>Cc(n,e),redo:()=>({state:n,dispatch:e})=>kc(n,e)}},addProseMirrorPlugins(){return[cv(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Mod-y":()=>this.editor.commands.redo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-я":()=>this.editor.commands.undo(),"Shift-Mod-я":()=>this.editor.commands.redo()}}}),fv=Ae.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:n}){return["hr",ge(this.options.HTMLAttributes,n)]},addCommands(){return{setHorizontalRule:()=>({chain:n})=>n().insertContent({type:this.name}).command(({tr:e,dispatch:t})=>{var r;if(t){const{$to:i}=e.selection,s=i.end();if(i.nodeAfter)e.setSelection(z.create(e.doc,i.pos));else{const o=(r=i.parent.type.contentMatch.defaultType)===null||r===void 0?void 0:r.create();o&&(e.insert(s,o),e.setSelection(z.create(e.doc,s)))}e.scrollIntoView()}return!0}).run()}},addInputRules(){return[Jm({find:/^(?:---|—-|___\s|\*\*\*\s)$/,type:this.type})]}}),hv=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/,pv=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))/g,mv=/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/,gv=/(?:^|\s)((?:_)((?:[^_]+))(?:_))/g,yv=mt.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:n=>n.style.fontStyle!=="normal"&&null},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:n}){return["em",ge(this.options.HTMLAttributes,n),0]},addCommands(){return{setItalic:()=>({commands:n})=>n.setMark(this.name),toggleItalic:()=>({commands:n})=>n.toggleMark(this.name),unsetItalic:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Pn({find:hv,type:this.type}),Pn({find:mv,type:this.type})]},addPasteRules(){return[rn({find:pv,type:this.type}),rn({find:gv,type:this.type})]}}),vv=Ae.create({name:"listItem",addOptions(){return{HTMLAttributes:{}}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",ge(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),bv=/^(\d+)\.\s$/,Dv=Ae.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:n=>n.hasAttribute("start")?parseInt(n.getAttribute("start")||"",10):1}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:n}){const{start:e,...t}=n;return e===1?["ol",ge(this.options.HTMLAttributes,t),0]:["ol",ge(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleOrderedList:()=>({commands:n})=>n.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){return[Do({find:bv,type:this.type,getAttributes:n=>({start:+n[1]}),joinPredicate:(n,e)=>e.childCount+e.attrs.start===+n[1]})]}}),Cv=Ae.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:n}){return["p",ge(this.options.HTMLAttributes,n),0]},addCommands(){return{setParagraph:()=>({commands:n})=>n.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),kv=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))$/,Ev=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))/g,xv=mt.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["s",ge(this.options.HTMLAttributes,n),0]},addCommands(){return{setStrike:()=>({commands:n})=>n.setMark(this.name),toggleStrike:()=>({commands:n})=>n.toggleMark(this.name),unsetStrike:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-x":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Pn({find:kv,type:this.type})]},addPasteRules(){return[rn({find:Ev,type:this.type})]}}),Sv=Ae.create({name:"text",group:"inline"}),Av=ye.create({name:"starterKit",addExtensions(){var n,e,t,r,i,s,o,a,l,c,u,d,f,h,p,m,y,v;const b=[];return this.options.blockquote!==!1&&b.push(My.configure((n=this.options)===null||n===void 0?void 0:n.blockquote)),this.options.bold!==!1&&b.push(Ry.configure((e=this.options)===null||e===void 0?void 0:e.bold)),this.options.bulletList!==!1&&b.push(Py.configure((t=this.options)===null||t===void 0?void 0:t.bulletList)),this.options.code!==!1&&b.push(Vy.configure((r=this.options)===null||r===void 0?void 0:r.code)),this.options.codeBlock!==!1&&b.push(jy.configure((i=this.options)===null||i===void 0?void 0:i.codeBlock)),this.options.document!==!1&&b.push(_y.configure((s=this.options)===null||s===void 0?void 0:s.document)),this.options.dropcursor!==!1&&b.push(Uy.configure((o=this.options)===null||o===void 0?void 0:o.dropcursor)),this.options.gapcursor!==!1&&b.push(ev.configure((a=this.options)===null||a===void 0?void 0:a.gapcursor)),this.options.hardBreak!==!1&&b.push(tv.configure((l=this.options)===null||l===void 0?void 0:l.hardBreak)),this.options.heading!==!1&&b.push(nv.configure((c=this.options)===null||c===void 0?void 0:c.heading)),this.options.history!==!1&&b.push(dv.configure((u=this.options)===null||u===void 0?void 0:u.history)),this.options.horizontalRule!==!1&&b.push(fv.configure((d=this.options)===null||d===void 0?void 0:d.horizontalRule)),this.options.italic!==!1&&b.push(yv.configure((f=this.options)===null||f===void 0?void 0:f.italic)),this.options.listItem!==!1&&b.push(vv.configure((h=this.options)===null||h===void 0?void 0:h.listItem)),this.options.orderedList!==!1&&b.push(Dv.configure((p=this.options)===null||p===void 0?void 0:p.orderedList)),this.options.paragraph!==!1&&b.push(Cv.configure((m=this.options)===null||m===void 0?void 0:m.paragraph)),this.options.strike!==!1&&b.push(xv.configure((y=this.options)===null||y===void 0?void 0:y.strike)),this.options.text!==!1&&b.push(Sv.configure((v=this.options)===null||v===void 0?void 0:v.text)),b}}),wv=ye.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something …",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new ue({props:{decorations:({doc:n,selection:e})=>{const t=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=e,i=[];if(!t)return null;const s=n.type.createAndFill(),o=(s==null?void 0:s.sameMarkup(n))&&s.content.findDiffStart(n.content)===null;return n.descendants((a,l)=>{const c=r>=l&&r<=l+a.nodeSize,u=!a.isLeaf&&!a.childCount;if((c||!this.options.showOnlyCurrent)&&u){const d=[this.options.emptyNodeClass];o&&d.push(this.options.emptyEditorClass);const f=Te.node(l,l+a.nodeSize,{class:d.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:a,pos:l,hasAnchor:c}):this.options.placeholder});i.push(f)}return this.options.includeChildren}),te.create(n,i)}}})]}});function To(n){this.j={},this.jr=[],this.jd=null,this.t=n}To.prototype={accepts:function(){return!!this.t},tt:function(e,t){if(t&&t.j)return this.j[e]=t,t;var r=t,i=this.j[e];if(i)return r&&(i.t=r),i;i=K();var s=mi(this,e);return s?(Object.assign(i.j,s.j),i.jr.append(s.jr),i.jr=s.jd,i.t=r||s.t):i.t=r,this.j[e]=i,i}};var K=function(){return new To},B=function(e){return new To(e)},x=function(e,t,r){e.j[t]||(e.j[t]=r)},se=function(e,t,r){e.jr.push([t,r])},mi=function(e,t){var r=e.j[t];if(r)return r;for(var i=0;i<e.jr.length;i++){var s=e.jr[i][0],o=e.jr[i][1];if(s.test(t))return o}return e.jd},H=function(e,t,r){for(var i=0;i<t.length;i++)x(e,t[i],r)},Ov=function(e,t){for(var r=0;r<t.length;r++){var i=t[r][0],s=t[r][1];x(e,i,s)}},Ht=function(e,t,r,i){for(var s=0,o=t.length,a;s<o&&(a=e.j[t[s]]);)e=a,s++;if(s>=o)return[];for(;s<o-1;)a=i(),x(e,t[s],a),e=a,s++;x(e,t[o-1],r)},$e="DOMAIN",ut="LOCALHOST",Ge="TLD",Be="NUM",$n="PROTOCOL",Fo="MAILTO",Ec="WS",No="NL",Cn="OPENBRACE",pr="OPENBRACKET",mr="OPENANGLEBRACKET",gr="OPENPAREN",Wt="CLOSEBRACE",kn="CLOSEBRACKET",En="CLOSEANGLEBRACKET",xn="CLOSEPAREN",gi="AMPERSAND",yi="APOSTROPHE",vi="ASTERISK",Sn="AT",bi="BACKSLASH",Di="BACKTICK",Ci="CARET",yr="COLON",Bo="COMMA",ki="DOLLAR",Et="DOT",Ei="EQUALS",Ro="EXCLAMATION",xi="HYPHEN",Si="PERCENT",Ai="PIPE",wi="PLUS",Oi="POUND",Mi="QUERY",Io="QUOTE",Po="SEMI",ct="SLASH",Ti="TILDE",Fi="UNDERSCORE",Ni="SYM",Mv=Object.freeze({__proto__:null,DOMAIN:$e,LOCALHOST:ut,TLD:Ge,NUM:Be,PROTOCOL:$n,MAILTO:Fo,WS:Ec,NL:No,OPENBRACE:Cn,OPENBRACKET:pr,OPENANGLEBRACKET:mr,OPENPAREN:gr,CLOSEBRACE:Wt,CLOSEBRACKET:kn,CLOSEANGLEBRACKET:En,CLOSEPAREN:xn,AMPERSAND:gi,APOSTROPHE:yi,ASTERISK:vi,AT:Sn,BACKSLASH:bi,BACKTICK:Di,CARET:Ci,COLON:yr,COMMA:Bo,DOLLAR:ki,DOT:Et,EQUALS:Ei,EXCLAMATION:Ro,HYPHEN:xi,PERCENT:Si,PIPE:Ai,PLUS:wi,POUND:Oi,QUERY:Mi,QUOTE:Io,SEMI:Po,SLASH:ct,TILDE:Ti,UNDERSCORE:Fi,SYM:Ni}),gl="aaa aarp abarth abb abbott abbvie abc able abogado abudhabi ac academy accenture accountant accountants aco actor ad adac ads adult ae aeg aero aetna af afamilycompany afl africa ag agakhan agency ai aig airbus airforce airtel akdn al alfaromeo alibaba alipay allfinanz allstate ally alsace alstom am amazon americanexpress americanfamily amex amfam amica amsterdam analytics android anquan anz ao aol apartments app apple aq aquarelle ar arab aramco archi army arpa art arte as asda asia associates at athleta attorney au auction audi audible audio auspost author auto autos avianca aw aws ax axa az azure ba baby baidu banamex bananarepublic band bank bar barcelona barclaycard barclays barefoot bargains baseball basketball bauhaus bayern bb bbc bbt bbva bcg bcn bd be beats beauty beer bentley berlin best bestbuy bet bf bg bh bharti bi bible bid bike bing bingo bio biz bj black blackfriday blockbuster blog bloomberg blue bm bms bmw bn bnpparibas bo boats boehringer bofa bom bond boo book booking bosch bostik boston bot boutique box br bradesco bridgestone broadway broker brother brussels bs bt budapest bugatti build builders business buy buzz bv bw by bz bzh ca cab cafe cal call calvinklein cam camera camp cancerresearch canon capetown capital capitalone car caravan cards care career careers cars casa case cash casino cat catering catholic cba cbn cbre cbs cc cd center ceo cern cf cfa cfd cg ch chanel channel charity chase chat cheap chintai christmas chrome church ci cipriani circle cisco citadel citi citic city cityeats ck cl claims cleaning click clinic clinique clothing cloud club clubmed cm cn co coach codes coffee college cologne com comcast commbank community company compare computer comsec condos construction consulting contact contractors cooking cookingchannel cool coop corsica country coupon coupons courses cpa cr credit creditcard creditunion cricket crown crs cruise cruises csc cu cuisinella cv cw cx cy cymru cyou cz dabur dad dance data date dating datsun day dclk dds de deal dealer deals degree delivery dell deloitte delta democrat dental dentist desi design dev dhl diamonds diet digital direct directory discount discover dish diy dj dk dm dnp do docs doctor dog domains dot download drive dtv dubai duck dunlop dupont durban dvag dvr dz earth eat ec eco edeka edu education ee eg email emerck energy engineer engineering enterprises epson equipment er ericsson erni es esq estate et etisalat eu eurovision eus events exchange expert exposed express extraspace fage fail fairwinds faith family fan fans farm farmers fashion fast fedex feedback ferrari ferrero fi fiat fidelity fido film final finance financial fire firestone firmdale fish fishing fit fitness fj fk flickr flights flir florist flowers fly fm fo foo food foodnetwork football ford forex forsale forum foundation fox fr free fresenius frl frogans frontdoor frontier ftr fujitsu fujixerox fun fund furniture futbol fyi ga gal gallery gallo gallup game games gap garden gay gb gbiz gd gdn ge gea gent genting george gf gg ggee gh gi gift gifts gives giving gl glade glass gle global globo gm gmail gmbh gmo gmx gn godaddy gold goldpoint golf goo goodyear goog google gop got gov gp gq gr grainger graphics gratis green gripe grocery group gs gt gu guardian gucci guge guide guitars guru gw gy hair hamburg hangout haus hbo hdfc hdfcbank health healthcare help helsinki here hermes hgtv hiphop hisamitsu hitachi hiv hk hkt hm hn hockey holdings holiday homedepot homegoods homes homesense honda horse hospital host hosting hot hoteles hotels hotmail house how hr hsbc ht hu hughes hyatt hyundai ibm icbc ice icu id ie ieee ifm ikano il im imamat imdb immo immobilien in inc industries infiniti info ing ink institute insurance insure int international intuit investments io ipiranga iq ir irish is ismaili ist istanbul it itau itv iveco jaguar java jcb je jeep jetzt jewelry jio jll jm jmp jnj jo jobs joburg jot joy jp jpmorgan jprs juegos juniper kaufen kddi ke kerryhotels kerrylogistics kerryproperties kfh kg kh ki kia kim kinder kindle kitchen kiwi km kn koeln komatsu kosher kp kpmg kpn kr krd kred kuokgroup kw ky kyoto kz la lacaixa lamborghini lamer lancaster lancia land landrover lanxess lasalle lat latino latrobe law lawyer lb lc lds lease leclerc lefrak legal lego lexus lgbt li lidl life lifeinsurance lifestyle lighting like lilly limited limo lincoln linde link lipsy live living lixil lk llc llp loan loans locker locus loft lol london lotte lotto love lpl lplfinancial lr ls lt ltd ltda lu lundbeck luxe luxury lv ly ma macys madrid maif maison makeup man management mango map market marketing markets marriott marshalls maserati mattel mba mc mckinsey md me med media meet melbourne meme memorial men menu merckmsd mg mh miami microsoft mil mini mint mit mitsubishi mk ml mlb mls mm mma mn mo mobi mobile moda moe moi mom monash money monster mormon mortgage moscow moto motorcycles mov movie mp mq mr ms msd mt mtn mtr mu museum mutual mv mw mx my mz na nab nagoya name nationwide natura navy nba nc ne nec net netbank netflix network neustar new news next nextdirect nexus nf nfl ng ngo nhk ni nico nike nikon ninja nissan nissay nl no nokia northwesternmutual norton now nowruz nowtv np nr nra nrw ntt nu nyc nz obi observer off office okinawa olayan olayangroup oldnavy ollo om omega one ong onl online onyourside ooo open oracle orange org organic origins osaka otsuka ott ovh pa page panasonic paris pars partners parts party passagens pay pccw pe pet pf pfizer pg ph pharmacy phd philips phone photo photography photos physio pics pictet pictures pid pin ping pink pioneer pizza pk pl place play playstation plumbing plus pm pn pnc pohl poker politie porn post pr pramerica praxi press prime pro prod productions prof progressive promo properties property protection pru prudential ps pt pub pw pwc py qa qpon quebec quest qvc racing radio raid re read realestate realtor realty recipes red redstone redumbrella rehab reise reisen reit reliance ren rent rentals repair report republican rest restaurant review reviews rexroth rich richardli ricoh ril rio rip rmit ro rocher rocks rodeo rogers room rs rsvp ru rugby ruhr run rw rwe ryukyu sa saarland safe safety sakura sale salon samsclub samsung sandvik sandvikcoromant sanofi sap sarl sas save saxo sb sbi sbs sc sca scb schaeffler schmidt scholarships school schule schwarz science scjohnson scot sd se search seat secure security seek select sener services ses seven sew sex sexy sfr sg sh shangrila sharp shaw shell shia shiksha shoes shop shopping shouji show showtime si silk sina singles site sj sk ski skin sky skype sl sling sm smart smile sn sncf so soccer social softbank software sohu solar solutions song sony soy spa space sport spot spreadbetting sr srl ss st stada staples star statebank statefarm stc stcgroup stockholm storage store stream studio study style su sucks supplies supply support surf surgery suzuki sv swatch swiftcover swiss sx sy sydney systems sz tab taipei talk taobao target tatamotors tatar tattoo tax taxi tc tci td tdk team tech technology tel temasek tennis teva tf tg th thd theater theatre tiaa tickets tienda tiffany tips tires tirol tj tjmaxx tjx tk tkmaxx tl tm tmall tn to today tokyo tools top toray toshiba total tours town toyota toys tr trade trading training travel travelchannel travelers travelersinsurance trust trv tt tube tui tunes tushu tv tvs tw tz ua ubank ubs ug uk unicom university uno uol ups us uy uz va vacations vana vanguard vc ve vegas ventures verisign versicherung vet vg vi viajes video vig viking villas vin vip virgin visa vision viva vivo vlaanderen vn vodka volkswagen volvo vote voting voto voyage vu vuelos wales walmart walter wang wanggou watch watches weather weatherchannel webcam weber website wed wedding weibo weir wf whoswho wien wiki williamhill win windows wine winners wme wolterskluwer woodside work works world wow ws wtc wtf xbox xerox xfinity xihuan xin xxx xyz yachts yahoo yamaxun yandex ye yodobashi yoga yokohama you youtube yt yun za zappos zara zero zip zm zone zuerich zw vermögensberater-ctb vermögensberatung-pwb ελ ευ бг бел дети ею католик ком қаз мкд мон москва онлайн орг рус рф сайт срб укр გე հայ ישראל קום ابوظبي اتصالات ارامكو الاردن البحرين الجزائر السعودية العليان المغرب امارات ایران بارت بازار بھارت بيتك پاکستان ڀارت تونس سودان سورية شبكة عراق عرب عمان فلسطين قطر كاثوليك كوم مصر مليسيا موريتانيا موقع همراه कॉम नेट भारत भारतम् भारोत संगठन বাংলা ভারত ভাৰত ਭਾਰਤ ભારત ଭାରତ இந்தியா இலங்கை சிங்கப்பூர் భారత్ ಭಾರತ ഭാരതം ලංකා คอม ไทย ລາວ 닷넷 닷컴 삼성 한국 アマゾン グーグル クラウド コム ストア セール ファッション ポイント みんな 世界 中信 中国 中國 中文网 亚马逊 企业 佛山 信息 健康 八卦 公司 公益 台湾 台灣 商城 商店 商标 嘉里 嘉里大酒店 在线 大众汽车 大拿 天主教 娱乐 家電 广东 微博 慈善 我爱你 手机 招聘 政务 政府 新加坡 新闻 时尚 書籍 机构 淡马锡 游戏 澳門 点看 移动 组织机构 网址 网店 网站 网络 联通 诺基亚 谷歌 购物 通販 集团 電訊盈科 飞利浦 食品 餐厅 香格里拉 香港".split(" "),er=/(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])/,tr=/(?:[#\*0-9\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26A7\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDED5-\uDED7\uDEDD-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDDFF\uDE70-\uDE74\uDE78-\uDE7C\uDE80-\uDE86\uDE90-\uDEAC\uDEB0-\uDEBA\uDEC0-\uDEC5\uDED0-\uDED9\uDEE0-\uDEE7\uDEF0-\uDEF6])/,nr=/\uFE0F/,rr=/\d/,yl=/\s/;function Tv(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=K(),t=B(Be),r=B($e),i=K(),s=B(Ec),o=[[rr,r],[er,r],[tr,r],[nr,r]],a=function(){var g=B($e);return g.j={"-":i},g.jr=[].concat(o),g},l=function(g){var A=a();return A.t=g,A};Ov(e,[["'",B(yi)],["{",B(Cn)],["[",B(pr)],["<",B(mr)],["(",B(gr)],["}",B(Wt)],["]",B(kn)],[">",B(En)],[")",B(xn)],["&",B(gi)],["*",B(vi)],["@",B(Sn)],["`",B(Di)],["^",B(Ci)],[":",B(yr)],[",",B(Bo)],["$",B(ki)],[".",B(Et)],["=",B(Ei)],["!",B(Ro)],["-",B(xi)],["%",B(Si)],["|",B(Ai)],["+",B(wi)],["#",B(Oi)],["?",B(Mi)],['"',B(Io)],["/",B(ct)],[";",B(Po)],["~",B(Ti)],["_",B(Fi)],["\\",B(bi)]]),x(e,`
`,B(No)),se(e,yl,s),x(s,`
`,K()),se(s,yl,s);for(var c=0;c<gl.length;c++)Ht(e,gl[c],l(Ge),a);var u=a(),d=a(),f=a(),h=a();Ht(e,"file",u,a),Ht(e,"ftp",d,a),Ht(e,"http",f,a),Ht(e,"mailto",h,a);var p=a(),m=B($n),y=B(Fo);x(d,"s",p),x(d,":",m),x(f,"s",p),x(f,":",m),x(u,":",m),x(p,":",m),x(h,":",y);for(var v=a(),b=0;b<n.length;b++)Ht(e,n[b],v,a);return x(v,":",m),Ht(e,"localhost",l(ut),a),se(e,rr,t),se(e,er,r),se(e,tr,r),se(e,nr,r),se(t,rr,t),se(t,er,r),se(t,tr,r),se(t,nr,r),x(t,"-",i),x(r,"-",i),x(i,"-",i),se(r,rr,r),se(r,er,r),se(r,tr,r),se(r,nr,r),se(i,rr,r),se(i,er,r),se(i,tr,r),se(i,nr,r),e.jd=B(Ni),e}function Fv(n,e){for(var t=Nv(e.replace(/[A-Z]/g,function(h){return h.toLowerCase()})),r=t.length,i=[],s=0,o=0;o<r;){for(var a=n,l=null,c=0,u=null,d=-1,f=-1;o<r&&(l=mi(a,t[o]));)a=l,a.accepts()?(d=0,f=0,u=a):d>=0&&(d+=t[o].length,f++),c+=t[o].length,s+=t[o].length,o++;s-=d,o-=f,c-=d,i.push({t:u.t,v:e.substr(s-c,c),s:s-c,e:s})}return i}function Nv(n){for(var e=[],t=n.length,r=0;r<t;){var i=n.charCodeAt(r),s=void 0,o=i<55296||i>56319||r+1===t||(s=n.charCodeAt(r+1))<56320||s>57343?n[r]:n.slice(r,r+2);e.push(o),r+=o.length}return e}function Xr(n){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Xr=function(e){return typeof e}:Xr=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xr(n)}var he={defaultProtocol:"http",events:null,format:vl,formatHref:vl,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:0,className:null,attributes:null,ignoreTags:[]};function Bv(n){n=n||{},this.defaultProtocol="defaultProtocol"in n?n.defaultProtocol:he.defaultProtocol,this.events="events"in n?n.events:he.events,this.format="format"in n?n.format:he.format,this.formatHref="formatHref"in n?n.formatHref:he.formatHref,this.nl2br="nl2br"in n?n.nl2br:he.nl2br,this.tagName="tagName"in n?n.tagName:he.tagName,this.target="target"in n?n.target:he.target,this.rel="rel"in n?n.rel:he.rel,this.validate="validate"in n?n.validate:he.validate,this.truncate="truncate"in n?n.truncate:he.truncate,this.className="className"in n?n.className:he.className,this.attributes=n.attributes||he.attributes,this.ignoreTags=[];for(var e=("ignoreTags"in n)?n.ignoreTags:he.ignoreTags,t=0;t<e.length;t++)this.ignoreTags.push(e[t].toUpperCase())}Bv.prototype={resolve:function(e){var t=e.toHref(this.defaultProtocol);return{formatted:this.get("format",e.toString(),e),formattedHref:this.get("formatHref",t,e),tagName:this.get("tagName",t,e),className:this.get("className",t,e),target:this.get("target",t,e),rel:this.get("rel",t,e),events:this.getObject("events",t,e),attributes:this.getObject("attributes",t,e),truncate:this.get("truncate",t,e)}},check:function(e){return this.get("validate",e.toString(),e)},get:function(e,t,r){var i=this[e];if(!i)return i;var s;switch(Xr(i)){case"function":return i(t,r.t);case"object":return s=r.t in i?i[r.t]:he[e],typeof s=="function"?s(t,r.t):s}return i},getObject:function(e,t,r){var i=this[e];return typeof i=="function"?i(t,r.t):i}};function vl(n){return n}function Rv(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=Object.create(n.prototype);for(var i in t)r[i]=t[i];return r.constructor=e,e.prototype=r,e}function Bi(){}Bi.prototype={t:"token",isLink:!1,toString:function(){return this.v},toHref:function(){return this.toString()},startIndex:function(){return this.tk[0].s},endIndex:function(){return this.tk[this.tk.length-1].e},toObject:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:he.defaultProtocol;return{type:this.t,value:this.v,isLink:this.isLink,href:this.toHref(e),start:this.startIndex(),end:this.endIndex()}}};function an(n,e){function t(r,i){this.t=n,this.v=r,this.tk=i}return Rv(Bi,t,e),t}var xc=an("email",{isLink:!0}),Qs=an("email",{isLink:!0,toHref:function(){return"mailto:"+this.toString()}}),Zs=an("text"),Sc=an("nl"),Ct=an("url",{isLink:!0,toHref:function(){for(var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:he.defaultProtocol,t=this.tk,r=!1,i=!1,s=[],o=0;t[o].t===$n;)r=!0,s.push(t[o].v),o++;for(;t[o].t===ct;)i=!0,s.push(t[o].v),o++;for(;o<t.length;o++)s.push(t[o].v);return s=s.join(""),r||i||(s="".concat(e,"://").concat(s)),s},hasProtocol:function(){return this.tk[0].t===$n}}),Iv=Object.freeze({__proto__:null,MultiToken:Bi,Base:Bi,createTokenClass:an,MailtoEmail:xc,Email:Qs,Text:Zs,Nl:Sc,Url:Ct});function Pv(){var n=K(),e=K(),t=K(),r=K(),i=K(),s=K(),o=K(),a=B(Ct),l=K(),c=B(Ct),u=B(Ct),d=K(),f=K(),h=K(),p=K(),m=K(),y=B(Ct),v=B(Ct),b=B(Ct),E=B(Ct),g=K(),A=K(),C=K(),T=K(),S=K(),V=K(),$=B(Qs),X=K(),q=B(Qs),F=B(xc),Y=K(),Z=K(),Q=K(),ne=K(),re=B(Sc);x(n,No,re),x(n,$n,e),x(n,Fo,t),x(e,ct,r),x(r,ct,i),x(n,Ge,s),x(n,$e,s),x(n,ut,a),x(n,Be,s),x(i,Ge,u),x(i,$e,u),x(i,Be,u),x(i,ut,u),x(s,Et,o),x(S,Et,V),x(o,Ge,a),x(o,$e,s),x(o,Be,s),x(o,ut,s),x(V,Ge,$),x(V,$e,S),x(V,Be,S),x(V,ut,S),x(a,Et,o),x($,Et,V),x(a,yr,l),x(a,ct,u),x(l,Be,c),x(c,ct,u),x($,yr,X),x(X,Be,q);var J=[gi,vi,Sn,bi,Di,Ci,ki,$e,Ei,xi,ut,Be,Si,Ai,wi,Oi,$n,ct,Ni,Ti,Ge,Fi],G=[yi,En,Wt,kn,xn,yr,Bo,Et,Ro,mr,Cn,pr,gr,Mi,Io,Po];x(u,Cn,f),x(u,pr,h),x(u,mr,p),x(u,gr,m),x(d,Cn,f),x(d,pr,h),x(d,mr,p),x(d,gr,m),x(f,Wt,u),x(h,kn,u),x(p,En,u),x(m,xn,u),x(y,Wt,u),x(v,kn,u),x(b,En,u),x(E,xn,u),x(g,Wt,u),x(A,kn,u),x(C,En,u),x(T,xn,u),H(f,J,y),H(h,J,v),H(p,J,b),H(m,J,E),H(f,G,g),H(h,G,A),H(p,G,C),H(m,G,T),H(y,J,y),H(v,J,v),H(b,J,b),H(E,J,E),H(y,G,y),H(v,G,v),H(b,G,b),H(E,G,E),H(g,J,y),H(A,J,v),H(C,J,b),H(T,J,E),H(g,G,g),H(A,G,A),H(C,G,C),H(T,G,T),H(u,J,u),H(d,J,u),H(u,G,d),H(d,G,d),x(t,Ge,F),x(t,$e,F),x(t,Be,F),x(t,ut,F),H(F,J,F),H(F,G,Y),H(Y,J,F),H(Y,G,Y);var Oe=[gi,yi,vi,bi,Di,Ci,Wt,ki,$e,Ei,xi,Be,Cn,Si,Ai,wi,Oi,Mi,ct,Ni,Ti,Ge,Fi];return H(s,Oe,Z),x(s,Sn,Q),H(a,Oe,Z),x(a,Sn,Q),H(o,Oe,Z),H(Z,Oe,Z),x(Z,Sn,Q),x(Z,Et,ne),H(ne,Oe,Z),x(Q,Ge,S),x(Q,$e,S),x(Q,Be,S),x(Q,ut,$),n}function Lv(n,e,t){for(var r=t.length,i=0,s=[],o=[];i<r;){for(var a=n,l=null,c=null,u=0,d=null,f=-1;i<r&&!(l=mi(a,t[i].t));)o.push(t[i++]);for(;i<r&&(c=l||mi(a,t[i].t));)l=null,a=c,a.accepts()?(f=0,d=a):f>=0&&f++,i++,u++;if(f<0)for(var h=i-u;h<i;h++)o.push(t[h]);else{o.length>0&&(s.push(As(Zs,e,o)),o=[]),i-=f,u-=f;var p=d.t,m=t.slice(i-u,i);s.push(As(p,e,m))}}return o.length>0&&s.push(As(Zs,e,o)),s}function As(n,e,t){var r=t[0].s,i=t[t.length-1].e,s=e.substr(r,i-r);return new n(s,t)}var zv=typeof console<"u"&&console&&console.warn||function(){},oe={scanner:null,parser:null,pluginQueue:[],customProtocols:[],initialized:!1};function Vv(){oe.scanner=null,oe.parser=null,oe.pluginQueue=[],oe.customProtocols=[],oe.initialized=!1}function Hv(n){if(oe.initialized&&zv('linkifyjs: already initialized - will not register custom protocol "'.concat(n,'" until you manually call linkify.init(). To avoid this warning, please register all custom protocols before invoking linkify the first time.')),!/^[a-z-]+$/.test(n))throw Error("linkifyjs: protocols containing characters other than a-z or - (hyphen) are not supported");oe.customProtocols.push(n)}function $v(){oe.scanner={start:Tv(oe.customProtocols),tokens:Mv},oe.parser={start:Pv(),tokens:Iv};for(var n={createTokenClass:an},e=0;e<oe.pluginQueue.length;e++)oe.pluginQueue[e][1]({scanner:oe.scanner,parser:oe.parser,utils:n});oe.initialized=!0}function Ac(n){return oe.initialized||$v(),Lv(oe.parser.start,n,Fv(oe.scanner.start,n))}function Lo(n){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,t=Ac(n),r=[],i=0;i<t.length;i++){var s=t[i];s.isLink&&(!e||s.t===e)&&r.push(s.toObject())}return r}function bl(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,t=Ac(n);return t.length===1&&t[0].isLink&&(!e||t[0].t===e)}function jv(n){return new ue({key:new Fe("autolink"),appendTransaction:(e,t,r)=>{const i=e.some(u=>u.docChanged)&&!t.doc.eq(r.doc),s=e.some(u=>u.getMeta("preventAutolink"));if(!i||s)return;const{tr:o}=r,a=om(t.doc,[...e]),{mapping:l}=a;if(mm(a).forEach(({oldRange:u,newRange:d})=>{di(u.from,u.to,t.doc).filter(m=>m.mark.type===n.type).forEach(m=>{const y=l.map(m.from),v=l.map(m.to),b=di(y,v,r.doc).filter(S=>S.mark.type===n.type);if(!b.length)return;const E=b[0],g=t.doc.textBetween(m.from,m.to,void 0," "),A=r.doc.textBetween(E.from,E.to,void 0," "),C=bl(g),T=bl(A);C&&!T&&o.removeMark(E.from,E.to,n.type)});const f=lm(r.doc,d,m=>m.isTextblock);let h,p;if(f.length>1?(h=f[0],p=r.doc.textBetween(h.pos,h.pos+h.node.nodeSize,void 0," ")):f.length&&r.doc.textBetween(d.from,d.to," "," ").endsWith(" ")&&(h=f[0],p=r.doc.textBetween(h.pos,d.to,void 0," ")),h&&p){const m=p.split(" ").filter(b=>b!=="");if(m.length<=0)return!1;const y=m[m.length-1],v=h.pos+p.lastIndexOf(y);if(!y)return!1;Lo(y).filter(b=>b.isLink).filter(b=>n.validate?n.validate(b.value):!0).map(b=>({...b,from:v+b.start+1,to:v+b.end+1})).forEach(b=>{o.addMark(b.from,b.to,n.type.create({href:b.href}))})}}),!!o.steps.length)return o}})}function _v(n){return new ue({key:new Fe("handleClickLink"),props:{handleClick:(e,t,r)=>{var i;const s=Uu(e.state,n.type.name);return((i=r.target)===null||i===void 0?void 0:i.closest("a"))&&s.href?(window.open(s.href,s.target),!0):!1}}})}function Wv(n){return new ue({key:new Fe("handlePasteLink"),props:{handlePaste:(e,t,r)=>{const{state:i}=e,{selection:s}=i,{empty:o}=s;if(o)return!1;let a="";r.content.forEach(c=>{a+=c.textContent});const l=Lo(a).find(c=>c.isLink&&c.value===a);return!a||!l?!1:(n.editor.commands.setMark(n.type,{href:l.href}),!0)}}})}const Kv=mt.create({name:"link",priority:1e3,keepOnSplit:!1,onCreate(){this.options.protocols.forEach(Hv)},onDestroy(){Vv()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,linkOnPaste:!0,autolink:!0,protocols:[],HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},validate:void 0}},addAttributes(){return{href:{default:null},target:{default:this.options.HTMLAttributes.target},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:'a[href]:not([href *= "javascript:" i])'}]},renderHTML({HTMLAttributes:n}){return["a",ge(this.options.HTMLAttributes,n),0]},addCommands(){return{setLink:n=>({chain:e})=>e().setMark(this.name,n).setMeta("preventAutolink",!0).run(),toggleLink:n=>({chain:e})=>e().toggleMark(this.name,n,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run(),unsetLink:()=>({chain:n})=>n().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[rn({find:n=>Lo(n).filter(e=>this.options.validate?this.options.validate(e.value):!0).filter(e=>e.isLink).map(e=>({text:e.value,index:e.start,data:e})),type:this.type,getAttributes:n=>{var e;return{href:(e=n.data)===null||e===void 0?void 0:e.href}}})]},addProseMirrorPlugins(){const n=[];return this.options.autolink&&n.push(jv({type:this.type,validate:this.options.validate})),this.options.openOnClick&&n.push(_v({type:this.type})),this.options.linkOnPaste&&n.push(Wv({editor:this.editor,type:this.type})),n}}),Uv={key:0,class:"border-gray rounded border-1"},qv={class:"flex flex-wrap items-center mt-4 px-5 pb-2 border-b-1 border-gray"},Jv={class:"mr-5"},Gv=on({__name:"AEditor",props:{content:{default:null}},emits:["update:content"],setup(n,{emit:e}){const t=n,r=wy({content:t.content,extensions:[Av,wv.configure({placeholder:"Product details"}),Kv.configure({openOnClick:!1})],onUpdate:c=>{e("update:content",c.editor.getHTML())}}),i=Qt(!1),s=Qt(null);function o(){var c,u;if(i.value=!1,s.value!==null){if(s.value===""){(c=r.value)==null||c.chain().focus().extendMarkRange("link").unsetLink().run();return}(u=r.value)==null||u.chain().focus().extendMarkRange("link").setLink({href:s.value}).run()}}const a=[{label:"Header 1",level:1},{label:"Header 2",level:2},{label:"Header 3",level:3},{label:"Header 4",level:4},{label:"Header 5",level:5},{label:"Header 5",level:6},{label:"Paragraph",level:0}],l=Hc({get(){var c;return((c=a.find(u=>{var d;return(d=r.value)==null?void 0:d.isActive("heading",{level:u.level})}))==null?void 0:c.level)??0},set(c){var u,d;if(c===void 0||c===0){(u=r.value)==null||u.chain().focus().setParagraph().run();return}c>=1&&c<=6&&((d=r.value)==null||d.chain().focus().toggleHeading({level:c}).run())}});return xr(()=>{var c;(c=r.value)==null||c.destroy()}),Dl(()=>t.content,()=>{var u,d;((u=r.value)==null?void 0:u.getHTML())!==t.content&&((d=r.value)==null||d.commands.setContent(t.content,!1))}),(c,u)=>{const d=kl,f=El,h=Wc,p=$c,m=xl,y=Kc,v=Uc,b=jc;return N(r)?(ws(),_c("div",Uv,[jt("div",qv,[jt("div",Jv,[U(d,{modelValue:N(l),"onUpdate:modelValue":u[0]||(u[0]=E=>Yi(l)?l.value=E:null),items:a,"item-title":"label","item-value":"level",variant:"plain",class:"w-40",density:"compact",label:"Text size","hide-details":""},null,8,["modelValue"])]),U(f,{size:"small",icon:"i-mdi:format-bold",ripple:!1,variant:"plain",disabled:!N(r).can().chain().focus().toggleBold().run(),class:Gn({"text-info":N(r).isActive("bold")}),onClick:u[1]||(u[1]=E=>{var g;return(g=N(r))==null?void 0:g.chain().focus().toggleBold().run()})},null,8,["disabled","class"]),U(f,{size:"small",icon:"i-mdi:format-italic",ripple:!1,variant:"plain",disabled:!N(r).can().chain().focus().toggleItalic().run(),class:Gn({"text-info":N(r).isActive("italic")}),onClick:u[2]||(u[2]=E=>{var g;return(g=N(r))==null?void 0:g.chain().focus().toggleItalic().run()})},null,8,["disabled","class"]),U(f,{size:"small",icon:"i-mdi:format-strikethrough",ripple:!1,variant:"plain",disabled:!N(r).can().chain().focus().toggleStrike().run(),class:Gn({"text-info":N(r).isActive("strike")}),onClick:u[3]||(u[3]=E=>{var g;return(g=N(r))==null?void 0:g.chain().focus().toggleStrike().run()})},null,8,["disabled","class"]),U(f,{size:"small",icon:"i-mdi:format-clear",ripple:!1,variant:"plain",onClick:u[4]||(u[4]=E=>{var g;return(g=N(r))==null?void 0:g.chain().focus().unsetAllMarks().run()})}),U(h,{vertical:"",class:"mx-2"}),U(f,{size:"small",icon:"i-mdi:format-list-bulleted",ripple:!1,variant:"plain",class:Gn({"text-info":N(r).isActive("bulletList")}),onClick:u[5]||(u[5]=E=>{var g;return(g=N(r))==null?void 0:g.chain().focus().toggleBulletList().run()})},null,8,["class"]),U(f,{size:"small",icon:"i-mdi:format-list-numbered",ripple:!1,variant:"plain",class:Gn({"text-info":N(r).isActive("orderedList")}),onClick:u[6]||(u[6]=E=>{var g;return(g=N(r))==null?void 0:g.chain().focus().toggleOrderedList().run()})},null,8,["class"]),U(h,{vertical:"",class:"mx-2"}),U(b,{modelValue:N(i),"onUpdate:modelValue":u[8]||(u[8]=E=>Yi(i)?i.value=E:null),"close-on-content-click":!1,location:"bottom center"},{activator:dt(({props:E})=>[U(f,Os({size:"small",icon:"i-mdi:link-plus"},E,{ripple:!1,variant:"plain"}),null,16)]),default:dt(()=>[U(v,{"min-width":"400"},{default:dt(()=>[U(y,null,{default:dt(()=>[U(m,{modelValue:N(s),"onUpdate:modelValue":u[7]||(u[7]=E=>Yi(s)?s.value=E:null),hint:"Insert a link","persistent-hint":"",label:"Link",placeholder:"https://example.com"},{append:dt(()=>[U(p,{icon:"i-mdi:plus",tag:"button",class:"disabled:text-gray disabled:cursor-default focus:text-info hover:text-info transition cursor-pointer",disabled:!N(s),onClick:o},null,8,["disabled"])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),U(f,{size:"small",icon:"i-mdi:link-off",ripple:!1,variant:"plain",disabled:!N(r).isActive("link"),onClick:u[9]||(u[9]=E=>{var g;return(g=N(r))==null?void 0:g.chain().focus().unsetLink().run()})},null,8,["disabled"])]),U(N(Ay),{class:"a-editor-content",editor:N(r)},null,8,["editor"])])):Cl("",!0)}}});const Yv=qc(Gv,[["__scopeId","data-v-8104fa2c"]]),Xv={class:"flex flex-col gap-2 py-5"},Qv={class:"grid gap-3 md:grid-cols-1 lg:grid-cols-2"},Zv={class:"grid gap-3 md:grid-cols-1 lg:grid-cols-2"},eb={class:"flex gap-5 items-center mb-5"},tb={class:"grid gap-3 md:grid-cols-1 lg:grid-cols-2"},cb=on({__name:"ProductDetailForm",props:{id:{default:null}},setup(n){const e=n,t={name:"",slug:"",category_id:null,price:null,stock:0,published:!1,tags:[],detail:""},r={name:"",slug:"",category_id:"",price:"",stock:"",published:"",detail:""},i=ad(),s=Jc(),o=Gc(),a=Ur({...t}),l=Ur({...r}),c=Qt([]),u=Qt([]),d=Ur({form:!1,search:!1});Yn.get("categories").then(m=>{c.value=m.data});const f=rd(m=>{if(m.length===0){u.value=[];return}d.search=!0,Yn.get("tags",{params:{search:m}}).then(y=>{const v=a.tags.map(b=>b.id);u.value=y.data.filter(b=>!v.includes(b.id)),m&&(!y.data.length||y.data.find(b=>b.name!==m))?u.value.unshift({id:0,name:m}):u.value=u.value.filter(b=>!!b.id)}).finally(()=>{d.search=!1})},200);async function h(){d.form=!0,Object.assign(l,r);const m={...a};m.tags=m.tags.map(y=>y.name);try{if(e.id){await Yn.put(`products/${e.id}`,m),s.success("Product updated");return}const y=await Yn.post("products",m);s.success("Product created"),o.push(`/products/${y.data.id}`)}catch(y){y instanceof id&&Object.assign(l,y.response.data.errors)}finally{d.form=!1}}function p(){Yn.get(`/products/${e.id}`,{params:{relations:["tags"]}}).then(m=>{Object.assign(a,Ho.exports.pick(m.data,["name","category_id","price","stock","published","slug","tags","detail"]))})}return Dl(()=>a.tags.length,()=>{a.tags=Ho.exports.uniqBy(a.tags,"name")}),e.id&&p(),(m,y)=>{const v=xl,b=od,E=Yc,g=kl,A=Xc,C=sd,T=Qc,S=Zc,V=Yv,$=El,X=ed;return ws(),Vo(X,{onSubmit:nd(h,["prevent"])},{default:dt(()=>{var q;return[jt("div",Xv,[jt("div",Qv,[U(v,{modelValue:N(a).name,"onUpdate:modelValue":y[0]||(y[0]=F=>N(a).name=F),label:"Product Name",error:!!N(l).name,"error-messages":N(l).name},null,8,["modelValue","error","error-messages"]),U(v,{modelValue:N(a).slug,"onUpdate:modelValue":y[1]||(y[1]=F=>N(a).slug=F),label:"Product Slug",error:!!N(l).slug,"error-messages":N(l).slug},null,8,["modelValue","error","error-messages"])]),jt("div",Zv,[U(b,{modelValue:N(a).price,"onUpdate:modelValue":y[2]||(y[2]=F=>N(a).price=F),label:"Price",inputmode:"numeric"},null,8,["modelValue"]),jt("div",eb,[U(E,{"model-value":N(a).stock!==null,"onUpdate:modelValue":y[3]||(y[3]=F=>N(a).stock=N(a).stock===null?0:null)},null,8,["model-value"]),U(v,{modelValue:N(a).stock,"onUpdate:modelValue":y[4]||(y[4]=F=>N(a).stock=F),type:"number",min:"0",label:"Stock",disabled:N(a).stock===null,"hide-details":"",hint:"Disable if stock is infinite"},null,8,["modelValue","disabled"])])]),jt("div",tb,[U(g,{modelValue:N(a).category_id,"onUpdate:modelValue":y[5]||(y[5]=F=>N(a).category_id=F),items:N(c),"item-title":"name","item-value":"id",label:"Category"},null,8,["modelValue","items"]),U(T,{modelValue:N(a).tags,"onUpdate:modelValue":y[6]||(y[6]=F=>N(a).tags=F),items:N(u),multiple:"",label:"Tags","item-title":"name","item-value":"name",chips:"","closable-chips":"","return-object":"",placeholder:"Duplicate tags will be truncated",loading:N(d).search,"onUpdate:search":N(f)},{chip:dt(({props:F,item:Y})=>[U(A,Os(F,{text:`${Y.value.name} ${Y.value.products_count?`(${Y.value.products_count})`:""}`}),null,16,["text"])]),item:dt(({props:F,item:Y})=>[U(C,Os(F,{title:`${Y.value.name} ${Y.value.products_count?`(${Y.value.products_count})`:""}`}),null,16,["title"])]),_:1},8,["modelValue","items","loading","onUpdate:search"])]),((q=N(i).role)==null?void 0:q.name)==="admin"?(ws(),Vo(S,{key:0,modelValue:N(a).published,"onUpdate:modelValue":y[7]||(y[7]=F=>N(a).published=F),label:"Publish"},null,8,["modelValue"])):Cl("",!0),U(V,{content:N(a).detail,"onUpdate:content":y[8]||(y[8]=F=>N(a).detail=F)},null,8,["content"])]),U($,{type:"submit",color:"primary"},{default:dt(()=>[td(" Submit ")]),_:1})]}),_:1},8,["onSubmit"])}}});export{cb as _};
//# sourceMappingURL=ProductDetailForm.vue_vue_type_script_setup_true_lang-82e4314e.js.map
