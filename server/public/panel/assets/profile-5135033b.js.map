{"version":3,"file":"profile-5135033b.js","sources":["../../../../panel/src/components/Form/ChangePasswordCard.vue","../../../../panel/src/components/Form/ProfilePictureCard.vue","../../../../panel/src/components/Form/FormProfileCard.vue","../../../../panel/src/pages/settings/profile.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport type { AxiosError } from 'axios';\n\nconst form = reactive({\n  oldPassword: '',\n  newPassword: '',\n  repeatPassword: '',\n});\nconst shows = reactive({\n  oldPassword: false,\n  newPassword: false,\n  repeatPassword: false,\n});\nconst initialInvalids = {\n  oldPassword: '',\n  newPassword: '',\n  repeatPassword: '',\n};\n\nconst toast = useToast();\nconst invalidFeedbacks = reactive({ ...initialInvalids });\nconst loading = ref(false);\n\nfunction handleSubmit() {\n  loading.value = true;\n  Object.assign(invalidFeedbacks, initialInvalids);\n  axios.post('profile/password', form)\n    .then(() => {\n      toast.success('Password updated.');\n      Object.assign(form, initialInvalids);\n    })\n    .catch((res: AxiosError<ApiInvalidFeedback>) => {\n      Object.assign(invalidFeedbacks, res.response!.data.errors);\n    })\n    .finally(() => {\n      loading.value = false;\n    });\n}\n</script>\n\n<template>\n  <VCard title=\"Change Password\" class=\"!p-5\">\n    <VForm @submit.prevent=\"handleSubmit\">\n      <div class=\"flex flex-col gap-4\">\n        <VTextField\n          id=\"old-password\"\n          v-model=\"form.oldPassword\"\n          :type=\"shows.oldPassword ? 'text' : 'password'\"\n          label=\"Old Password\"\n          :append-icon=\"shows.oldPassword ? 'i-mdi:eye' : 'i-mdi:eye-off'\"\n          :error=\"!!invalidFeedbacks.oldPassword\"\n          :error-messages=\"invalidFeedbacks.oldPassword\"\n          @click:append=\"(shows.oldPassword = !shows.oldPassword)\"\n        />\n        <VTextField\n          id=\"new-password\"\n          v-model=\"form.newPassword\"\n          autocomplete=\"new-password\"\n          :type=\"shows.newPassword ? 'text' : 'password'\"\n          label=\"New Password\"\n          :append-icon=\"shows.newPassword ? 'i-mdi:eye' : 'i-mdi:eye-off'\"\n          :error=\"!!invalidFeedbacks.newPassword\"\n          :error-messages=\"invalidFeedbacks.newPassword\"\n          @click:append=\"(shows.newPassword = !shows.newPassword)\"\n        />\n        <VTextField\n          id=\"confirm-password\"\n          v-model=\"form.repeatPassword\"\n          autocomplete=\"confirm-password\"\n          :type=\"shows.repeatPassword ? 'text' : 'password'\"\n          label=\"Repeat Password\"\n          :append-icon=\"shows.repeatPassword ? 'i-mdi:eye' : 'i-mdi:eye-off'\"\n          :error=\"!!invalidFeedbacks.repeatPassword\"\n          :error-messages=\"invalidFeedbacks.repeatPassword\"\n          @click:append=\"(shows.repeatPassword = !shows.repeatPassword)\"\n        />\n      </div>\n      <VBtn\n        class=\"!bg-danger text-white dark:text-dark mt-4\"\n        type=\"submit\" :loading=\"loading\"\n      >\n        Change Password\n      </VBtn>\n    </VForm>\n  </VCard>\n</template>\n","<script setup lang=\"ts\">\nimport { useUser } from '~/stores/useUser';\n\nconst user = useUser();\nconst picture = ref<File | null>(null);\nconst original = ref<File | null>(null);\n\naxios.get(`users/${user.id}/profile-picture`, { responseType: 'blob' })\n  .then((res) => {\n    picture.value = original.value = new File([res.data], 'old-file');\n  });\n\nfunction handleSaveImage(file: File | null) {\n  if (file === null) {\n    axios.delete(`users/${user.id}/profile-picture`)\n      .then(() => {\n        picture.value = null;\n        user.profile_picture = 'null';\n      });\n    return;\n  }\n\n  const formData = new FormData();\n  formData.append('image', file, file.name);\n  axios.post(`users/${user.id}/profile-picture`, formData)\n    .then((res) => {\n      user.profile_picture = res.data.profile_picture;\n      picture.value = file;\n    });\n}\n</script>\n\n<template>\n  <VCard class=\"!p-5\" title=\"Profile Picture\">\n    <div class=\"flex-grow-1 flex items-center flex-col\">\n      <ProfilePictureUpdater :value=\"picture\" @update:value=\"handleSaveImage\" />\n    </div>\n  </VCard>\n</template>\n","<script setup lang=\"ts\">\nimport type { AxiosError } from 'axios';\nimport { pick } from 'lodash';\nimport { useUser } from '~/stores/useUser';\n\nconst initInvalidFeedbacks = {\n  name: '',\n  email: '',\n}\n\nconst user = useUser();\nconst toast = useToast();\nconst profile = reactive({\n  id: '',\n  name: '',\n  email: '',\n});\nconst invalidFeedbacks = reactive({ ...initInvalidFeedbacks });\nconst loading = ref(false);\n\naxios.get<User>('profile')\n  .then((res) => {\n    Object.assign(profile, pick(res.data, ['id', 'name', 'email']));\n  });\n\nfunction handleSubmitForm() {\n  loading.value = true;\n  Object.assign(invalidFeedbacks, initInvalidFeedbacks);\n  axios.patch(`users/${profile.id}`, profile)\n    .then((res) => {\n      user.name = res.data.name;\n      toast.success('Profile updated');\n    })\n    .catch((res: AxiosError<ApiInvalidFeedback>) => {\n      Object.assign(invalidFeedbacks, res.response!.data.errors);\n    })\n    .finally(() => {\n      loading.value = false;\n    });\n}\n</script>\n\n<template>\n  <VCard class=\"!p-5\" title=\"Profile\">\n    <VForm class=\"flex-grow-2 lg:flex-grow-1\" @submit.prevent=\"handleSubmitForm\">\n      <div class=\"flex flex-col gap-3\">\n        <VTextField\n          v-model=\"profile.name\" label=\"Name\"\n          :error=\"!!invalidFeedbacks.name\"\n          :error-messages=\"invalidFeedbacks.name\"\n        />\n        <VTextField\n          v-model=\"profile.email\" label=\"Email\"\n          :error=\"!!invalidFeedbacks.email\"\n          :error-messages=\"invalidFeedbacks.email\"\n        />\n      </div>\n      <VBtn class=\"mt-4\" type=\"submit\" color=\"primary\" :loading=\"loading\">\n        Submit\n      </VBtn>\n    </VForm>\n  </VCard>\n</template>\n","<template>\n  <h1 class=\"text-3xl text-themeable\">\n    Profile Settings\n  </h1>\n  <VDivider class=\"my-4\" />\n  <div class=\"grid grid-cols-1 lg:grid-cols-2 gap-4\">\n    <div>\n      <FormProfileCard />\n    </div>\n    <div class=\"lg:row-span-2\">\n      <ProfilePictureCard />\n    </div>\n    <div>\n      <ChangePasswordCard />\n    </div>\n  </div>\n</template>\n"],"names":["form","reactive","shows","initialInvalids","toast","useToast","invalidFeedbacks","loading","ref","handleSubmit","axios","res","user","useUser","picture","original","handleSaveImage","file","formData","initInvalidFeedbacks","profile","pick","handleSubmitForm","_hoisted_1","_createElementVNode","_hoisted_2","_createVNode","_component_VDivider"],"mappings":"8aAGA,MAAAA,EAAAC,EAAA,CAAsB,YAAA,GACP,YAAA,GACA,eAAA,EACG,CAAA,EAElBC,EAAAD,EAAA,CAAuB,YAAA,GACR,YAAA,GACA,eAAA,EACG,CAAA,EAElBE,EAAA,CAAwB,YAAA,GACT,YAAA,GACA,eAAA,EACG,EAGlBC,EAAAC,IACAC,EAAAL,EAAA,CAAA,GAAAE,CAAA,CAAA,EACAI,EAAAC,EAAA,EAAA,EAEA,SAAAC,GAAA,CACEF,EAAA,MAAA,GACA,OAAA,OAAAD,EAAAH,CAAA,EACAO,EAAA,KAAA,mBAAAV,CAAA,EAAA,KAAA,IAAA,CAEII,EAAA,QAAA,mBAAA,EACA,OAAA,OAAAJ,EAAAG,CAAA,CAAmC,CAAA,EAAA,MAAAQ,GAAA,CAGnC,OAAA,OAAAL,EAAAK,EAAA,SAAA,KAAA,MAAA,CAAyD,CAAA,EAAA,QAAA,IAAA,CAGzDJ,EAAA,MAAA,EAAgB,CAAA,CACjB,8wDCjCL,MAAAK,EAAAC,IACAC,EAAAN,EAAA,IAAA,EACAO,EAAAP,EAAA,IAAA,EAEAE,EAAA,IAAA,SAAAE,EAAA,qBAAA,CAAA,aAAA,MAAA,CAAA,EAAA,KAAAD,GAAA,CAEIG,EAAA,MAAAC,EAAA,MAAA,IAAA,KAAA,CAAAJ,EAAA,IAAA,EAAA,UAAA,CAAgE,CAAA,EAGpE,SAAAK,EAAAC,EAAA,CACE,GAAAA,IAAA,KAAA,CACEP,EAAA,OAAA,SAAAE,EAAA,oBAAA,EAAA,KAAA,IAAA,CAEIE,EAAA,MAAA,KACAF,EAAA,gBAAA,MAAuB,CAAA,EAE3B,MAAA,CAGF,MAAAM,EAAA,IAAA,SACAA,EAAA,OAAA,QAAAD,EAAAA,EAAA,IAAA,EACAP,EAAA,KAAA,SAAAE,EAAA,qBAAAM,CAAA,EAAA,KAAAP,GAAA,CAEIC,EAAA,gBAAAD,EAAA,KAAA,gBACAG,EAAA,MAAAG,CAAgB,CAAA,CACjB,yPCvBL,MAAAE,EAAA,CAA6B,KAAA,GACrB,MAAA,EACC,EAGTP,EAAAC,IACAT,EAAAC,IACAe,EAAAnB,EAAA,CAAyB,GAAA,GACnB,KAAA,GACE,MAAA,EACC,CAAA,EAETK,EAAAL,EAAA,CAAA,GAAAkB,CAAA,CAAA,EACAZ,EAAAC,EAAA,EAAA,EAEAE,EAAA,IAAA,SAAA,EAAA,KAAAC,GAAA,CAEI,OAAA,OAAAS,EAAAC,EAAAA,QAAAA,KAAAV,EAAA,KAAA,CAAA,KAAA,OAAA,OAAA,CAAA,CAAA,CAA8D,CAAA,EAGlE,SAAAW,GAAA,CACEf,EAAA,MAAA,GACA,OAAA,OAAAD,EAAAa,CAAA,EACAT,EAAA,MAAA,SAAAU,EAAA,KAAAA,CAAA,EAAA,KAAAT,GAAA,CAEIC,EAAA,KAAAD,EAAA,KAAA,KACAP,EAAA,QAAA,iBAAA,CAA+B,CAAA,EAAA,MAAAO,GAAA,CAG/B,OAAA,OAAAL,EAAAK,EAAA,SAAA,KAAA,MAAA,CAAyD,CAAA,EAAA,QAAA,IAAA,CAGzDJ,EAAA,MAAA,EAAgB,CAAA,CACjB,gtBCjCEgB,EAAAC,EAAA,KAAA,CAAA,MAAA,2BAAA,qBAAA,EAAA,EAIEC,EAAA,CAAA,MAAA,uCAAA,yFAJPC,EAAAC,EAAA,CAAA,MAAA,MAAA,CAAA,+BAIE,CAAA"}